"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[945],{6303:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});var a=t(5043),o=t(749),s=t(8711),i=t(7174),r=t(2373);const c=t.p+"static/media/Gyroscope.572cdad23e89a59df442.glb";var h=t(579);function l(){const[n,e]=(0,a.useState)("ready"),[t,l]=(0,a.useState)({heading:0,pitch:0,roll:0,screenOrientationType:screen.orientation.type,screenOrientationAngle:screen.orientation.angle});var u=null;const M=()=>{const n=(0,i.p)(c),e=(0,a.useRef)();let s,r,l;n.scene.children.forEach((n=>{"External_Gimbal"===n.name&&(s=n),"Internal_Gimbal"===n.name&&(r=n),"Axis"===n.name&&(l=n)}));let u=0;return(0,o.F)(((n,e)=>{if("running"===n&&(u+=10*e),void 0!==s&&void 0!==r&&void 0!==l){let n=t.roll+Math.PI,e=t.pitch+Math.PI/2+u,a=u;s.quaternion.w=Math.cos(n/2),s.quaternion.y=Math.sin(n/2),s.quaternion.x=0,s.quaternion.z=0,r.quaternion.w=Math.cos(n/2)*Math.cos(e/2),r.quaternion.y=Math.sin(n/2)*Math.cos(e/2),r.quaternion.x=Math.cos(n/2)*Math.sin(e/2),r.quaternion.z=-Math.sin(n/2)*Math.sin(e/2),l.quaternion.w=Math.cos(n/2)*Math.cos((e+Math.PI/2)/2)*Math.cos(a/2)+Math.sin(n/2)*Math.sin((e+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.y=Math.sin(n/2)*Math.cos((e+Math.PI/2)/2)*Math.cos(a/2)-Math.cos(n/2)*Math.sin((e+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.x=Math.cos(n/2)*Math.sin((e+Math.PI/2)/2)*Math.cos(a/2)+Math.sin(n/2)*Math.cos((e+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.z=Math.cos(n/2)*Math.cos((e+Math.PI/2)/2)*Math.sin(a/2)-Math.sin(n/2)*Math.sin((e+Math.PI/2)/2)*Math.cos(a/2)}})),(0,h.jsx)("primitive",{ref:e,object:n.scene,scale:1.6})};const p=()=>{(u=new RelativeOrientationSensor({frequency:4,referenceFrame:"device"})).start(),console.log("gyroscope started"),u.onreading=()=>{let n=(e=u.quaternion[0],t=u.quaternion[1],a=u.quaternion[2],o=u.quaternion[3],{heading:Math.atan2(2*(e*t+a*o),1-2*(t*t+a*a)),pitch:Math.asin(2*(e*a-o*t)),roll:Math.atan2(2*(e*o+t*a),1-2*(e*e+t*t))});var e,t,a,o;let s=screen.orientation.type,i=screen.orientation.angle;l({...n,newOrientationType:s,newOrientationAngle:i}),console.log({...n,newOrientationType:s,newOrientationAngle:i})}};return(0,a.useEffect)((()=>{"start"===n&&("AbsoluteOrientationSensor"in window?Promise.all([navigator.permissions.query({name:"gyroscope"}),navigator.permissions.query({name:"accelerometer"})]).then((n=>{n.every((n=>"granted"===n.state))?e("running"):e("not allowed")})):e("not supported")),"running"===n&&p()}),[n]),(0,a.useEffect)((()=>()=>{u&&(u.stop(),console.log("stopped sensor"))}),[]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.Hl,{children:[(0,h.jsx)("ambientLight",{intensity:1}),(0,h.jsx)("pointLight",{position:[-10,-10,10],intensity:500}),(0,h.jsx)(M,{}),(0,h.jsx)(r.q,{makeDefault:!0,zoom:50,position:[0,0,10]})]}),"ready"===n&&(0,h.jsx)("button",{className:"gyroscopeStartButton",onClick:()=>e("start"),children:"Start"}),"not supported"===n&&(0,h.jsx)("div",{className:"gyroscopeWarning",children:"This feature is not supported on your device and/or browser"}),"not allowed"===n&&(0,h.jsx)("div",{className:"gyroscopeWarning",children:"This feature does not have permission to access your device sensors"})]})}}}]);
//# sourceMappingURL=945.c4f15684.chunk.js.map