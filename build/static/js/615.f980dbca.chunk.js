"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[615],{615:(e,t,o)=>{o.r(t),o.d(t,{default:()=>R});var n=o(5043),a=o(579);const l=(0,n.createContext)({currLayer:0,layers:[],setLayers:()=>{},lastLayer:0,setLastLayer:()=>{},name:"",setName:()=>{},setCurrLayer:()=>{},history:{},setHistory:()=>{},dimentions:{},setDimentions:()=>{},tempDimentions:{},setTempDimentions:()=>{},tool:"",setTool:()=>{},subTool:{},setSubTool:()=>{},curveControls:{},setCurveControls:()=>{},color:{},setColor:()=>{},size:0,setSize:()=>{},text:{},setText:()=>{},clipboard:{},setClipboard:()=>{},zoom:1,setZoom:()=>{},cursor:{},setCursor:()=>{},view:{},setView:()=>{}});const s=function(e){let{children:t}=e;const[o,s]=(0,n.useState)(0),[r,i]=(0,n.useState)([{id:0,name:"Base",visible:!0,canUndo:!1,canRedo:!1}]),[c,d]=(0,n.useState)(0),[h,u]=(0,n.useState)("Untitled"),[x,g]=(0,n.useState)({0:{data:[],lastIndex:0}}),[p,m]=(0,n.useState)({width:350,height:350}),[b,y]=(0,n.useState)({width:350,height:350}),[v,f]=(0,n.useState)("Brush"),[C,w]=(0,n.useState)({shape:"Circle",fill:!1,stretch:!1,sides:4,angle:0,startAngle:0}),[j,M]=(0,n.useState)({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),[S,k]=(0,n.useState)({selected:"hsl(0, 100%, 0%)",1:"hsl(0, 100%, 0%)",2:"hsl(0, 100%, 100%)"}),[T,D]=(0,n.useState)(16),[I,B]=(0,n.useState)({text:"",fill:!0,stroke:!1,strokeWidth:2,lineHeight:1.2,fontFamily:"Arial",state:"none"}),[P,N]=(0,n.useState)({data:{},state:"none"}),[E,L]=(0,n.useState)(1),[z,A]=(0,n.useState)({current:{x:0,y:0},start:{x:0,y:0},end:{x:0,y:0},down:!1,selecting:!1}),[R,$]=(0,n.useState)({toolBar:!0,contentBar:!0,topNavBar:!0,bottomNavBar:!0,menu:!0}),F={currLayer:o,layers:r,setLayers:i,lastLayer:c,setLastLayer:d,name:h,setName:u,history:x,setHistory:g,setCurrLayer:s,dimentions:p,setDimentions:m,tempDimentions:b,setTempDimentions:y,tool:v,setTool:f,subTool:C,setSubTool:w,curveControls:j,setCurveControls:M,color:S,setColor:k,size:T,setSize:D,text:I,setText:B,clipboard:P,setClipboard:N,zoom:E,setZoom:L,cursor:z,setCursor:A,view:R,setView:$};return(0,a.jsx)(l.Provider,{value:F,children:t})},r=(e,t,o,n)=>{let a;a=n?e.getContext("2d",{alpha:!0}):e.getContext("2d",{alpha:!1}),a.webkitImageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,a.imageSmoothingEnabled=!1;const l=a.canvas.height,s=a.canvas.width,r=t.current.x,i=t.current.y,c=t.start.x,d=t.start.y,h=t.end.x,u=t.end.y,x=()=>{a.strokeStyle=o.selectedColor,a.fillStyle=o.selectedColor,a.lineWidth=1,a.setLineDash([]),a.beginPath(),a.arc(r,i,o.size,0,2*Math.PI),n?a.stroke():a.fill(),a.closePath()},g={drawBrush:()=>{a.fillStyle=o.selectedColor,a.strokeStyle=o.selectedColor,a.lineWidth=1,a.setLineDash([]),a.beginPath(),a.arc(r,i,o.size,0,2*Math.PI),a.stroke(),a.fill(),a.closePath()},drawEraser:x,drawSpray:()=>{let e=Math.random()*o.size,t=Math.random(),n=Math.random()*o.size,l=Math.random();for(;Math.sqrt(Math.pow(e,2)+Math.pow(n,2))>o.size;)e=Math.random()*o.size,n=Math.random()*o.size;l>.5&&(n*=-1),t>.5&&(e*=-1),a.fillStyle=o.selectedColor,a.fillRect(r+e,i+n,1,1)},drawBucket:()=>{let e,t,n,c,d,h,u=[];for(let k=0;k<o.selectedColor.length;k++){var x,g;"("===o.selectedColor[k]?x=k+1:")"===o.selectedColor[k]?(g=k,u.push(o.selectedColor.slice(x,g))):","===o.selectedColor[k]&&(u.push(o.selectedColor.slice(x,k)),x=k+1)}if(c=u[0]/360,d=u[1].slice(0,-1)/100,h=u[2].slice(0,-1)/100,0===d)e=255*h,t=255*h,n=255*h;else{let T,D,I,B,P;function N(e){return e<0?e+1:e>1?e-1:e}function E(e,t,o){return 6*o<1?t+6*(e-t)*o:2*o<1?e:3*o<2?t+(e-t)*(2/3-o)*6:t}T=h<.5?h*(1+d):h+d-h*d,D=2*h-T,I=N(c+1/3),B=N(c),P=N(c-1/3),e=Math.round(255*E(T,D,I)),t=Math.round(255*E(T,D,B)),n=Math.round(255*E(T,D,P))}function p(e){var t=Number(e).toString(16);return 1==t.length?"0"+t:t}let m="#"+p(e)+p(t)+p(n),b=[],y=parseInt("FF"+m.slice(5,7)+m.slice(3,5)+m.slice(1,3),16);const v=a.getImageData(0,0,s,l),f={width:v.width,height:v.height,data:new Uint32Array(v.data.buffer)};function C(e,t){return e<0||t<0||e>=f.width||t>=f.height?-1:f.data[t*v.width+e]}let w=C(Math.floor(r),Math.floor(i));if(-1===w||w===y)return;const j=(e,t,o,n)=>{b.push({left:e,right:t,line:o,direction:n})},M=(e,t,o,n)=>{let a,s,r=!1;if(!(o>=l||o<0)){for(s=e;s<t;++s){C(s,o)===w?r||(r=!0,a=s):r&&(r=!1,j(a,s-1,o,n))}r&&(r=!1,j(a,t-1,o,n))}};j(Math.floor(r),Math.floor(r),Math.floor(i),0);let S=0;for(;b.length>0&&S<5e3;){S++;const{left:L,right:z,line:A,direction:R}=b.pop();let $=L;for(;$>=0&&C($,A)===w;$--);++$;let F=z;for(;F<s&&C(F,A)===w;++F);const Z=A*s;Z+F>f.data.length?(console.log("Attempt to access pixel data array beyond its maximum length"),f.data.fill(y,Z+$,f.data.length)):f.data.fill(y,Z+$,Z+F),R<=0?M($,F,A-1,-1):(M($,L,A-1,-1),M(z,F,A-1,-1)),R>=0?M($,F,A+1,1):(M($,L,A+1,1),M(z,F,A+1,1))}S>=5e3&&console.error("Bucket Tool maximum iterations exceeded, consider using a smaller canvas."),a.putImageData(v,0,0)},drawText:()=>{a.fillStyle=o.selectedColor,a.strokeStyle=o.selectedColor===o.color1?o.color2:o.color1,a.lineWidth=o.text.strokeWidth,a.font=String(o.size+"px "+o.text.fontFamily);let e=o.text.text.split("\n"),t=0,n=h>c?h-c:c-h,l=h>c?c:h,s=u>d?d:u,r=0;for(;t<e.length&&r<500;){if(a.measureText(e[t]).width>n){let o=e[t][0],l=1,s=0;for(;a.measureText(o).width<n&&s<500;)o+=e[t][l],l++,s++;let r=e[t].substring(l-1,e[t].length);e[t]=o.substring(0,l-1),e=e.toSpliced(t+1,0,r)}t++,r++}e.forEach(((e,t)=>{o.text.fill&&a.fillText(e,l,s+o.size+o.size*o.text.lineHeight*t),o.text.stroke&&a.strokeText(e,l,s+o.size+o.size*o.text.lineHeight*t)}))},drawPipette:()=>{let e=a.getImageData(r,i,1,1),t=e.data[0],n=e.data[1],l=e.data[2];t/=255,n/=255,l/=255;let s=Math.min(t,n,l),c=Math.max(t,n,l),d=c-s,h=0,u=0,x=(c+s)/2;0===d?(u=0,h=0):(u=x<=.5?d/(c+s):d/(2-c-s),c===t?h=(n-l)/d:c===n?h=(l-t)/d+2:c===l&&(h=(t-n)/d+4)),h=Math.round(60*h),h<0&&(h+=360),u=Math.abs(100*u).toFixed(0),x=(100*x).toFixed(0);let g="hsl("+h+","+u+"%,"+x+"%)";if("Pipette"!==o.tool)return g;o.selectedColor===o.color1?o.setColor1(g):o.setColor2(g)},drawSelect:()=>{switch(o.clipboard.state){case"copy":if(!n&&h-c!==0&&u-d!==0){let e=a.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"})}break;case"cut":if(!n&&h-c!==0&&u-d!==0){let e=a.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"}),o.selectedColor===o.color1?a.fillStyle=o.color2:a.fillStyle=o.color1,a.fillRect(c,d,h-c,u-d)}break;case"carry":const e=document.getElementById("carryCanvas").getContext("2d");e.height=o.clipboard.data.height,e.width=o.clipboard.data.width,e.putImageData(o.clipboard.data,0,0),a.putImageData(o.clipboard.data,h,u);break;case"paste":if(!n){const e=document.getElementById("carryCanvas");a.drawImage(e,h,u),o.setClipboard({...o.clipboard,state:"none"})}}},drawShape:()=>{a.strokeStyle=o.color1,a.fillStyle=o.color2,a.setLineDash([]),a.lineWidth=o.size;let e,t=(h-c)/2,n=(u-d)/2;e=Math.sqrt(Math.pow(h-c,2))/2<Math.sqrt(Math.pow(u-d,2))/2?Math.sqrt(Math.pow(h-c,2))/2:Math.sqrt(Math.pow(u-d,2))/2;let l=Math.sqrt(Math.pow((h-c)/(u-d),2)),s=Math.sqrt(Math.pow((u-d)/(h-c),2));o.subTool.stretch?l>s?s=1:l=1:(l=1,s=1),"Curve"!==o.subTool.shape&&"Line"!==o.subTool.shape&&(a.save(),a.translate(c+t,d+n),a.rotate(Math.PI*o.subTool.angle/180)),"Rectangle"===o.subTool.shape?g["draw"+o.subTool.shape](t,n):g["draw"+o.subTool.shape](l,s,e),"Line"!==o.subTool.shape&&"Curve"!==o.subTool.shape&&a.restore()},drawLine:()=>{a.beginPath(),a.moveTo(c,d),a.lineTo(h,u),a.stroke()},drawCurve:()=>{let e={x:0,y:0},t={x:0,y:0},n={x:0,y:0},l={x:0,y:0};a.beginPath(),-1===o.curveControls.start.x?(e={x:c,y:d},t={x:h,y:u},n={x:c,y:d},l={x:h,y:u}):-1===o.curveControls.controlPoint1.x?(e=o.curveControls.start,t=o.curveControls.end,n={x:h,y:u},l=o.curveControls.end):-1===o.curveControls.controlPoint2.x?(e=o.curveControls.start,t=o.curveControls.end,n=o.curveControls.controlPoint1,l={x:h,y:u}):(e=o.curveControls.start,t=o.curveControls.end,n=o.curveControls.controlPoint1,l=o.curveControls.controlPoint2),a.moveTo(e.x,e.y),a.bezierCurveTo(n.x,n.y,l.x,l.y,t.x,t.y),a.stroke()},drawCircle:(e,t,n)=>{a.beginPath(),a.ellipse(0,0,e*n,t*n,0,0,2*Math.PI),o.subTool.fill&&a.fill(),a.stroke()},drawRectangle:(e,t)=>{o.subTool.fill&&a.fillRect(-e,-t,h-c,u-d),a.strokeRect(-e,-t,h-c,u-d)},drawPolygon:(e,t,n)=>{a.beginPath();for(let l=0;l<o.subTool.sides+2;l++)a.lineTo(e*n*Math.cos(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n*Math.sin(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&a.fill(),a.stroke()},drawStar:(e,t,n)=>{a.beginPath();for(let l=0;l<2*o.subTool.sides+2;l++)l%2===0?a.lineTo(e*n*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle)):a.lineTo(e*n/3*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n/3*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&a.fill(),a.stroke()},drawArrow:(e,t,n)=>{a.beginPath(),a.moveTo(e*-n*Math.cos(Math.PI/8),t*-n*Math.sin(Math.PI/8)),a.lineTo(0,t*-n*Math.sin(Math.PI/8)),a.lineTo(0,t*-n),a.lineTo(e*n,0),a.lineTo(0,t*n),a.lineTo(0,t*n*Math.sin(Math.PI/8)),a.lineTo(e*-n*Math.cos(Math.PI/8),t*n*Math.sin(Math.PI/8)),a.closePath(),o.subTool.fill&&a.fill(),a.stroke()},drawHeart:(e,t,n)=>{o.subTool.stretch&&(e>t?a.scale(e,1):a.scale(1,t)),a.beginPath(),a.moveTo(0,n),a.arc(-n/2,-n/5,n/2,3*Math.PI/4,0,!1),a.arc(n/2,-n/5,n/2,Math.PI,Math.PI/4,!1),a.closePath(),o.subTool.fill&&a.fill(),a.stroke()}};if(n){if(a.clearRect(0,0,s,l),"Magnifier"!==o.tool){if("Bucket"===o.tool||"Pipette"===o.tool)return;"Spray"===o.tool?x():g["draw"+o.tool]()}}else"Magnifier"!==o.tool&&g["draw"+o.tool]()},i=(e,t,o,n,a,l)=>{switch(n.tool){case"Brush":case"Eraser":r(e,t,n,!1),"drawing"!==a&&l("drawing");break;case"Bucket":r(e,t,n,!1),l("finished");break;case"Spray":for(let o=0;o<10;o++)r(e,t,n,!1);l("spraying");break;case"Text":0!==t.current.x&&0!==t.current.y&&n.setText({...n.text,state:"preview"}),"confirm"===a&&(r(e,t,n,!1),n.setText({...n.text,text:"",state:"none"}),l("finished"));break;case"Pipette":r(e,t,n,!1);break;case"Magnifier":default:break;case"Select":"clipping"===a&&"carry"!==n.clipboard.state?r(e,t,n,!1):"confirm"===a&&(r(e,t,n,!1),l("finished"));break;case"Shape":if("Curve"===n.subTool.shape&&t.down){let e=n.curveControls.state,o=n.curveControls.start,s=n.curveControls.end,r=n.curveControls.controlPoint1,i=n.curveControls.controlPoint2;"none"===n.curveControls.state?(l("settingPoints"),e="start",o={x:t.start.x,y:t.start.y},s={x:t.end.x,y:t.end.y}):"start"===n.curveControls.state?"settingPoints"===a?s={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point1",r={x:t.end.x,y:t.end.y}):"point1"===n.curveControls.state?"settingPoints"===a?r={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point2",i={x:t.end.x,y:t.end.y}):"point2"===n.curveControls.state&&(i={x:t.end.x,y:t.end.y}),n.setCurveControls({...n.curveControls,state:e,start:o,end:s,controlPoint1:r,controlPoint2:i})}else"Curve"===n.subTool.shape&&"cancel"===a&&n.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}});"confirm"===a&&(r(e,t,n,!1),"Curve"===n.subTool.shape&&n.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),l("finished"),o({...t,start:{x:0,y:0},end:{x:0,y:0}}))}},c=(e,t,o,n)=>{if(null===e)t({File:{New:{action:"New",keybind:"Alt+N",disabled:!1},Download:{action:"Save",keybind:"Ctrl+Alt+S",disabled:!0},"Download As":{action:"Save As",keybind:"Ctrl+Alt+Shift+S",disabled:!0,title:"Not Implemented"},"Change Name":{action:"Change Name",keybind:"F2",disabled:!1},LineBreak1:{},Close:{action:"Close",keybind:"Alt+Shift+F4",disabled:!1}},Edit:{Undo:{action:"Undo",keybind:"Ctrl+Z",disabled:!1},Redo:{action:"Redo",keybind:"Ctrl+Y",disabled:!1}},View:{"Zoom In":{action:"Zoom In",keybind:"Alt++",disabled:!1},"Zoom Out":{action:"Zoom Out",keybind:"Alt+-",disabled:!1},"Zoom Reset":{action:"Zoom Reset",keybind:"Alt+0",disabled:!0},LineBreak1:{},"Tool Bar":{action:"toolBar",checkbox:!0,disabled:!1},"Content Bar":{action:"contentBar",checkbox:!0,disabled:!1},"Bottom Bar":{action:"bottomNavBar",checkbox:!0,disabled:!1},"Top Bar":{action:"topNavBar",checkbox:!0,disabled:!1}}});else{let a={...e};switch(n){case"history":let e=o.history.canUndo||o.history.canRedo;a={...a,File:{...a.File,Download:{...a.File.Download,disabled:!e},"Download As":{...a.File["Download As"],disabled:!e}},Edit:{...a.Edit,Undo:{...a.Edit.Undo,disabled:!o.history.canUndo},Redo:{...a.Edit.Redo,disabled:!o.history.canRedo}}};break;case"view":a={...a,View:{...a.View,"Tool Bar":{...a.View["Tool Bar"],checkbox:o.view.toolBar},"Content Bar":{...a.View["Content Bar"],checkbox:o.view.contentBar},"Bottom Bar":{...a.View["Bottom Bar"],checkbox:o.view.bottomNavBar},"Top Bar":{...a.View["Top Bar"],checkbox:o.view.topNavBar}}};break;case"zoom":a={...a,View:{...a.View,"Zoom In":{...a.View["Zoom In"],disabled:4===o.zoom},"Zoom Out":{...a.View["Zoom Out"],disabled:.25===o.zoom},"Zoom Reset":{...a.View["Zoom Reset"],disabled:1===o.zoom}}}}t(a)}},d=(e,t,o,n,a,l,s,r,i,d)=>{let h={},u={};const x=e.canvas.height,g=e.canvas.width,p=(e,t,n)=>{o(e),d(t),s(n),c(a,l,u={history:{...t[r]}},"history")};switch(n){case"undo":(()=>{const e=i[r].id;h=t,document.getElementById(`drawCanvasLayer${e}`).getContext("2d").putImageData(t[e].data[t[e].lastIndex-1],0,0);const o=t[e].lastIndex-1>0;h[e].lastIndex--;let n=i;n[r]={...n[r],canUndo:o,canRedo:!0},p(h,n,!1)})();break;case"redo":(()=>{let e=i[r].id;h=t,document.getElementById(`drawCanvasLayer${e}`).getContext("2d").putImageData(t[e].data[t[e].lastIndex+1],0,0);const o=t[e].lastIndex+1<t[e].data.length-1;h[e].lastIndex++;let n=i;n[r]={...n[r],canUndo:!0,canRedo:o},p(h,n,!1)})();break;case"delete layer":default:break;case"save":(()=>{let e=i[r].id;h=t;let o=document.getElementById(`drawCanvasLayer${e}`).getContext("2d");h[e]?h[e].lastIndex===h[e].data.length-1?h[e]={data:[...h[e].data,o.getImageData(0,0,g,x)],lastIndex:h[e].data.length}:(h[e].data.splice(h[e].lastIndex+1,0,o.getImageData(0,0,g,x)),h[e].lastIndex++):h[e]={data:[o.getImageData(0,0,g,x)],lastIndex:0};let n=i;n[r]={...n[r],canUndo:!0,canRedo:!1},h[e].data.length>50&&(h[e].data.shift(),h[e].lastIndex--),p(h,n,!1)})();break;case"clear":h={0:{data:[e.getImageData(0,0,g,x)],lastIndex:0}},p(h,[{id:0,name:"Base",visible:!0,canUndo:!1,canRedo:!1}],!0)}},h=(e,t,o,n)=>{const a=e.canvas.height,l=e.canvas.width;switch(o){case"new":(()=>{const e=document.getElementById("drawCanvasLayer0").getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,l,a)})();break;case"save":(()=>{let e=document.createElement("canvas");e.width=l,e.height=a,n.forEach((t=>{t.visible&&e.getContext("2d").drawImage(document.getElementById(`drawCanvasLayer${t.id}`),0,0)}));let o=document.createElement("a");o.setAttribute("download",t+".png");let s=e.getContext("2d").canvas.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");o.setAttribute("href",s),o.click()})()}},u=e=>{let t={};const{canvas:o,ctx:n,context:l,params:s,action:r,setAction:u,appMenu:x,setAppMenu:g,appDialog:p,setAppDialog:m,contextMenu:b,canClose:y,setCanClose:v,isSelected:f,title:C,setTitle:w,currLayer:j,setCurrLayer:M,layers:S,setLayers:k}=e;switch(r){case"Startup":h(n,l.name,"new",S),d(n,l.history,l.setHistory,"clear",x,g,v,j,S,k),u(!1);break;case"New":((e,t,o)=>{e.setTempDimentions({width:e.dimentions.width,height:e.dimentions.height});const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("New")}}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"Width",children:"Width"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Width",type:"number",value:e.tempDimentions.width,onChange:o=>{e.setTempDimentions({...e.tempDimentions,width:o.target.value}),t("New")}}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"Height",children:"Height"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Height",type:"number",value:e.tempDimentions.height,onChange:o=>{e.setTempDimentions({...e.tempDimentions,height:o.target.value}),t("New")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{e.setDimentions({...e.tempDimentions}),t("New Confirm"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"New File",info:n,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"New Confirm":m(null),h(n,l.name,"new",S),M(0),d(n,l.history,l.setHistory,"clear",x,g,v,j,S,k),l.setClipboard({data:{},state:"none"}),u(!1);break;case"Save":h(n,l.name,"save",S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Save As":((e,t,o)=>{const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New Name",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New name",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{t("Save"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"Download As",info:n,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Change Name":((e,t,o)=>{const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{t("Change Name Confirm"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"Change Name",info:n,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Change Name Confirm":w(l.name),m(null),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Undo":d(n,l.history,l.setHistory,"undo",x,g,v,j,S,k),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Redo":d(n,l.history,l.setHistory,"redo",x,g,v,j,S,k),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"New Layer":d(n,l.history,l.setHistory,"save",x,g,v,j,S,k),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Delete Layer":d(n,l.history,l.setHistory,"delete layer",x,g,v,j,S,k),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom In":l.zoom<4&&(l.zoom<1?(l.setZoom(l.zoom+.25),t={zoom:l.zoom+.25}):(l.setZoom(l.zoom+1),t={zoom:l.zoom+1}),c(x,g,t,"zoom")),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Out":l.zoom>.25&&(l.zoom<=1?(l.setZoom(l.zoom-.25),t={zoom:l.zoom-.25}):(l.setZoom(l.zoom-1),t={zoom:l.zoom-1}),c(x,g,t,"zoom")),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Reset":l.setZoom(1),t={zoom:1},c(x,g,t,"zoom"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Min":t={zoom:.25},c(x,g,t,"zoom"),u(!1);break;case"Zoom Max":t={zoom:4},c(x,g,t,"zoom"),u(!1);break;case"Zoom Default":t={zoom:1},c(x,g,t,"zoom"),u(!1);break;case"Zoom Change":t={zoom:2},c(x,g,t,"zoom"),u(!1);break;case"Cut":case"Copy":case"Paste":case"Select All":case"Select Clear":u(!1);break;case"finished":d(n,l.history,l.setHistory,"save",x,g,v,j,S,k),u(!1);break;case"drawing":l.cursor.down?i(o,l.cursor,l.setCursor,s,r,u):u("finished");break;case"spraying":l.cursor.down?setTimeout((()=>{u("drawing")}),100):u("finished");break;case"settingPoints":l.cursor.down?i(o,l.cursor,l.setCursor,s,r,u):u(!1);break;case"cancel":case"clipping":case"confirm":i(o,l.cursor,l.setCursor,s,r,u);break;case!1:l.cursor.down&&i(o,l.cursor,l.setCursor,s,r,u);break;case"topNavBar":l.setView({...l.view,topNavBar:!l.view.topNavBar}),t={view:{...l.view,topNavBar:!l.view.topNavBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"contentBar":l.setView({...l.view,contentBar:!l.view.contentBar}),t={view:{...l.view,contentBar:!l.view.contentBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"bottomNavBar":l.setView({...l.view,bottomNavBar:!l.view.bottomNavBar}),t={view:{...l.view,bottomNavBar:!l.view.bottomNavBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"toolBar":l.setView({...l.view,toolBar:!l.view.toolBar}),t={view:{...l.view,toolBar:!l.view.toolBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Close":y||((e,t,o)=>{o({title:"Warning",info:"Do you want to download the file before closing?",actions:{Save:()=>{t("Save and Close"),o(null)},Close:()=>{e(!0),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}}})})(v,u,m);break;case"Save and Close":h(n,l.name,"save"),v(!0),u("Close");break;case"Cancel Dialog":"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;default:u(!1)}};function x(e){let{action:t,setAction:o,appMenu:s,setAppMenu:r,appDialog:i,setAppDialog:c,contextMenu:d,canClose:h,setCanClose:x,title:g,setTitle:p}=e;const m=(0,n.useContext)(l),b=m.layers,y=m.setLayers,v=m.currLayer,f=m.setCurrLayer,C={tool:m.tool,subTool:m.subTool,curveControls:m.curveControls,setCurveControls:m.setCurveControls,size:m.size,selectedColor:m.color.selected,color1:m.color[1],setColor1:e=>m.setColor({...m.color,1:e,selected:e}),color2:m.color[2],setColor2:e=>m.setColor({...m.color,2:e,selected:e}),text:m.text,setText:m.setText,clipboard:m.clipboard,setClipboard:m.setClipboard};return(0,n.useEffect)((()=>{if(void 0===b[v].id)return;let e=document.getElementById(`drawCanvasLayer${b[v].id}`),n=e.getContext("2d",{willReadFrequently:!0});u({canvas:e,ctx:n,params:C,action:t,setAction:o,context:m,appMenu:s,setAppMenu:r,appDialog:i,setAppDialog:c,contextMenu:d,canClose:h,setCanClose:x,title:g,setTitle:p,currLayer:v,setCurrLayer:f,layers:b,setLayers:y})}),[m.cursor,t]),(0,n.useEffect)((()=>{let e=-1*(m.dimentions.width/2-m.zoom*m.dimentions.width/2)/m.zoom,t=-1*(m.dimentions.height/2-m.zoom*m.dimentions.height/2)/m.zoom;document.getElementById("drawDocCheckersBackground").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`,document.getElementById("previewCanvas").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`,document.getElementById("interfaceCanvas").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`;const o=document.getElementsByClassName("drawCanvasLayer");if(o.length>0)for(let n=0;n<o.length;n++)o[n].style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`}),[m.zoom,m.cursor]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{id:"drawDocCheckersBackground",className:"drawDocCheckersBackground",height:m.dimentions.height,width:m.dimentions.width}),b.length>0&&b.map(((e,t)=>(0,a.jsx)("canvas",{id:`drawCanvasLayer${e.id}`,className:"drawCanvasLayer",style:{display:e.visible?"block":"none",zIndex:t},height:m.dimentions.height,width:m.dimentions.width},e.id)))]})}function g(){const e=(0,n.useContext)(l),t=(0,n.useRef)(null),o=e.cursor,s=e.tool,i=e.subTool,c=e.curveControls,d=e.setCurveControls,h=e.size,u=e.color.selected,x=e.color[1],g=e.color[2],p=e.text,m=e.setText,b=e.clipboard,y=e.setClipboard,v=e.currLayer,f={tool:s,subTool:i,curveControls:c,setCurveControls:d,size:h,selectedColor:u,color1:x,setColor1:t=>e.setColor({...e.color,1:t}),color2:g,setColor2:t=>e.setColor({...e.color,2:t}),text:p,setText:m,clipboard:b,setClipboard:y};return(0,n.useEffect)((()=>{r(t.current,o,f,!0)}),[o,f]),(0,a.jsx)("canvas",{ref:t,style:{color:f.selectedColor,zIndex:v},id:"previewCanvas",height:e.dimentions.height,width:e.dimentions.width})}function p(){const e=(0,n.useContext)(l),t=e.cursor,o=e.setCursor,s=e.zoom,r=e.tool,i=e.subTool,c=e.setSubTool,d=e.layers,h=e.clipboard,[u,x]=(0,n.useState)({left:"0px",top:"0px",height:"0px",width:"0px",canUsePointer:!0}),[g,p]=(0,n.useState)({left:"0px",top:"0px",diameter:"0px"}),[m,b]=(0,n.useState)({left:"0px",top:"0px",width:"0px",height:"0px"}),[y,v]=(0,n.useState)([0,0,!0]),[f,C]=(0,n.useState)([0,0,0,0]),[w,j]=(0,n.useState)([0,0,0]),M=e=>{let t,o,n=!1;if(0===e.button?0!==e.clientX&&0!==e.clientY&&(t=e.clientX,o=e.clientY,n=!0):0!==e.touches[0].clientX&&0!==e.touches[0].clientY&&(t=e.touches[0].clientX,o=e.touches[0].clientY,n=!0),n){let e=document.getElementById("interfaceCanvas"),n=e.getContext("2d",{alpha:!0}),a=e.getBoundingClientRect();const l=n.canvas.width/a.width,s=n.canvas.height/a.height;return t=(t-a.left)*l,o=(o-a.top)*s,[t,o,!0]}return[0,0,!1]},S=(e,n)=>{e.stopPropagation(),o({...t,selecting:!0});const a=M(e);let l=0,s=0;!1!==a[2]&&(-1!==n.indexOf("N")?s=a[1]-Math.min(t.start.y,t.end.y):-1!==n.indexOf("S")&&(s=a[1]-Math.max(t.start.y,t.end.y)),-1!==n.indexOf("W")?l=a[0]-Math.min(t.start.x,t.end.x):-1!==n.indexOf("E")&&(l=a[0]-Math.max(t.start.x,t.end.x)),v([l,s]))};function k(e,o,n){let a=!1,l=!1;t.start.x>t.end.x&&(a=!0),t.start.y>t.end.y&&(l=!0);let s=t.start.x,r=t.start.y,i=t.end.x,c=t.end.y;return-1!==n.indexOf("N")?l?c=o[1]-y[1]:r=o[1]-y[1]:-1!==n.indexOf("S")&&(l?r=o[1]-y[1]:c=o[1]-y[1]),-1!==n.indexOf("E")?a?s=o[0]-y[0]:i=o[0]-y[0]:-1!==n.indexOf("W")&&(a?i=o[0]-y[0]:s=o[0]-y[0]),[s,r,i,c]}const T=(e,n)=>{e.preventDefault(),e.stopPropagation();const a=M(e);if(!1===a[2])return;const l=k(0,a,n);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]}})},D=(e,n)=>{e.preventDefault(),e.stopPropagation();const a=M(e);if(!1===a[2])return;const l=k(0,a,n);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]},selecting:!1})},I=e=>{e.stopPropagation(),o({...t,selecting:!0});const n=M(e);if(!1===n[2])return;if("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id)return;let a=0,l=0,s=0,r=0;a=n[0]-t.start.x,l=n[1]-t.start.y,s=n[0]-t.end.x,r=n[1]-t.end.y,C([a,l,s,r])},B=e=>{e.preventDefault(),e.stopPropagation();const n=M(e);!1!==n[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:n[0]-f[0],y:n[1]-f[1]},end:{x:n[0]-f[2],y:n[1]-f[3]}}))},P=e=>{e.preventDefault(),e.stopPropagation();const n=M(e);!1!==n[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:n[0]-f[0],y:n[1]-f[1]},end:{x:n[0]-f[2],y:n[1]-f[3]},selecting:!1}))},N=e=>{e.preventDefault();const t=M(e);if(!1===t[2])return;let o=Number(g.top.slice(0,-2)),n=Number(g.left.slice(0,-2)),a=Number(g.diameter.slice(0,-2)),l=n+a/2+w[3],s=o+a/2+w[4],r=l>t[0]?l-t[0]:t[0]-l,d=s>t[1]?s-t[1]:t[1]-s,h=Math.sqrt(Math.pow(r,2)+Math.pow(d,2)),u=Math.acos((Math.pow(r,2)+Math.pow(h,2)-Math.pow(d,2))/(2*r*h))/(Math.PI/180),x=0;t[0]>l&&t[1]<s?x=90-u:t[0]>l&&t[1]>s?x=90+u:t[0]<l&&t[1]>s?x=270-u:t[0]<l&&t[1]<s&&(x=270+u),c({...i,angle:x})};return(0,n.useEffect)((()=>{if("Select"!==r||"carry"!==h.state){let e=Math.min(t.start.x,t.end.x),o=Math.max(t.start.x,t.end.x),n=Math.min(t.start.y,t.end.y),a=Math.max(t.start.y,t.end.y)-n,l=o-e;x({...u,left:Math.floor(e*s)+"px",top:Math.floor(n*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(a*s)+"px"});let r=e+Math.floor(l/2),i=n+Math.floor(a/2),c=Math.min(l,a);p({...g,left:Math.floor((r-c/2)*s)+"px",top:Math.floor((i-c/2)*s)+"px",diameter:Math.floor(c*s)+"px"}),b({...m,left:Math.floor(e*s)+"px",top:Math.floor(n*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(a*s)+"px"})}else x({...u,left:Math.floor(t.end.x*s)+"px",top:Math.floor(t.end.y*s)+"px",width:Math.floor(h.data.width*s)+"px",height:Math.floor(h.data.height*s)+"px"})}),[t,s,r,h.state]),(0,a.jsxs)(a.Fragment,{children:[("Select"===r||"Shape"===r||"Text"===r)&&(0,a.jsxs)("div",{id:"drawDocSelectionBox",style:{top:u.top,left:u.left,width:u.width,height:u.height,pointerEvents:t.down?"none":"auto",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||I(e)},onDrag:e=>{t.down||B(e)},onDragEnd:e=>{t.down||P(e)},children:["Text"===r&&(0,a.jsx)("div",{id:"drawDocSelectionBoxDragPivot"}),("Select"!==r||"carry"!==h.state)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{id:"drawDocSelectionBoxNW",draggable:!0,onDragStart:e=>{t.down||S(e,"NW")},onDrag:e=>{t.down||T(e,"NW")},onDragEnd:e=>{t.down||D(e,"NW")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxN",draggable:!0,onDragStart:e=>{t.down||S(e,"N")},onDrag:e=>{t.down||T(e,"N")},onDragEnd:e=>{t.down||D(e,"N")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxNE",draggable:!0,onDragStart:e=>{t.down||S(e,"NE")},onDrag:e=>{t.down||T(e,"NE")},onDragEnd:e=>{t.down||D(e,"NE")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxE",draggable:!0,onDragStart:e=>{t.down||S(e,"E")},onDrag:e=>{t.down||T(e,"E")},onDragEnd:e=>{t.down||D(e,"E")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxSE",draggable:!0,onDragStart:e=>{t.down||S(e,"SE")},onDrag:e=>{t.down||T(e,"SE")},onDragEnd:e=>{t.down||D(e,"SE")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxS",draggable:!0,onDragStart:e=>{t.down||S(e,"S")},onDrag:e=>{t.down||T(e,"S")},onDragEnd:e=>{t.down||D(e,"S")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxSW",draggable:!0,onDragStart:e=>{t.down||S(e,"SW")},onDrag:e=>{t.down||T(e,"SW")},onDragEnd:e=>{t.down||D(e,"SW")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxW",draggable:!0,onDragStart:e=>{t.down||S(e,"W")},onDrag:e=>{t.down||T(e,"W")},onDragEnd:e=>{t.down||D(e,"W")}})]})]}),"Shape"===r&&"Line"!==i.type&&"Curve"!==i.type&&i.stretch&&(0,a.jsx)("div",{id:"drawDocSelectionEllipse",style:{top:m.top,left:m.left,width:m.width,height:m.height,rotate:i.angle+"deg",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||I(e)},onDrag:e=>{t.down||B(e)},onDragEnd:e=>{t.down||P(e)}}),"Shape"===r&&"Line"!==i.type&&"Curve"!==i.type&&(0,a.jsx)("div",{id:"drawDocSelectionCircle",style:{top:g.top,left:g.left,width:g.diameter,height:g.diameter,rotate:i.angle+"deg",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||I(e)},onDrag:e=>{t.down||B(e)},onDragEnd:e=>{t.down||P(e)},children:(0,a.jsx)("div",{id:"drawDocSelectionCirclePoint",draggable:!0,onDragStart:e=>{t.down||(e=>{o({...t,selecting:!0});const n=M(e),a=document.getElementById("previewCanvas").getBoundingClientRect();!1!==n[2]&&j([n[0],n[1],i.angle,a.left,a.top])})(e)},onDrag:e=>{t.down||N(e)},onDragEnd:e=>{t.down||(e=>{N(e),o({...t,selecting:!1})})(e)}})}),"Text"===r&&!t.down&&(0,a.jsx)("textarea",{id:"drawDocSelectionBoxText",style:{top:u.top,left:u.left,width:u.width,height:u.height,caretColor:e.text.color,fontSize:e.size*e.zoom+"px",fontFamily:e.text.fontFamily,lineHeight:e.text.lineHeight,zIndex:d.length+2},spellCheck:!1,value:e.text.text,onChange:t=>e.setText({...e.text,text:t.target.value})})]})}var m=o(6833),b=o(7196),y=o(3156),v=o(9804);function f(e){const t=e.action,o=e.setAction,s=(e.contextMenu,(0,n.useContext)(l)),r=s.history,i=s.currLayer,c=s.setCurrLayer,d=s.layers,h=s.setLayers,u=s.lastLayer,x=s.setLastLayer,[g,p]=(0,n.useState)([]),[m,f]=(0,n.useState)(-1),[C,w]=(0,n.useState)(-1),[j,M]=(0,n.useState)(-1);(0,n.useEffect)((()=>{if(-1!==m){const e=document.getElementById(`drawDocLayerNameInput${m}`);return e.focus(),e.select(),e.addEventListener("blur",(()=>f(-1))),e.addEventListener("keydown",(e=>{"Enter"===e.key&&f(-1)})),()=>{e.removeEventListener("blur",(()=>f(-1))),e.removeEventListener("keydown",(e=>{"Enter"===e.key&&f(-1)}))}}}),[m]);const S=(e,t)=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move",M(t)},k=(e,t)=>{e.preventDefault(),e.stopPropagation();let o=[];const n=d[C];if(C<1||C===t)return M(-1),void w(-1);if(0===t)o=[d[0],n,...d.filter(((e,t)=>t!==C&&0!==t))];else if(t===d.length)o=[...d.filter(((e,t)=>t!==C)),n];else if(t===d.length-1){const e=d[t];o=[...d.filter(((e,o)=>o<t&&o!==C)),n,e]}else{const e=d[t];o=[...d.filter(((e,o)=>o<t&&o!==C)),t<C?n:e,t>C?n:e,...d.filter(((e,o)=>o>t&&o!==C))]}h(o),M(-1),w(-1)};return(0,n.useEffect)((()=>{d.length>0&&p(d.map(((e,t)=>((e,t)=>{const o=document.getElementById(e);return(t?o.getContext("2d",{alpha:!0}):o.getContext("2d",{alpha:!1})).canvas.toDataURL("image/png")})(`drawCanvasLayer${e.id}`,!0))))}),[r,d,t]),(0,a.jsxs)("div",{id:"drawDocLayersWindow",onDragOver:e=>{S(e,d.length)},onDrop:e=>{k(e,d.length)},children:[d.map(((e,t)=>(0,a.jsxs)(n.Fragment,{children:[0!==t&&(0,a.jsx)("hr",{style:{display:j===t?"block":"none"}}),(0,a.jsxs)("div",{className:"drawDocLayersWindowLayer",draggable:0!==t,onDragStart:e=>w(t),onDrag:e=>e.preventDefault(),onDragOver:e=>{S(e,t)},onDrop:e=>{k(e,t)},style:{cursor:0===t?"default":"grab"},children:[(0,a.jsx)("img",{src:g[t]?g[t]:"",className:"drawDocCheckersBackground",onClick:()=>c(t),draggable:0!==t}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"radio",value:t,checked:i===t,onChange:()=>c(t)}),(0,a.jsx)("span",{style:{textDecoration:t===i?"underline":"none",display:t===m?"none":"inline-block"},children:e.name}),(0,a.jsx)("input",{style:{display:t===m?"inline-block":"none"},id:`drawDocLayerNameInput${t}`,type:"text",value:e.name,onChange:e=>{((e,t)=>{const o=[...d];o[t].name=e.target.value,h(o)})(e,t)}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{title:"Undo Layer","aria-label":"Undo Layer",disabled:!e.canUndo,onClick:()=>{c(t),o("Undo")},children:(0,a.jsx)(v.qHd,{})}),(0,a.jsx)("button",{title:"Redo Layer","aria-label":"Redo Layer",disabled:!e.canRedo,onClick:()=>{c(t),o("Redo")},children:(0,a.jsx)(v.qQW,{})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{title:"Rename Layer","aria-label":"Rename Layer",disabled:0===t,onClick:()=>f(t),children:(0,a.jsx)(b.Ics,{})}),(0,a.jsx)("button",{title:"Toggle Visibility","aria-label":"Toggle Visibility",onClick:()=>(e=>{const t=[...d];t[e].visible=!t[e].visible,h(t)})(t),children:e.visible?(0,a.jsx)(b.yAb,{}):(0,a.jsx)(b.qRD,{})}),(0,a.jsx)("button",{title:"Delete Layer","aria-label":"Delete Layer",disabled:0===t,onClick:()=>(e=>{h(d.filter(((t,o)=>o!==e))),(e===i||i>d.length-2)&&c(0),o("Delete Layer")})(t),children:(0,a.jsx)(y.G02,{})})]})]})]}),0===t&&(0,a.jsx)("hr",{style:{display:j===t?"block":"none"}})]},e.id))),j===d.length&&(0,a.jsx)("hr",{}),(0,a.jsx)("button",{onClick:()=>{(()=>{const e={id:u+1,name:`Layer ${u+1}`,visible:!0,canUndo:!1,canRedo:!1};h([...d,e]),c(d.length),x(u+1),o("New Layer")})()},children:"New Layer"})]})}function C(e){let{action:t,setAction:o,contextMenu:s}=e;const r=(0,n.useContext)(l),[i,c]=(0,n.useState)(!1),[d,h]=(0,n.useState)("Layers");if(r.view.contentBar)return(0,a.jsxs)("div",{id:"drawDocContentBar",onContextMenu:e=>(e=>{e.preventDefault();let t={Hide:{action:()=>o("contentBar")}};s.setOpen(),s.setPosition(e.clientX,e.clientY),s.setContent(t)})(e),children:[(0,a.jsxs)("nav",{children:[(0,a.jsx)("button",{onClick:()=>c(!i),children:i?(0,a.jsx)(m.NBD,{}):(0,a.jsx)(m.UkA,{})}),(0,a.jsx)("ul",{children:(0,a.jsx)("li",{onClick:()=>{h("Layers"),c(!0)},style:{textDecoration:"Layers"===d?"underline":"none"},children:"Layers"})})]}),(0,a.jsx)("div",{style:{width:i?"auto":"0"},children:"Layers"===d&&(0,a.jsx)(f,{action:t,setAction:o,contextMenu:s})})]})}function w(){const e=(0,n.useContext)(l),t=(e.tool,e.clipboard),o=e.cursor,s=(e.zoom,e.currLayer);e.layers;return(0,a.jsx)("canvas",{id:"carryCanvas",height:t.data.height,width:t.data.width,style:{display:"none",position:"absolute",zIndex:s,top:o.end.y+"px",left:o.end.x+"px"}})}function j(e){let{setAction:t,contextMenu:o}=e;const s=(0,n.useContext)(l),r=(0,n.useRef)(null),i=s.cursor,c=s.setCursor,d=s.tool,h=s.subTool,u=s.curveControls,x=s.setCurveControls,g=s.size,p=s.color.selected,m=s.color[1],b=s.color[2],y=s.text,v=s.setText,f=s.clipboard,C=s.setClipboard,w=s.layers,j={tool:d,subTool:h,curveControls:u,setCurveControls:x,size:g,selectedColor:p,color1:m,setColor1:e=>s.setColor({...s.color,1:e}),color2:b,setColor2:e=>s.setColor({...s.color,2:e}),text:y,setText:v,clipboard:f,setClipboard:C},M=(e,t)=>{let o=r.current,n=o.getContext("2d",{alpha:!0}),a=o.getBoundingClientRect();const l=n.canvas.width/a.width,s=n.canvas.height/a.height;return{x:(e-a.left)*l,y:(t-a.top)*s}},S=e=>{const t=M(e.clientX,e.clientY);if(0===e.button)switch(e.type){case"mousedown":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!0,start:{x:t.x,y:t.y}});break;case"mouseup":c({...i,end:{x:t.x,y:t.y},down:!1});break;case"mousemove":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,current:{x:t.x,y:t.y}});break;case"mouseleave":c({...i,current:{x:t.x,y:t.y}});break;case"mouseenter":0!==e.buttons?c({...i,down:!0,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!1,current:{x:t.x,y:t.y}})}},k=e=>{e.preventDefault();const t=M(e.touches[0].clientX,e.touches[0].clientY);if(1===e.touches.length)switch(e.type){case"touchstart":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!0,start:{x:t.x,y:t.y}});break;case"touchend":c({...i,end:{x:t.x,y:t.y},down:!1});break;case"touchmove":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,current:{x:t.x,y:t.y}})}else c({...i,current:{x:0,y:0},end:{x:t.x,y:t.y},down:!1})};return(0,a.jsx)("canvas",{ref:r,style:{position:"absolute",top:0,left:0,color:j.selectedColor,zIndex:w.length+2},className:"cursor"+j.tool,id:"interfaceCanvas",height:s.dimentions.height,width:s.dimentions.width,onMouseDown:e=>{i.selecting||S(e)},onMouseUp:e=>{i.selecting||S(e)},onMouseMove:e=>{i.selecting||S(e)},onMouseLeave:e=>{i.selecting||S(e)},onMouseEnter:e=>{i.selecting||S(e)},onTouchStart:e=>{i.selecting||k(e)},onTouchEnd:e=>{i.selecting||k(e)},onTouchMove:e=>{i.selecting||k(e)},onTouchCancel:e=>{i.selecting||k(e)},onContextMenu:e=>{i.selecting||(e=>{e.preventDefault();let n={Undo:{action:()=>t("Undo"),disabled:!s.history.canUndo},Redo:{action:()=>t("Redo"),disabled:!s.history.canRedo},LineBreak:{},"Zoom In":{action:()=>t("Zoom In"),disabled:4===s.zoom},"Zoom Out":{action:()=>t("Zoom Out"),disabled:.25===s.zoom},"Zoom Reset":{action:()=>t("Zoom Reset"),disabled:1===s.zoom}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e)}})}var M=o(7980),S=o(5051),k=o(3825),T=o(9106);const D=e=>{let{setAction:t,contextMenu:o}=e;const s=(0,n.useContext)(l);if(s.view.topNavBar)return(0,a.jsxs)("nav",{id:"drawDocTopNavBar",onContextMenu:e=>(e=>{e.preventDefault();let n={Hide:{action:()=>t("topNavBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e),children:[(0,a.jsx)("button",{title:"Undo",onClick:()=>t("Undo"),disabled:!s.layers[s.currLayer].canUndo,children:(0,a.jsx)(v.qHd,{})}),(0,a.jsx)("button",{title:"Redo",onClick:()=>t("Redo"),disabled:!s.layers[s.currLayer].canRedo,children:(0,a.jsx)(v.qQW,{})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"New File",onClick:()=>t("New"),children:(0,a.jsx)(M.QB2,{})}),(0,a.jsx)("button",{title:"Download File",onClick:()=>t("Save"),disabled:!(s.history.canRedo||s.history.canUndo),children:(0,a.jsx)(M.RZ0,{})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsx)("button",{title:"Color 1",className:s.color.selected===s.color[1]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[1]}),children:(0,a.jsx)("label",{htmlFor:"drawColor1",style:{textDecoration:s.color.selected===s.color[1]?"underline":""},onClick:e=>e.preventDefault(),children:"1"})}),(0,a.jsx)(T.A,{color:s.color[1],setColor:e=>{s.setColor({...s.color,selected:e,1:e})},useAlpha:!1})]}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsx)("button",{title:"Color 2",className:s.color.selected===s.color[2]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[2]}),children:(0,a.jsx)("label",{htmlFor:"drawColor2",style:{textDecoration:s.color.selected===s.color[2]?"underline":""},onClick:e=>e.preventDefault(),children:"2"})}),(0,a.jsx)(T.A,{color:s.color[2],setColor:e=>s.setColor({...s.color,selected:e,2:e}),useAlpha:!1})]}),(0,a.jsx)("vertical-rect",{}),"Magnifier"===s.tool&&(0,a.jsxs)("select",{value:s.zoom,onChange:e=>{(e=>{s.setZoom(Number(e.target.value)),"0.25"===e.target.value?t("Zoom Min"):"4"===e.target.value?t("Zoom Max"):"1"===e.target.value?t("Zoom Default"):t("Zoom Change")})(e)},title:"Zoom",children:[(0,a.jsx)("option",{value:.25,children:"25%"}),(0,a.jsx)("option",{value:.5,children:"50%"}),(0,a.jsx)("option",{value:.75,children:"75%"}),(0,a.jsx)("option",{value:1,children:"100%"}),(0,a.jsx)("option",{value:2,children:"200%"}),(0,a.jsx)("option",{value:3,children:"300%"}),(0,a.jsx)("option",{value:4,children:"400%"})]}),"Select"!==s.tool&&"Pipette"!==s.tool&&"Magnifier"!==s.tool&&"Bucket"!==s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k._DL,{}),(0,a.jsx)("input",{type:"number",min:"1",max:"100",value:s.size,onChange:e=>s.setSize(Number(e.target.value)),title:"Text"===s.tool?"Font Size":"Shape"===s.tool?"Line Width":"Radius"})]}),"Text"===s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(b.Oui,{}),(0,a.jsxs)("select",{title:"Font Family",value:s.text.fontFamily,onChange:e=>s.setText({...s.text,fontFamily:e.target.value}),children:[(0,a.jsx)("option",{children:"Arial"}),(0,a.jsx)("option",{children:"Times New Roman"}),(0,a.jsx)("option",{children:"Monospace"}),(0,a.jsx)("option",{children:"Verdana"}),(0,a.jsx)("option",{children:"Georgia"}),(0,a.jsx)("option",{children:"Courier New"}),(0,a.jsx)("option",{children:"Tahoma"}),(0,a.jsx)("option",{children:"Garamond"}),(0,a.jsx)("option",{children:"Impact"}),(0,a.jsx)("option",{children:"Comic Sans MS"}),(0,a.jsx)("option",{children:"Lucida Console"}),(0,a.jsx)("option",{children:"Lucida Sans Unicode"}),(0,a.jsx)("option",{children:"Palatino Linotype"}),(0,a.jsx)("option",{children:"Symbol"}),(0,a.jsx)("option",{children:"Wingdings"}),(0,a.jsx)("option",{children:"Helvetica"})]}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(S.kZ9,{}),(0,a.jsx)("input",{title:"Line Height",type:"number",step:"0.01",min:"0",value:s.text.lineHeight,onChange:e=>{s.setText({...s.text,lineHeight:e.target.value})}}),(0,a.jsx)("vertical-rect",{})]}),"Shape"===s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(b.u8p,{}),(0,a.jsxs)("select",{title:"Shape",value:s.subTool.shape,onChange:e=>s.setSubTool({...s.subTool,shape:e.target.value}),children:[(0,a.jsx)("option",{children:"Line"}),(0,a.jsx)("option",{children:"Curve"}),(0,a.jsx)("option",{children:"Circle"}),(0,a.jsx)("option",{children:"Rectangle"}),(0,a.jsx)("option",{children:"Polygon"}),(0,a.jsx)("option",{children:"Star"}),(0,a.jsx)("option",{children:"Arrow"}),(0,a.jsx)("option",{children:"Heart"})]}),(0,a.jsx)("vertical-rect",{}),("Polygon"===s.subTool.shape||"Star"===s.subTool.shape)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.RIm,{}),(0,a.jsx)("input",{type:"number",title:"Sides",value:s.subTool.sides,onChange:e=>s.setSubTool({...s.subTool,sides:e.target.value}),min:"3",step:"1"}),(0,a.jsx)("vertical-rect",{})]})]})]})},I=e=>{let{subtool:t,isSelected:o}=e,l=(0,n.useRef)(null);const s={drawCircleIcon:(e,o,n)=>{e.beginPath(),e.arc(o/2,n/2,n/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath()},drawEllipseIcon:(e,o,n)=>{e.scale(1,.5),e.beginPath(),e.beginPath(),e.arc(o/2,n,n/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath(),e.scale(1,2)},drawRectangleIcon:(e,o,n)=>{t.fill&&e.fillRect(0,n/4,o,n/2),e.strokeRect(0,n/4,o,n/2)},drawPolygonIcon:(e,o,n)=>{e.beginPath();for(let a=0;a<t.sides;a++)e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*a/t.sides-Math.PI/2),n/2+(n/2-3)*Math.sin(2*Math.PI*a/t.sides-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawLineIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/4,2),e.lineTo(3*t/4,o-2),e.closePath(),e.stroke()},drawCurveIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/6,2),e.bezierCurveTo(5*t/6,o/5,t/6,4*o/5-2,5*t/6,o-2),e.stroke()},drawStarIcon:(e,o,n)=>{e.beginPath(),e.moveTo(o/2,3);for(let a=0;a<2*t.sides;a++)a%2===0?e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*a/(2*t.sides)-Math.PI/2),n/2+(n/2-3)*Math.sin(2*Math.PI*a/(2*t.sides)-Math.PI/2)):e.lineTo(o/2+(o/4-3)*Math.cos(2*Math.PI*a/(2*t.sides)-Math.PI/2),n/2+(n/4-3)*Math.sin(2*Math.PI*a/(2*t.sides)-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawArrowIcon:(e,o,n)=>{e.beginPath(),e.moveTo(2,n/3),e.lineTo(o/2,n/3),e.lineTo(o/2,2),e.lineTo(o-2,n/2),e.lineTo(o/2,n-2),e.lineTo(o/2,2*n/3),e.lineTo(2,2*n/3),e.closePath(),e.stroke(),t.fill&&e.fill()},drawHeartIcon:(e,o,n)=>{e.beginPath(),e.moveTo(o/2,n-3),e.arc(o/4+1,n/3,o/4-1,3*Math.PI/4,0,!1),e.arc(3*o/4-1,n/3,o/4-1,Math.PI,Math.PI/4,!1),e.closePath(),e.stroke(),t.fill&&e.fill()}};return(0,n.useEffect)((()=>{const e=l.current.getContext("2d"),o=e.canvas.height,n=e.canvas.width;e.clearRect(0,0,n,o),e.fillStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.strokeStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.lineWidth=2,s["draw"+t.shape+"Icon"](e,n,o)}),[t,o]),(0,a.jsx)("canvas",{ref:l,id:"shapeCanvas",width:"25",height:"25",title:"Custom Shape"})};var B=o(2639),P=o(8973),N=o(2021),E=o(7962),L=o(9698);const z=e=>{let{setAction:t,contextMenu:o,isSelected:s}=e;const r=(0,n.useContext)(l),i=r.tool,c=r.subTool,d=r.setTool,h={Brush:(0,a.jsx)(B.Nw5,{title:"Brush"}),Eraser:(0,a.jsx)(M.qpr,{title:"Eraser"}),Bucket:(0,a.jsx)(M.ATI,{title:"Bucket"}),Spray:(0,a.jsx)(M.bOX,{title:"Spray Can"}),Text:(0,a.jsx)(N.tEi,{title:"Insert Text"}),Pipette:(0,a.jsx)(P._e3,{title:"Color Picker"}),Magnifier:(0,a.jsx)(E.JJh,{title:"Zoom"}),Select:(0,a.jsx)(L.ZdE,{title:"Selection"}),Shape:(0,a.jsx)(I,{subtool:c,isSelected:s})};if(r.view.toolBar)return(0,a.jsx)("nav",{id:"drawDocToolBar",onContextMenu:e=>(e=>{e.preventDefault();let n={Hide:{action:()=>t("toolBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e),children:Object.keys(h).map((e=>(0,a.jsx)("button",{onClick:()=>d(e),className:i===e?"buttonActive":"",children:h[e]},e+"drawToolDropdown")))})},A=e=>{let{action:t,setAction:o,contextMenu:s}=e;const r=(0,n.useContext)(l);if(r.view.bottomNavBar)return(0,a.jsxs)("nav",{id:"drawDocBottomNavBar",onContextMenu:e=>(e=>{e.preventDefault();let t={Hide:{action:()=>o("bottomNavBar")}};s.setOpen(),s.setPosition(e.clientX,e.clientY),s.setContent(t)})(e),children:["Text"===r.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Confirm Text",onClick:()=>o("confirm"),children:(0,a.jsx)("small",{children:"Confirm"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Use Fill",className:r.text.fill?"buttonActive":"",onClick:()=>{r.setText({...r.text,fill:!r.text.fill})},children:(0,a.jsx)("small",{children:"Fill"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Use Stroke",className:r.text.stroke?"buttonActive":"",onClick:()=>{r.setText({...r.text,stroke:!r.text.stroke})},children:(0,a.jsx)("small",{children:"Stroke"})}),(0,a.jsx)("input",{title:"Stroke Width",type:"number",step:"1",min:"1",max:r.size-1,value:r.text.strokeWidth,onChange:e=>{r.setText({...r.text,strokeWidth:e.target.value})}}),(0,a.jsx)("vertical-rect",{})]}),"Select"===r.tool?(0,a.jsx)(a.Fragment,{children:"clipping"===t&&"carry"===r.clipboard.state?(0,a.jsx)("button",{title:"Paste",onClick:()=>{o("confirm"),r.setClipboard({...r.clipboard,state:"paste"})},children:(0,a.jsx)("small",{children:"Paste"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Cut",onClick:()=>{o("clipping"),r.setClipboard({...r.clipboard,state:"cut"})},children:(0,a.jsx)("small",{children:"Cut"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Copy",onClick:()=>{o("clipping"),r.setClipboard({...r.clipboard,state:"copy"})},children:(0,a.jsx)("small",{children:"Copy"})})]})}):null,"Shape"===r.tool?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Confirm Shape",onClick:()=>o("confirm"),children:(0,a.jsx)("small",{children:"Confirm"})}),(0,a.jsx)("vertical-rect",{}),"Curve"===r.subTool.shape&&(0,a.jsx)("button",{title:"Cancel Shape",onClick:()=>o("cancel"),children:(0,a.jsx)("small",{children:"Cancel"})}),"Line"!==r.subTool.shape&&"Curve"!==r.subTool.shape?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Fill",className:r.subTool.fill?"buttonActive":"",onClick:()=>r.setSubTool({...r.subTool,fill:!r.subTool.fill}),children:(0,a.jsx)("small",{children:"Fill"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Stretch",className:r.subTool.stretch?"buttonActive":"",onClick:()=>r.setSubTool({...r.subTool,stretch:!r.subTool.stretch}),children:(0,a.jsx)("small",{children:"Stretch"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("button",{children:[(0,a.jsx)("label",{htmlFor:"rotationAngle",children:"Rotation"}),(0,a.jsx)("input",{type:"number",title:"Rotation Angle",id:"rotationAngle",value:r.subTool.angle,onChange:e=>r.setSubTool({...r.subTool,angle:e.target.value}),step:"1"})]}),(0,a.jsx)("vertical-rect",{}),"Polygon"===r.subTool.shape||"Star"===r.subTool.shape?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{children:[(0,a.jsx)("label",{htmlFor:"startAngle",children:"Start Angle"}),(0,a.jsx)("input",{type:"number",title:"Start Angle",id:"startAngle",value:r.subTool.startAngle,onChange:e=>r.setSubTool({...r.subTool,startAngle:e.target.value}),step:"1"})]}),(0,a.jsx)("vertical-rect",{})]}):null]}):null]}):null]})};function R(e){const t=e.action,o=e.setAction,r=e.appMenu,i=e.setAppMenu,c=e.appDialog,d=e.setAppDialog,h=e.contextMenu,u=e.canClose,m=e.setCanClose,b=e.isSelected,y=e.title,v=e.setTitle;(0,n.useContext)(l);return(0,a.jsx)(s,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D,{setAction:o,contextMenu:h}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%",margin:"0px"},children:[(0,a.jsx)(z,{setAction:o,contextMenu:h,isSelected:b}),(0,a.jsxs)("canvas-container",{children:[(0,a.jsx)(x,{action:t,setAction:o,appMenu:r,setAppMenu:i,appDialog:c,setAppDialog:d,contextMenu:h,canClose:u,setCanClose:m,title:y,setTitle:v}),(0,a.jsx)(w,{}),(0,a.jsx)(g,{}),(0,a.jsx)(j,{action:t,setAction:o,contextMenu:h}),(0,a.jsx)(p,{})]}),(0,a.jsx)(C,{action:t,setAction:o,contextMenu:h})]}),(0,a.jsx)(A,{action:t,setAction:o,contextMenu:h})]})})}},9106:(e,t,o)=>{o.d(t,{A:()=>i});var n=o(5043),a=o(7950);function l(e){let t=e[0],o=e[1],n=e[2];t/=255,o/=255,n/=255;let a=Math.min(t,o,n),l=Math.max(t,o,n),s=l-a,r=0,i=0,c=(l+a)/2;return 0===s?(i=0,r=0):(i=c<=.5?s/(l+a):s/(2-l-a),l===t?r=(o-n)/s:l===o?r=(n-t)/s+2:l===n&&(r=(t-o)/s+4)),r=Math.round(60*r),r<0&&(r+=360),i=Math.abs(100*i).toFixed(0),c=(100*c).toFixed(0),[r,i+"%",c+"%"]}function s(e){var t=e[0],o=e[1],n=e[2],a=e[3];t=parseInt(e[1],16),o=parseInt(e[2],16),n=parseInt(e[3],16),a=parseInt(e[4],16);t/=255,o/=255,n/=255;let l=Math.min(t,o,n),s=Math.max(t,o,n),r=s-l,i=0,c=0,d=(s+l)/2;return 0===r?(c=0,i=0):(c=d<=.5?r/(s+l):r/(2-s-l),s===t?i=(o-n)/r:s===o?i=(n-t)/r+2:s===n&&(i=(t-o)/r+4)),i=Math.round(60*i),i<0&&(i+=360),c=Math.abs(100*c).toFixed(0),d=(100*d).toFixed(0),[i,c+"%",d+"%",a]}o(7915);var r=o(579);function i(e){let{color:t,setColor:o,useAlpha:i}=e;const c=(0,n.useRef)(null),d=(0,n.useRef)(null),h=(0,n.useRef)(null),u=(0,n.useRef)(null),[x,g]=(0,n.useState)({x:0,y:0}),[p,m]=(0,n.useState)(0),[b,y]=(0,n.useState)(0),[v,f]=(0,n.useState)(!1),[C,w]=(0,n.useState)(0),[j,M]=(0,n.useState)(50),[S,k]=(0,n.useState)(100),[T,D]=(0,n.useState)(100);(0,n.useEffect)((()=>{v&&c.current.focus()}),[v]);(0,n.useEffect)((()=>{if(t)if(i){let n=[];if("#"===t[0])n=s(function(e){var t;return 5===e.length?0==(t=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e))[4]&&(t[4]="ff"):9===e.length?t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e):8===e.length&&((t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))[4]="ff"),t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16)/255]:null}(t));else if("rgba"===t.slice(0,4))n=s(t);else if("hsla"===t.slice(0,4))for(let a=0;a<t.length;a++){"("===t[a]?e=a+1:")"===t[a]?(o=a,n.push(t.slice(e,o))):","===t[a]&&(n.push(t.slice(e,a)),e=a+1)}if(w(Number(n[0])),k(Number(n[1].slice(0,n[1].length-1))),M(Number(n[2].slice(0,n[2].length-1))),D(Number(n[3])),v){const e=d.current.getBoundingClientRect();g({x:n[0]/360*e.width,y:(100-n[2].slice(0,n[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-n[1].slice(0,n[1].length-1))/100*t.height);const o=u.current.getBoundingClientRect();y(n[3]*o.width)}}else{let n=[];if("#"===t[0])n=l(function(e){var t;return(t=4===e.length?/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e):/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}(t));else if("rgb"===t.slice(0,3))n=l(t);else if("hsl"===t.slice(0,3))for(let a=0;a<t.length;a++){var e,o;"("===t[a]?e=a+1:")"===t[a]?(o=a,n.push(t.slice(e,o))):","===t[a]&&(n.push(t.slice(e,a)),e=a+1)}else n=function(e){switch(e){case"red":case"maroon":return[0,"100%","50%"];case"green":case"lime":return[120,"100%","50%"];case"blue":case"aqua":case"navy":return[240,"100%","50%"];case"yellow":case"olive":return[60,"100%","50%"];case"cyan":case"teal":return[180,"100%","50%"];case"magenta":return[300,"100%","50%"];case"black":default:return[0,"0%","0%"];case"white":return[0,"0%","100%"];case"gray":case"grey":return[0,"0%","50%"];case"lightgray":case"lightgrey":return[0,"0%","75%"];case"darkgray":case"darkgrey":return[0,"0%","25%"];case"brown":return[30,"50%","50%"];case"orange":return[30,"100%","50%"];case"purple":return[270,"100%","50%"];case"pink":return[330,"100%","50%"]}}(t);if(w(Number(n[0])),k(Number(n[1].slice(0,n[1].length-1))),M(Number(n[2].slice(0,n[2].length-1))),v){const e=d.current.getBoundingClientRect();g({x:n[0]/360*e.width,y:(100-n[2].slice(0,n[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-n[1].slice(0,n[1].length-1))/100*t.height)}}}),[v,t,i]);(0,n.useEffect)((()=>{if(d.current){(e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height);let t=e.canvas.width/360,o=e.canvas.height/100;for(let n=0;n<360;n++)for(let a=0;a<100;a++)e.fillStyle=`hsl(${n},${S}%,${100-a}%)`,e.fillRect(n*t,a*o,(n+1)*t,(a+1)*o)})(d.current.getContext("2d",{alpha:!1}))}}),[v,S]);const I=e=>{if(0!==e.buttons){const t=d.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(g({x:o,y:n}),w(Math.floor(360*o/t.width)),M(100-Math.floor(100*n/t.height)))}},B=e=>{if(1===e.touches.length){const t=d.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(g({x:o,y:n}),w(Math.floor(360*o/t.width)),M(100-Math.floor(100*n/t.height)))}},P=e=>{if(0!==e.buttons){const t=h.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(k(100-Math.floor(100*n/t.height)),m(n))}},N=e=>{if(1===e.touches.length){const t=h.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(k(100-Math.floor(100*n/t.height)),m(n))}},E=e=>{if(0!==e.buttons){const t=u.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(D(Math.floor(100*o/t.width)/100),y(o))}},L=e=>{if(1===e.touches.length){const t=u.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(D(Math.floor(100*o/t.width)/100),y(o))}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("color-picker-button",{onClick:()=>f(!v),children:(0,r.jsx)("div",{children:(0,r.jsx)("button",{style:{background:t}})})}),v&&(0,a.createPortal)((0,r.jsxs)("color-picker-window",{tabIndex:"0",ref:c,onBlur:e=>{var t;(t=e).currentTarget.contains(t.relatedTarget)||f(!1)},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("hue-light-map",{children:[(0,r.jsx)("canvas",{onMouseDown:e=>I(e),onMouseMove:e=>I(e),onTouchMove:e=>B(e),onTouchStart:e=>B(e),onTouchEnd:e=>B(e),ref:d,width:"180",height:"180",style:{opacity:i?T:1}}),(0,r.jsx)("slider-thumb",{style:{top:x.y,left:x.x,background:i?`hsla(${C},${S}%,${j}%, ${T})`:`hsl(${C},${S}%,${j}%)`},onMouseDown:e=>I(e),onMouseMove:e=>I(e),onTouchMove:e=>B(e),onTouchStart:e=>B(e),onTouchEnd:e=>B(e)})]}),(0,r.jsxs)("saturation-slider",{title:"Saturation",children:[(0,r.jsx)("div",{ref:h,style:{background:`linear-gradient(0deg, hsl(${C},0%,${j}%), hsla(${C},100%,${j}%))`},onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>N(e),onTouchStart:e=>N(e),onTouchEnd:e=>N(e)}),(0,r.jsx)("slider-thumb",{style:{top:p,background:`hsla(${C},${S}%,${j}%, ${T})`},onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>N(e),onTouchStart:e=>N(e),onTouchEnd:e=>N(e)})]})]}),i&&(0,r.jsxs)("alpha-slider",{title:"Alpha",children:[(0,r.jsx)("div",{ref:u,style:{background:`linear-gradient(90deg, hsla(${C},${S}%,${j}%, 0), hsla(${C},${S}%,${j}%, 1))`},onMouseDown:e=>E(e),onMouseMove:e=>E(e),onTouchMove:e=>L(e),onTouchStart:e=>L(e),onTouchEnd:e=>L(e)}),(0,r.jsx)("slider-thumb",{style:{left:b,background:`hsl(${C},${S}%,${j}%, ${T})`},onMouseDown:e=>E(e),onMouseMove:e=>E(e),onTouchMove:e=>L(e),onTouchStart:e=>L(e),onTouchEnd:e=>L(e)})]}),(0,r.jsxs)("color-inputs",{children:[(0,r.jsxs)("div",{children:["Hue",(0,r.jsx)("input",{type:"number",min:"0",max:"360",value:C,onChange:e=>(e=>{w(e);const t=d.current.getBoundingClientRect();g({...x,x:e/360*t.width})})(e.target.value)})]}),(0,r.jsxs)("div",{children:["Lum.",(0,r.jsx)("input",{type:"number",min:"0",max:"100",value:j,onChange:e=>(e=>{M(e);const t=d.current.getBoundingClientRect();g({...x,y:(100-e)/100*t.height})})(e.target.value)})]}),(0,r.jsxs)("div",{children:["Sat.",(0,r.jsx)("input",{type:"number",min:"0",max:"100",value:S,onChange:e=>(e=>{k(e);const t=h.current.getBoundingClientRect();m((100-e)/100*t.height)})(e.target.value)})]}),i&&(0,r.jsxs)("div",{children:["Alpha",(0,r.jsx)("input",{type:"number",min:"0",max:"1",step:"0.01",value:T,onChange:e=>(e=>{D(e);const t=u.current.getBoundingClientRect();y(e*t.width)})(e.target.value)})]})]}),(0,r.jsx)("color-button",{children:(0,r.jsx)("button",{style:{background:i?`hsla(${C},${S}%,${j}%, ${T})`:`hsl(${C},${S}%,${j}%)`},onClick:()=>{o(i?`hsla(${C},${S}%,${j}%, ${T})`:`hsl(${C},${S}%,${j}%)`)},children:"Apply"})})]}),document.getElementById("root"))]})}}}]);
//# sourceMappingURL=615.f980dbca.chunk.js.map