{"version":3,"file":"static/js/615.37165e59.chunk.js","mappings":"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","sources":["Apps/DrawDoc/Context.jsx","Apps/DrawDoc/Handlers/handleDraw.js","Apps/DrawDoc/Handlers/handleTools.js","Apps/DrawDoc/Handlers/handleTopMenu.js","Apps/DrawDoc/Handlers/handleHistory.js","Apps/DrawDoc/Handlers/handleFile.js","Apps/DrawDoc/Handlers/handleAction.jsx","Apps/DrawDoc/Dialog/new.jsx","Apps/DrawDoc/Dialog/saveAs.jsx","Apps/DrawDoc/Dialog/changeName.jsx","Apps/DrawDoc/Dialog/closeApp.jsx","Apps/DrawDoc/Components/DrawCanvas.jsx","Apps/DrawDoc/Components/PreviewCanvas.jsx","Apps/DrawDoc/Components/SelectionCanvas.jsx","Apps/DrawDoc/Components/LayersWindow.jsx","Apps/DrawDoc/Components/ContentBar.jsx","Apps/DrawDoc/Components/CarryCanvas.jsx","Apps/DrawDoc/Components/CanvasInterface.jsx","Apps/DrawDoc/Components/TopNavBar.jsx","Apps/DrawDoc/Components/SubToolIcon.jsx","Apps/DrawDoc/Components/ToolBar.jsx","Apps/DrawDoc/Components/BottomNavBar.jsx","Apps/DrawDoc/index.jsx","System/GlobalComponents/ColorPicker/Converters/rgbToHsl.js","System/GlobalComponents/ColorPicker/Converters/rgbaToHsla.js","System/GlobalComponents/ColorPicker/ColorPicker.jsx","System/GlobalComponents/ColorPicker/Converters/hexToRgba.js","System/GlobalComponents/ColorPicker/Converters/hexToRgb.js","System/GlobalComponents/ColorPicker/Converters/nameToHsl.js"],"sourcesContent":["import { useState, createContext } from \"react\";\r\n\r\nexport const Context = createContext({\r\n  currLayer: 0,\r\n  layers: [],\r\n  setLayers: () => { },\r\n  lastLayer: 0,\r\n  setLastLayer: () => { },\r\n  name: \"\",\r\n  setName: () => { },\r\n  setCurrLayer: () => { },\r\n  history: {},\r\n  setHistory: () => { },\r\n  dimentions: {},\r\n  setDimentions: () => { },\r\n  useAlpha: false,\r\n  setUseAlpha: () => { },\r\n  newParams: {},\r\n  setNewParams: () => { },\r\n  tool: \"\",\r\n  setTool: () => { },\r\n  brushPoints: {},\r\n  setBrushPoints: () => { },\r\n  subTool: {},\r\n  setSubTool: () => { },\r\n  curveControls: {},\r\n  setCurveControls: () => { },\r\n  color: {},\r\n  setColor: () => { },\r\n  size: 0,\r\n  setSize: () => { },\r\n  text: {},\r\n  setText: () => { },\r\n  clipboard: {},\r\n  setClipboard: () => { },\r\n  zoom: 1,\r\n  setZoom: () => { },\r\n  cursor: {},\r\n  setCursor: () => { },\r\n  view: {},\r\n  setView: () => { },\r\n});\r\n\r\nexport function ContextProvider({ children }) {\r\n  const [currLayer, setCurrLayer] = useState(0);\r\n  const [layers, setLayers] = useState([\r\n    {\r\n      id: 0,\r\n      name: \"Base\",\r\n      blending: \"normal\",\r\n      filters:{},\r\n      opacity: 1,\r\n      visible: true,\r\n      locked: false,\r\n      canUndo: false,\r\n      canRedo: false\r\n    }\r\n  ]);\r\n  const [lastLayer, setLastLayer] = useState(0);\r\n  const [name, setName] = useState(\"Untitled\");\r\n  const [history, setHistory] = useState({\r\n    0: {\r\n      data: [],\r\n      lastIndex: 0\r\n    }\r\n  });\r\n  const [dimentions, setDimentions] = useState({ width: 350, height: 350, });\r\n  const [useAlpha, setUseAlpha] = useState(false);\r\n  const [newParams, setNewParams] = useState({\r\n    width: 350,\r\n    height: 350,\r\n    alpha: false,\r\n    name: \"Untitled\",\r\n  });\r\n  const [tool, setTool] = useState(\"Brush\");\r\n  const [brushPoints, setBrushPoints] = useState([]);\r\n  const [subTool, setSubTool] = useState({\r\n    shape: \"Circle\",\r\n    fill: false,\r\n    stretch: false,\r\n    sides: 4,\r\n    angle: 0,\r\n    startAngle: 0,\r\n    lineJoin: \"round\",\r\n    lineCap: \"round\",\r\n    radii: [10, 10, 10, 10],\r\n  });\r\n  const [curveControls, setCurveControls] = useState({\r\n    state: \"none\",\r\n    start: { x: -1, y: -1 },\r\n    end: { x: -1, y: -1 },\r\n    controlPoint1: { x: -1, y: -1 },\r\n    controlPoint2: { x: -1, y: -1 }\r\n  });\r\n  const [color, setColor] = useState({\r\n    selected: \"hsl(0, 100%, 0%)\",\r\n    1: \"hsla(0, 100%, 0%, 1)\",\r\n    2: \"hsla(0, 100%, 100%, 1)\",\r\n  });\r\n  const [size, setSize] = useState(16);\r\n  const [text, setText] = useState({\r\n    text: \"\",\r\n    fill: true,\r\n    stroke: false,\r\n    strokeWidth: 2,\r\n    lineHeight: 1.2,\r\n    fontFamily: \"Arial\",\r\n    state: \"none\",\r\n  });\r\n  const [clipboard, setClipboard] = useState({\r\n    data: {},\r\n    state: \"none\",\r\n  });\r\n  const [zoom, setZoom] = useState(1);\r\n  const [cursor, setCursor] = useState({\r\n    current: { x: 0, y: 0 },\r\n    start: { x: 0, y: 0 },\r\n    end: { x: 0, y: 0 },\r\n    down: false,\r\n    selecting: false\r\n  });\r\n  const [view, setView] = useState({\r\n    toolBar: true,\r\n    contentBar: true,\r\n    topNavBar: true,\r\n    bottomNavBar: true,\r\n    menu: true\r\n  })\r\n\r\n  const contextValue = {\r\n    currLayer: currLayer,\r\n    layers: layers,\r\n    setLayers: setLayers,\r\n    lastLayer: lastLayer,\r\n    setLastLayer: setLastLayer,\r\n    name: name,\r\n    setName: setName,\r\n    history: history,\r\n    setHistory: setHistory,\r\n    setCurrLayer: setCurrLayer,\r\n    dimentions: dimentions,\r\n    setDimentions: setDimentions,\r\n    useAlpha: useAlpha,\r\n    setUseAlpha: setUseAlpha,\r\n    newParams: newParams,\r\n    setNewParams: setNewParams,\r\n    tool: tool,\r\n    setTool: setTool,\r\n    brushPoints: brushPoints,\r\n    setBrushPoints: setBrushPoints,\r\n    subTool: subTool,\r\n    setSubTool: setSubTool,\r\n    curveControls: curveControls,\r\n    setCurveControls: setCurveControls,\r\n    color: color,\r\n    setColor: setColor,\r\n    size: size,\r\n    setSize: setSize,\r\n    text: text,\r\n    setText: setText,\r\n    clipboard: clipboard,\r\n    setClipboard: setClipboard,\r\n    zoom: zoom,\r\n    setZoom: setZoom,\r\n    cursor: cursor,\r\n    setCursor: setCursor,\r\n    view: view,\r\n    setView: setView\r\n  };\r\n\r\n  return (\r\n    <Context.Provider value={contextValue}>{children}</Context.Provider>\r\n  );\r\n}\r\n\r\nexport default ContextProvider;","export const handleDraw = (canvas, cursor, param, preview, action) => {\r\n    let ctx;\r\n    if (preview) {\r\n        ctx = canvas.getContext('2d', { alpha: true });\r\n    } else {\r\n        ctx = canvas.getContext('2d', { alpha: true });\r\n    }\r\n    ctx.webkitImageSmoothingEnabled = false;\r\n    ctx.mozImageSmoothingEnabled = false;\r\n    ctx.imageSmoothingEnabled = false;\r\n    const height = ctx.canvas.height;\r\n    const width = ctx.canvas.width;\r\n\r\n    const x = cursor.current.x;\r\n    const y = cursor.current.y;\r\n    const startX = cursor.start.x;\r\n    const startY = cursor.start.y;\r\n    const endX = cursor.end.x;\r\n    const endY = cursor.end.y;\r\n\r\n    const drawBrush = () => {\r\n        if (action !== \"drawing\" && action !== \"finished\") {\r\n            ctx.strokeStyle = param.selectedColor;\r\n            ctx.fillStyle = param.selectedColor;\r\n            ctx.lineWidth = 1;\r\n            ctx.setLineDash([]);\r\n            ctx.beginPath();\r\n            ctx.arc(\r\n                x,\r\n                y,\r\n                param.size / 2,\r\n                0,\r\n                Math.PI * 2,\r\n            );\r\n            ctx.fill();\r\n            ctx.stroke();\r\n            ctx.closePath();\r\n        } else if (action === \"drawing\" && param.brushPoints.length > 1) {\r\n            ctx.strokeStyle = param.selectedColor;\r\n            ctx.lineWidth = param.size;\r\n            ctx.lineCap = \"round\";\r\n            ctx.lineJoin = \"round\";\r\n            ctx.setLineDash([]);\r\n            ctx.beginPath();\r\n            ctx.moveTo(param.brushPoints[param.brushPoints.length - 2][0], param.brushPoints[param.brushPoints.length - 2][1]);\r\n            ctx.lineTo(param.brushPoints[param.brushPoints.length - 1][0], param.brushPoints[param.brushPoints.length - 1][1]);\r\n            ctx.stroke();\r\n        }\r\n    };\r\n\r\n    const drawEraser = () => {\r\n        ctx.strokeStyle = param.selectedColor;\r\n        ctx.fillStyle = param.selectedColor;\r\n        ctx.lineWidth = 1;\r\n        ctx.setLineDash([]);\r\n        ctx.beginPath();\r\n        ctx.arc(\r\n            x,\r\n            y,\r\n            param.size,\r\n            0,\r\n            Math.PI * 2,\r\n        );\r\n        if (!preview) {\r\n            ctx.fill();\r\n        } else {\r\n            ctx.stroke();\r\n        }\r\n        ctx.closePath();\r\n    }\r\n\r\n    const drawSpray = () => {\r\n        let randomX = Math.random() * param.size;\r\n        let randomNegativeX = Math.random();\r\n        let randomY = Math.random() * param.size;\r\n        let randomNegativeY = Math.random();\r\n        while (Math.sqrt(Math.pow(randomX, 2) + Math.pow(randomY, 2)) > param.size) {\r\n            randomX = Math.random() * param.size;\r\n            randomY = Math.random() * param.size;\r\n        }\r\n        if (randomNegativeY > 0.5) {\r\n            randomY = randomY * -1;\r\n        }\r\n        if (randomNegativeX > 0.5) {\r\n            randomX = randomX * -1;\r\n        }\r\n        ctx.fillStyle = param.selectedColor;\r\n        ctx.fillRect(\r\n            x + randomX,\r\n            y + randomY,\r\n            1,\r\n            1,\r\n        );\r\n    };\r\n\r\n    const drawPipette = () => {\r\n        let pixel = ctx.getImageData(\r\n            x,\r\n            y,\r\n            1,\r\n            1,\r\n        );\r\n        // convert from rgba to hsla\r\n        let r = pixel.data[0],\r\n            g = pixel.data[1],\r\n            b = pixel.data[2],\r\n            a = pixel.data[3];\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        a /= 255;\r\n        let cmin = Math.min(r, g, b),\r\n            cmax = Math.max(r, g, b),\r\n            delta = cmax - cmin,\r\n            h = 0,\r\n            s = 0,\r\n            l = ((cmax + cmin) / 2);\r\n        if (delta === 0) {\r\n            s = 0;\r\n            h = 0;\r\n        } else {\r\n            if (l <= 0.5) {\r\n                s = delta / (cmax + cmin);\r\n            } else {\r\n                s = delta / (2 - cmax - cmin);\r\n            };\r\n            if (cmax === r) {\r\n                h = (g - b) / delta;\r\n            } else if (cmax === g) {\r\n                h = ((b - r) / delta) + 2;\r\n            } else if (cmax === b) {\r\n                h = ((r - g) / delta) + 4;\r\n            }\r\n        }\r\n        h = Math.round(h * 60);\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        s = Math.abs(s * 100).toFixed(0);\r\n        l = (l * 100).toFixed(0);\r\n        let color = \"hsla(\" + h + \",\" + s + \"%,\" + l + \"%,\" + a + \")\";\r\n        //assign color\r\n        if (param.tool === \"Pipette\") {\r\n            if (param.selectedColor === param.color1) {\r\n                param.setColor1(color);\r\n            } else {\r\n                param.setColor2(color);\r\n            }\r\n        } else {\r\n            return color;\r\n        }\r\n    };\r\n\r\n    //Bucket code based on Spawn Fill algorithm in \r\n    //https://stackoverflow.com/questions/2106995/how-can-i-perform-flood-fill-with-html-canvas/56221940#56221940\r\n    //answer from user gman.\r\n    //Regular flood fill algorithm is too slow as it looks at individual pixels.\r\n    //This solution looks at entire lines and fills them in.\r\n    //Code has been edited to work with hsla color values\r\n    const drawBucket = () => {\r\n        let r, g, b, h, s, l, alpha;\r\n        let hslaColor = [];\r\n        for (let i = 0; i < param.selectedColor.length; i++) {\r\n            var start;\r\n            var end;\r\n            if (param.selectedColor[i] === \"(\") {\r\n                start = i + 1;\r\n            } else if (param.selectedColor[i] === \")\") {\r\n                end = i;\r\n                hslaColor.push(param.selectedColor.slice(start, end));\r\n            } else if (param.selectedColor[i] === \",\") {\r\n                hslaColor.push(param.selectedColor.slice(start, i));\r\n                start = i + 1;\r\n            }\r\n        }\r\n        h = hslaColor[0] / 360;\r\n        s = hslaColor[1].slice(0, -1) / 100;\r\n        l = hslaColor[2].slice(0, -1) / 100;\r\n        alpha = Math.round(hslaColor[3] * 255);\r\n        if (s === 0) {\r\n            r = l * 255;\r\n            g = l * 255;\r\n            b = l * 255;\r\n        } else {\r\n            let temp1, temp2, tempR, tempG, tempB;\r\n            if (l < 0.5) {\r\n                temp1 = l * (1 + s);\r\n            } else {\r\n                temp1 = (l + s) - (l * s);\r\n            }\r\n            temp2 = 2 * l - temp1;\r\n            function secondTest(value) {\r\n                if (value < 0) {\r\n                    return value + 1;\r\n                } else if (value > 1) {\r\n                    return value - 1;\r\n                } else {\r\n                    return value;\r\n                }\r\n            }\r\n            tempR = secondTest(h + 1 / 3);\r\n            tempG = secondTest(h);\r\n            tempB = secondTest(h - 1 / 3);\r\n            function finalTest(temp1, temp2, tempColor) {\r\n                if (6 * tempColor < 1) {\r\n                    return temp2 + (temp1 - temp2) * 6 * tempColor;\r\n                } else if (2 * tempColor < 1) {\r\n                    return temp1;\r\n                } else if (3 * tempColor < 2) {\r\n                    return temp2 + (temp1 - temp2) * (2 / 3 - tempColor) * 6;\r\n                } else {\r\n                    return temp2;\r\n                }\r\n            }\r\n            r = Math.round(finalTest(temp1, temp2, tempR) * 255);\r\n            g = Math.round(finalTest(temp1, temp2, tempG) * 255);\r\n            b = Math.round(finalTest(temp1, temp2, tempB) * 255);\r\n        }\r\n        function componentToHex(c) {\r\n            var hex = Number(c).toString(16);\r\n            return hex.length == 1 ? \"0\" + hex : hex;\r\n        }\r\n        let hexColor = \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b) + componentToHex(alpha);\r\n        let spans = [];\r\n        let selectedColor = parseInt(hexColor.slice(7, 9) + hexColor.slice(5, 7) + hexColor.slice(3, 5) + hexColor.slice(1, 3), 16);\r\n        //get copy of canvas and convert to a more performant format\r\n        //canvas data has no negative values and none of the data points require the standard 64 bit\r\n        const imageData = ctx.getImageData(0, 0, width, height);\r\n        const pixelData = {\r\n            width: imageData.width,\r\n            height: imageData.height,\r\n            data: new Uint32Array(imageData.data.buffer),\r\n        };\r\n        //get color from pixel in buffer\r\n        function getPixel(currX, currY) {\r\n            if (currX < 0 || currY < 0 || currX >= pixelData.width || currY >= pixelData.height) {\r\n                return -1;  // out of bounds\r\n            }\r\n            return pixelData.data[currY * imageData.width + currX];\r\n        };\r\n        //break drawBucket if color is the same as target, or if it is out of bounds\r\n        let targetColor = getPixel(Math.floor(x), Math.floor(y));\r\n        if (targetColor === -1 || targetColor === selectedColor) return;\r\n        //add line to check to spans\r\n        const addSpan = (left, right, line, direction) => {\r\n            spans.push({\r\n                left,\r\n                right,\r\n                line,\r\n                direction\r\n            });\r\n        };\r\n        //check span for color and length\r\n        const checkSpan = (left, right, line, direction) => {\r\n            let flag = false;\r\n            let start;\r\n            let column;\r\n            if (line >= height || line < 0) return;\r\n            for (column = left; column < right; ++column) {\r\n                const color = getPixel(column, line);\r\n                if (color === targetColor) {\r\n                    if (!flag) {\r\n                        flag = true;\r\n                        start = column;\r\n                    }\r\n                } else {\r\n                    if (flag) {\r\n                        flag = false;\r\n                        addSpan(start, column - 1, line, direction);\r\n                    }\r\n                }\r\n            }\r\n            if (flag) {\r\n                flag = false;\r\n                addSpan(start, right - 1, line, direction);\r\n            }\r\n        };\r\n        addSpan(Math.floor(x), Math.floor(x), Math.floor(y), 0);\r\n        let depth = 0;\r\n        let MAX_DEPTH = 5000;\r\n        while (spans.length > 0 && depth < MAX_DEPTH) {\r\n            depth++;\r\n            const { left, right, line, direction } = spans.pop();\r\n            let l = left;\r\n            for (l; l >= 0; l--) {\r\n                if (getPixel(l, line) !== targetColor) {\r\n                    break;\r\n                }\r\n            }\r\n            ++l;\r\n            let r = right;\r\n            for (r; r < width; ++r) {\r\n                if (getPixel(r, line) !== targetColor) {\r\n                    break;\r\n                }\r\n            }\r\n            const lineOffset = line * width;\r\n            if (lineOffset + r > pixelData.data.length) {\r\n                console.log(\"Attempt to access pixel data array beyond its maximum length\");\r\n                pixelData.data.fill(selectedColor, lineOffset + l, pixelData.data.length);\r\n            } else {\r\n                pixelData.data.fill(selectedColor, lineOffset + l, lineOffset + r);\r\n            }\r\n            if (direction <= 0) {\r\n                checkSpan(l, r, line - 1, -1);\r\n            } else {\r\n                checkSpan(l, left, line - 1, -1);\r\n                checkSpan(right, r, line - 1, -1);\r\n            }\r\n            if (direction >= 0) {\r\n                checkSpan(l, r, line + 1, +1);\r\n            } else {\r\n                checkSpan(l, left, line + 1, +1);\r\n                checkSpan(right, r, line + 1, +1);\r\n            }\r\n        }\r\n        if (depth >= MAX_DEPTH) console.error(\"Bucket Tool maximum iterations exceeded, consider using a smaller canvas.\");\r\n        ctx.putImageData(imageData, 0, 0);\r\n    };\r\n\r\n    const drawText = () => {\r\n        ctx.fillStyle = param.selectedColor\r\n        ctx.strokeStyle = param.selectedColor === param.color1 ? param.color2 : param.color1\r\n        ctx.lineWidth = param.text.strokeWidth\r\n        ctx.font = String(param.size + \"px \" + param.text.fontFamily)\r\n        let linesArr = param.text.text.split(\"\\n\")\r\n        let lineIndex = 0\r\n        let maxWidth = endX > startX ? endX - startX : startX - endX\r\n        let left = endX > startX ? startX : endX\r\n        let top = endY > startY ? startY : endY\r\n        let whileBreak = 0\r\n        const MAX_DEPTH = 500\r\n        while (lineIndex < linesArr.length && whileBreak < MAX_DEPTH) {\r\n            if (ctx.measureText(linesArr[lineIndex]).width > maxWidth) {\r\n                let firstText = linesArr[lineIndex][0]\r\n                let firstTextIndex = 1\r\n                let whileBreak2 = 0\r\n                while (ctx.measureText(firstText).width < maxWidth && whileBreak2 < MAX_DEPTH) {\r\n                    firstText += linesArr[lineIndex][firstTextIndex]\r\n                    firstTextIndex++\r\n                    whileBreak2++\r\n                }\r\n                let lastText = linesArr[lineIndex].substring(firstTextIndex - 1, linesArr[lineIndex].length)\r\n                linesArr[lineIndex] = firstText.substring(0, firstTextIndex - 1)\r\n                linesArr = linesArr.toSpliced(lineIndex + 1, 0, lastText)\r\n            }\r\n            lineIndex++\r\n            whileBreak++\r\n        };\r\n        linesArr.forEach((value, index) => {\r\n            if (param.text.fill) {\r\n                ctx.fillText(\r\n                    value,\r\n                    left,\r\n                    top + param.size + (param.size * param.text.lineHeight * index)\r\n                );\r\n            }\r\n            if (param.text.stroke) {\r\n                ctx.strokeText(\r\n                    value,\r\n                    left,\r\n                    top + param.size + (param.size * param.text.lineHeight * index)\r\n                );\r\n            }\r\n        })\r\n\r\n    };\r\n\r\n    const drawSelect = () => {\r\n        switch (param.clipboard.state) {\r\n            case \"copy\":\r\n                if (!preview && endX - startX !== 0 && endY - startY !== 0) {\r\n                    let data = ctx.getImageData(\r\n                        startX,\r\n                        startY,\r\n                        endX - startX,\r\n                        endY - startY\r\n                    );\r\n                    param.setClipboard({\r\n                        data: data,\r\n                        state: \"carry\"\r\n                    });\r\n                }\r\n                break;\r\n            case \"cut\":\r\n                if (!preview && endX - startX !== 0 && endY - startY !== 0) {\r\n                    let data = ctx.getImageData(\r\n                        startX,\r\n                        startY,\r\n                        endX - startX,\r\n                        endY - startY\r\n                    );\r\n                    param.setClipboard({\r\n                        data: data,\r\n                        state: \"carry\"\r\n                    });\r\n                    if (param.selectedColor === param.color1) {\r\n                        ctx.fillStyle = param.color2;\r\n                    } else {\r\n                        ctx.fillStyle = param.color1;\r\n                    }\r\n                    ctx.fillRect(\r\n                        startX,\r\n                        startY,\r\n                        endX - startX,\r\n                        endY - startY\r\n                    );\r\n                }\r\n                break;\r\n            case \"carry\":\r\n                const carryCanvas = document.getElementById(\"carryCanvas\");\r\n                const carryCtx = carryCanvas.getContext(\"2d\");\r\n                carryCtx.height = param.clipboard.data.height;\r\n                carryCtx.width = param.clipboard.data.width;\r\n                carryCtx.putImageData(param.clipboard.data, 0, 0);\r\n                ctx.putImageData(param.clipboard.data, endX, endY);\r\n                break;\r\n            case \"paste\":\r\n                if (!preview) {\r\n                    const carryCanvas = document.getElementById(\"carryCanvas\");\r\n                    ctx.drawImage(carryCanvas, endX, endY);\r\n                    param.setClipboard({\r\n                        ...param.clipboard,\r\n                        state: \"none\"\r\n                    });\r\n                }\r\n                break;\r\n            case \"none\":\r\n            default:\r\n                break;\r\n        }\r\n    };\r\n\r\n    const drawShape = () => {\r\n        ctx.strokeStyle = param.color1;\r\n        ctx.fillStyle = param.color2;\r\n        if (param.subTool.shape !== \"Curve\" && param.subTool.shape !== \"Line\") {\r\n            ctx.lineCap = param.subTool.lineCap;\r\n        } else {\r\n            ctx.lineCap = \"round\";\r\n        }\r\n        ctx.lineJoin = param.subTool.lineJoin;\r\n        ctx.setLineDash([]);\r\n        ctx.lineWidth = param.size;\r\n        let centerX = (endX - startX) / 2;\r\n        let centerY = (endY - startY) / 2;\r\n        let radius;\r\n        if (Math.sqrt(Math.pow(endX - startX, 2)) / 2 < Math.sqrt(Math.pow(endY - startY, 2)) / 2) {\r\n            radius = Math.sqrt(Math.pow(endX - startX, 2)) / 2;\r\n        } else {\r\n            radius = Math.sqrt(Math.pow(endY - startY, 2)) / 2;\r\n        }\r\n        let stretchX = Math.sqrt(Math.pow((endX - startX) / (endY - startY), 2));\r\n        let stretchY = Math.sqrt(Math.pow((endY - startY) / (endX - startX), 2));\r\n        if (param.subTool.stretch) {\r\n            if (stretchX > stretchY) {\r\n                stretchY = 1;\r\n            } else {\r\n                stretchX = 1;\r\n            }\r\n        } else {\r\n            stretchX = 1;\r\n            stretchY = 1;\r\n        }\r\n        if (param.subTool.shape !== \"Curve\" && param.subTool.shape !== \"Line\") {\r\n            ctx.save();\r\n            ctx.translate(startX + centerX, startY + centerY);\r\n            ctx.rotate((Math.PI * param.subTool.angle) / 180);\r\n        }\r\n        if (param.subTool.shape === \"Rectangle\" || param.subTool.shape === \"Squagle\") {\r\n            drawFunctions[\"draw\" + param.subTool.shape](centerX, centerY);\r\n        } else {\r\n            drawFunctions[\"draw\" + param.subTool.shape](stretchX, stretchY, radius);\r\n        }\r\n        if (param.subTool.shape !== \"Line\" &&\r\n            param.subTool.shape !== \"Curve\") {\r\n            ctx.restore();\r\n        }\r\n    }\r\n\r\n    const drawLine = () => {\r\n        ctx.beginPath();\r\n        ctx.moveTo(\r\n            startX,\r\n            startY,\r\n        )\r\n        ctx.lineTo(\r\n            endX,\r\n            endY,\r\n        )\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawCurve = () => {\r\n        let startPoint = { x: 0, y: 0 };\r\n        let endPoint = { x: 0, y: 0 };\r\n        let controlPoint1 = { x: 0, y: 0 };\r\n        let controlPoint2 = { x: 0, y: 0 };\r\n        ctx.beginPath();\r\n        if (param.curveControls.start.x === -1) {\r\n            startPoint = { x: startX, y: startY };\r\n            endPoint = { x: endX, y: endY };\r\n            controlPoint1 = { x: startX, y: startY };\r\n            controlPoint2 = { x: endX, y: endY };\r\n        } else if (param.curveControls.controlPoint1.x === -1) {\r\n            startPoint = param.curveControls.start;\r\n            endPoint = param.curveControls.end;\r\n            controlPoint1 = { x: endX, y: endY };\r\n            controlPoint2 = param.curveControls.end;\r\n        } else if (param.curveControls.controlPoint2.x === -1) {\r\n            startPoint = param.curveControls.start;\r\n            endPoint = param.curveControls.end;\r\n            controlPoint1 = param.curveControls.controlPoint1;\r\n            controlPoint2 = { x: endX, y: endY };\r\n        } else {\r\n            startPoint = param.curveControls.start;\r\n            endPoint = param.curveControls.end;\r\n            controlPoint1 = param.curveControls.controlPoint1;\r\n            controlPoint2 = param.curveControls.controlPoint2;\r\n        }\r\n        ctx.moveTo(\r\n            startPoint.x,\r\n            startPoint.y,\r\n        )\r\n        ctx.bezierCurveTo(\r\n            controlPoint1.x,\r\n            controlPoint1.y,\r\n            controlPoint2.x,\r\n            controlPoint2.y,\r\n            endPoint.x,\r\n            endPoint.y,\r\n        )\r\n        ctx.stroke();\r\n    }\r\n    const drawRectangle = (centerX, centerY) => {\r\n        if (param.subTool.fill) {\r\n            ctx.fillRect(\r\n                -centerX,\r\n                -centerY,\r\n                endX - startX,\r\n                endY - startY,\r\n            );\r\n        }\r\n        ctx.strokeRect(\r\n            -centerX,\r\n            -centerY,\r\n            endX - startX,\r\n            endY - startY,\r\n        );\r\n    }\r\n\r\n    const drawSquagle = (centerX, centerY) => {\r\n        ctx.beginPath();\r\n        ctx.roundRect(\r\n            -centerX,\r\n            -centerY,\r\n            endX - startX,\r\n            endY - startY,\r\n            param.subTool.radii\r\n        );\r\n        ctx.stroke();\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n    }\r\n\r\n    const drawCircle = (stretchX, stretchY, radius) => {\r\n        ctx.beginPath();\r\n        ctx.ellipse(\r\n            0,\r\n            0,\r\n            stretchX * radius,\r\n            stretchY * radius,\r\n            0,\r\n            0,\r\n            2 * Math.PI\r\n        );\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawPolygon = (stretchX, stretchY, radius) => {\r\n        ctx.beginPath();\r\n        for (let i = 0; i < param.subTool.sides + 2; i++) {\r\n            ctx.lineTo(\r\n                stretchX * radius * Math.cos((2 * Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle)),\r\n                stretchY * radius * Math.sin((2 * Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle))\r\n            );\r\n        };\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawStar = (stretchX, stretchY, radius) => {\r\n        ctx.beginPath();\r\n        for (let i = 0; i < param.subTool.sides * 2 + 2; i++) {\r\n            if (i % 2 === 0) {\r\n                ctx.lineTo(\r\n                    stretchX * radius * Math.cos((Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle)),\r\n                    stretchY * radius * Math.sin((Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle))\r\n                );\r\n            } else {\r\n                ctx.lineTo(\r\n                    stretchX * radius / 3 * Math.cos((Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle)),\r\n                    stretchY * radius / 3 * Math.sin((Math.PI * i / param.subTool.sides) - Math.PI / 2 + (Math.PI / 180 * param.subTool.startAngle))\r\n                );\r\n            }\r\n        };\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawArrow = (stretchX, stretchY, radius) => {\r\n        ctx.beginPath();\r\n        ctx.moveTo(stretchX * -radius * Math.cos(Math.PI / 8), stretchY * -radius * Math.sin(Math.PI / 8));\r\n        ctx.lineTo(0, stretchY * -radius * Math.sin(Math.PI / 8));\r\n        ctx.lineTo(0, stretchY * -radius);\r\n        ctx.lineTo(stretchX * radius, 0);\r\n        ctx.lineTo(0, stretchY * radius);\r\n        ctx.lineTo(0, stretchY * radius * Math.sin(Math.PI / 8));\r\n        ctx.lineTo(stretchX * -radius * Math.cos(Math.PI / 8), stretchY * radius * Math.sin(Math.PI / 8));\r\n        ctx.closePath();\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawHeart = (stretchX, stretchY, radius) => {\r\n        if (param.subTool.stretch) {\r\n            if (stretchX > stretchY) {\r\n                ctx.scale(stretchX, 1);\r\n            } else {\r\n                ctx.scale(1, stretchY);\r\n            }\r\n        }\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, radius);\r\n        ctx.arc(-radius / 2, -radius / 5, radius / 2, 3 * Math.PI / 4, 0, false);\r\n        ctx.arc(radius / 2, -radius / 5, radius / 2, Math.PI, Math.PI / 4, false);\r\n        ctx.closePath();\r\n        if (param.subTool.fill) {\r\n            ctx.fill();\r\n        }\r\n        ctx.stroke();\r\n    }\r\n\r\n    const drawFunctions = {\r\n        drawBrush,\r\n        drawEraser,\r\n        drawSpray,\r\n        drawBucket,\r\n        drawText,\r\n        drawPipette,\r\n        drawSelect,\r\n        drawShape,\r\n        drawLine,\r\n        drawCurve,\r\n        drawCircle,\r\n        drawRectangle,\r\n        drawSquagle,\r\n        drawPolygon,\r\n        drawStar,\r\n        drawArrow,\r\n        drawHeart,\r\n    };\r\n    if (preview) {\r\n        ctx.clearRect(0, 0, width, height);\r\n        if (param.tool !== \"Magnifier\") {\r\n            if (param.tool === \"Bucket\" || param.tool === \"Pipette\") {\r\n                return;\r\n            } else if (param.tool === \"Spray\") {\r\n                drawEraser();\r\n            }\r\n            else {\r\n                drawFunctions[\"draw\" + param.tool]();\r\n            }\r\n        }\r\n    } else if (param.tool !== \"Magnifier\") {\r\n        drawFunctions[\"draw\" + param.tool]();\r\n    }\r\n}","import { handleDraw } from \"./handleDraw.js\";\r\nexport const handleTools = (canvas, cursor, setCursor, params, action, setAction) => {\r\n  switch (params.tool) {\r\n    case \"Brush\":\r\n    case \"Eraser\":\r\n      handleDraw(canvas, cursor, params, false, action);\r\n      if (action !== \"drawing\") {\r\n        params.setBrushPoints([[cursor.current.x, cursor.current.y]]);\r\n        setAction(\"drawing\");\r\n      }else{\r\n        params.setBrushPoints([...params.brushPoints, [cursor.current.x, cursor.current.y]]);\r\n      }\r\n      break;\r\n    case \"Bucket\":\r\n      handleDraw(canvas, cursor, params, false);\r\n      setAction(\"finished\");\r\n      break;\r\n    case \"Spray\":\r\n      for (let i = 0; i < 10; i++) {\r\n        handleDraw(canvas, cursor, params, false);\r\n      }\r\n      setAction(\"spraying\");\r\n      break;\r\n    case \"Text\":\r\n      if (\r\n        cursor.current.x !== 0 &&\r\n        cursor.current.y !== 0\r\n      ) {\r\n        params.setText({\r\n          ...params.text, \r\n          state: \"preview\"\r\n        });\r\n      }\r\n      if (action === \"confirm\") {\r\n        handleDraw(canvas, cursor, params, false);\r\n        params.setText({ ...params.text, text: \"\", state: \"none\" });\r\n        setAction(\"finished\");\r\n      }\r\n      break;\r\n    case \"Pipette\":\r\n      handleDraw(canvas, cursor, params, false);\r\n      break;\r\n    case \"Magnifier\":\r\n      break;\r\n    case \"Select\":\r\n      if (action === \"clipping\" && params.clipboard.state !== \"carry\") {\r\n        handleDraw(canvas, cursor, params, false);\r\n      } else if (action === \"confirm\") {\r\n        handleDraw(canvas, cursor, params, false);\r\n        setAction(\"finished\");\r\n      }\r\n      break;\r\n    case \"Shape\":\r\n      if (params.subTool.shape === \"Curve\" && cursor.down) {\r\n        let newState = params.curveControls.state;\r\n        let newStart = params.curveControls.start;\r\n        let newEnd = params.curveControls.end;\r\n        let newControlPoint1 = params.curveControls.controlPoint1;\r\n        let newControlPoint2 = params.curveControls.controlPoint2;\r\n        if (params.curveControls.state===\"none\") {\r\n          setAction(\"settingPoints\");\r\n          newState = \"start\";\r\n          newStart = { x: cursor.start.x, y: cursor.start.y };\r\n          newEnd = { x: cursor.end.x, y: cursor.end.y };\r\n        }\r\n        else if(params.curveControls.state===\"start\") {\r\n            if(action===\"settingPoints\"){\r\n              newEnd = { x: cursor.end.x, y: cursor.end.y };\r\n            }else{\r\n              setAction(\"settingPoints\");\r\n              newState = \"point1\";\r\n              newControlPoint1 = { x: cursor.end.x, y: cursor.end.y };\r\n            }\r\n        } else if (params.curveControls.state === \"point1\") {\r\n          if(action===\"settingPoints\"){\r\n            newControlPoint1 = { x: cursor.end.x, y: cursor.end.y };\r\n          }else{\r\n            setAction(\"settingPoints\");\r\n            newState = \"point2\";\r\n            newControlPoint2 = { x: cursor.end.x, y: cursor.end.y };\r\n          }\r\n        } else if (params.curveControls.state === \"point2\") {\r\n          newControlPoint2 = { x: cursor.end.x, y: cursor.end.y };\r\n        }\r\n        params.setCurveControls({\r\n          ...params.curveControls,\r\n          state: newState,\r\n          start: newStart,\r\n          end: newEnd,\r\n          controlPoint1: newControlPoint1,\r\n          controlPoint2: newControlPoint2\r\n        });\r\n      } else if(params.subTool.shape === \"Curve\" && action===\"cancel\") {\r\n        params.setCurveControls({\r\n          state: \"none\",\r\n          start: { x: -1, y: -1 },\r\n          end: { x: -1, y: -1 },\r\n          controlPoint1: { x: -1, y: -1 },\r\n          controlPoint2: { x: -1, y: -1 }\r\n        })\r\n      }\r\n      \r\n\r\n      if (action === \"confirm\") {\r\n        handleDraw(canvas, cursor, params, false);\r\n        if (params.subTool.shape === \"Curve\") {\r\n          params.setCurveControls({\r\n            state: \"none\",\r\n            start: { x: -1, y: -1 },\r\n            end: { x: -1, y: -1 },\r\n            controlPoint1: { x: -1, y: -1 },\r\n            controlPoint2: { x: -1, y: -1 }\r\n          })\r\n        }\r\n        setAction(\"finished\");\r\n        setCursor({\r\n          ...cursor,\r\n          start: { x: 0, y: 0 },\r\n          end: { x: 0, y: 0 },\r\n        })\r\n      }\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n};","export const handleTopMenu = (appMenu, setAppMenu, args, flag) => {\r\n    //Default App Menu  \r\n    const defaultAppMenu = {\r\n        \"File\": {\r\n            \"New\": {\r\n                \"action\": \"New\",\r\n                \"keybind\": \"Alt+N\",\r\n                \"disabled\": false\r\n            },\r\n            \"Open\": {\r\n                \"action\": \"Open\",\r\n                \"keybind\": \"Alt+O\",\r\n                \"disabled\": false\r\n            },\r\n            \"Download\": {\r\n                \"action\": \"Save\",\r\n                \"keybind\": \"Ctrl+Alt+S\",\r\n                \"disabled\": false\r\n            },\r\n            \"Download As\": {\r\n                \"action\": \"Save As\",\r\n                \"keybind\": \"Ctrl+Alt+Shift+S\",\r\n                \"disabled\": false\r\n            },\r\n            \"Change Name\": {\r\n                \"action\": \"Change Name\",\r\n                \"keybind\": \"F2\",\r\n                \"disabled\": false\r\n            },\r\n            \"LineBreak1\": {},\r\n            \"Close\": {\r\n                \"action\": \"Close\",\r\n                \"keybind\": \"Alt+Shift+F4\",\r\n                \"disabled\": false\r\n            }\r\n        },\r\n        \"Edit\": {\r\n            \"Undo\": {\r\n                \"action\": \"Undo\",\r\n                \"keybind\": \"Ctrl+Z\",\r\n                \"disabled\": false\r\n            },\r\n            \"Redo\": {\r\n                \"action\": \"Redo\",\r\n                \"keybind\": \"Ctrl+Y\",\r\n                \"disabled\": false\r\n            }/*,\r\n            \"LineBreak1\":{},\r\n            \"Cut\": {\r\n                \"action\": \"Cut\",\r\n                \"keybind\": \"Ctrl+X\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            },\r\n            \"Copy\": {\r\n                \"action\": \"Copy\",\r\n                \"keybind\": \"Ctrl+C\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            },\r\n            \"Paste\": {\r\n                \"action\": \"Paste\",\r\n                \"keybind\": \"Ctrl+V\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            },\r\n            \"LineBreak2\":{},\r\n            \"Select All\": {\r\n                \"action\": \"SelectAll\",\r\n                \"keybind\": \"Ctrl+A\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            },\r\n            \"Clear\": {\r\n                \"action\": \"SelectClear\",\r\n                \"keybind\": \"Ctrl+Shift+C\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            }*/\r\n        },\r\n        \"View\": {\r\n            \"Zoom In\": {\r\n                \"action\": \"Zoom In\",\r\n                \"keybind\": \"Alt++\",\r\n                \"disabled\": false\r\n            },\r\n            \"Zoom Out\": {\r\n                \"action\": \"Zoom Out\",\r\n                \"keybind\": \"Alt+-\",\r\n                \"disabled\": false\r\n            },\r\n            \"Zoom Reset\": {\r\n                \"action\": \"Zoom Reset\",\r\n                \"keybind\": \"Alt+0\",\r\n                \"disabled\": true\r\n            },\r\n            \"LineBreak1\": {},\r\n            \"Tool Bar\": {\r\n                \"action\": \"toolBar\",\r\n                \"checkbox\": true,\r\n                \"disabled\": false\r\n            },\r\n            \"Content Bar\": {\r\n                \"action\": \"contentBar\",\r\n                \"checkbox\": true,\r\n                \"disabled\": false\r\n            },\r\n            \"Bottom Bar\": {\r\n                \"action\": \"bottomNavBar\",\r\n                \"checkbox\": true,\r\n                \"disabled\": false\r\n            },\r\n            \"Top Bar\": {\r\n                \"action\": \"topNavBar\",\r\n                \"checkbox\": true,\r\n                \"disabled\": false\r\n            }\r\n        }/*,\r\n        \"Help\": {\r\n            \"Help\": {\r\n                \"action\": \"help\",\r\n                \"keybind\": \"F1\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            },\r\n            \"About\": {\r\n                \"action\": \"about\",\r\n                \"disabled\": true,\r\n                \"title\": \"Not Implemented\"\r\n            }\r\n        }*/\r\n    }\r\n    if (appMenu === null) {\r\n        setAppMenu(defaultAppMenu);\r\n    }\r\n    else {\r\n        let updatedAppMenu = { ...appMenu };\r\n        switch (flag) {\r\n            case \"history\":\r\n                updatedAppMenu = {\r\n                    ...updatedAppMenu,\r\n                    \"Edit\": {\r\n                        ...updatedAppMenu[\"Edit\"],\r\n                        \"Undo\": {\r\n                            ...updatedAppMenu[\"Edit\"][\"Undo\"],\r\n                            \"disabled\": !args.history.canUndo\r\n                        },\r\n                        \"Redo\": {\r\n                            ...updatedAppMenu[\"Edit\"][\"Redo\"],\r\n                            \"disabled\": !args.history.canRedo\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            case \"view\":\r\n                updatedAppMenu = {\r\n                    ...updatedAppMenu,\r\n                    \"View\": {\r\n                        ...updatedAppMenu[\"View\"],\r\n                        \"Tool Bar\": {\r\n                            ...updatedAppMenu[\"View\"][\"Tool Bar\"],\r\n                            \"checkbox\": args.view.toolBar\r\n                        },\r\n                        \"Content Bar\": {\r\n                            ...updatedAppMenu[\"View\"][\"Content Bar\"],\r\n                            \"checkbox\": args.view.contentBar\r\n                        },\r\n                        \"Bottom Bar\": {\r\n                            ...updatedAppMenu[\"View\"][\"Bottom Bar\"],\r\n                            \"checkbox\": args.view.bottomNavBar\r\n                        },\r\n                        \"Top Bar\": {\r\n                            ...updatedAppMenu[\"View\"][\"Top Bar\"],\r\n                            \"checkbox\": args.view.topNavBar\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            case \"zoom\":\r\n                updatedAppMenu = {\r\n                    ...updatedAppMenu,\r\n                    \"View\": {\r\n                        ...updatedAppMenu[\"View\"],\r\n                        \"Zoom In\": {\r\n                            ...updatedAppMenu[\"View\"][\"Zoom In\"],\r\n                            \"disabled\": args.zoom === 4\r\n                        },\r\n                        \"Zoom Out\": {\r\n                            ...updatedAppMenu[\"View\"][\"Zoom Out\"],\r\n                            \"disabled\": args.zoom === 0.25\r\n                        },\r\n                        \"Zoom Reset\": {\r\n                            ...updatedAppMenu[\"View\"][\"Zoom Reset\"],\r\n                            \"disabled\": args.zoom === 1\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        setAppMenu(updatedAppMenu);\r\n    }\r\n}","import { handleTopMenu } from \"./handleTopMenu.js\";\r\n\r\nexport const handleHistory = (context, history, setHistory, command, appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers) => {\r\n    let updatedHistory = {};\r\n    let args = {};\r\n    const height = context.canvas.height;\r\n    const width = context.canvas.width;\r\n    const MAX_HISTORY_LENGTH = 50;\r\n\r\n    /*\r\n    history structure\r\n    {\r\n            layer[0].id:{\r\n                data: [imageData1, imageData2, ...], -> indicates the history of the layer\r\n                lastIndex: 0 -> indicates the last step of the layer\r\n            },\r\n            layer[1].id:{\r\n                data: [imageData1, imageData2, ...], -> indicates the history of the layer\r\n                lastIndex: 0 -> indicates the last step of the layer\r\n            },\r\n            ...\r\n    }\r\n    */\r\n\r\n    const updateStates = (updatedHistory, updatedLayers, canClose) => {\r\n        setHistory(updatedHistory)\r\n        setLayers(updatedLayers)\r\n        setCanClose(canClose);\r\n        handleTopMenu(appMenu, setAppMenu, args = { history: { ...updatedLayers[currLayer] } }, \"history\");\r\n    }\r\n\r\n\r\n    const undoAction = () => {\r\n        const id = layers[currLayer].id\r\n        updatedHistory = history\r\n        const targetCanvas = document.getElementById(`drawCanvasLayer${id}`).getContext(\"2d\")\r\n        targetCanvas.putImageData(history[id].data[history[id].lastIndex - 1], 0, 0)\r\n        const canUndoLayer = history[id].lastIndex - 1 > 0\r\n        updatedHistory[id].lastIndex--\r\n        let updatedLayers = layers\r\n        updatedLayers[currLayer] = {\r\n            ...updatedLayers[currLayer],\r\n            canUndo: canUndoLayer,\r\n            canRedo: true\r\n        }\r\n        updateStates(updatedHistory, updatedLayers, false)\r\n    }\r\n\r\n    const redoAction = () => {\r\n        let id = layers[currLayer].id\r\n        updatedHistory = history\r\n        const targetCanvas = document.getElementById(`drawCanvasLayer${id}`).getContext(\"2d\")\r\n        targetCanvas.putImageData(history[id].data[history[id].lastIndex + 1], 0, 0)\r\n        const canRedoLayer = history[id].lastIndex + 1 < history[id].data.length - 1\r\n        updatedHistory[id].lastIndex++\r\n        let updatedLayers = layers\r\n        updatedLayers[currLayer] = {\r\n            ...updatedLayers[currLayer],\r\n            canUndo: true,\r\n            canRedo: canRedoLayer\r\n        }\r\n        updateStates(updatedHistory, updatedLayers, false)\r\n    }\r\n\r\n    const saveAction = () => {\r\n        let id = layers[currLayer].id\r\n        let isNewLayer = false\r\n        updatedHistory = history\r\n        let targetCanvas = document.getElementById(`drawCanvasLayer${id}`).getContext(\"2d\")\r\n        //Checks if the layer does not have a history\r\n        if (!updatedHistory[id]) {\r\n            isNewLayer = true\r\n            updatedHistory[id] = {\r\n                data: [targetCanvas.getImageData(0, 0, width, height)],\r\n                lastIndex: 0\r\n            }\r\n        } else {\r\n            //Checks if the save action is at the end of the history\r\n            if (updatedHistory[id].lastIndex === updatedHistory[id].data.length - 1) {\r\n                updatedHistory[id] = {\r\n                    data: [...updatedHistory[id].data, targetCanvas.getImageData(0, 0, width, height)],\r\n                    lastIndex: updatedHistory[id].data.length\r\n                }\r\n            }\r\n            //if not, remove all history after the current step\r\n            else {\r\n                updatedHistory[id].data.splice(updatedHistory[id].lastIndex + 1, 0, targetCanvas.getImageData(0, 0, width, height))\r\n                updatedHistory[id].lastIndex++\r\n            }\r\n        }\r\n        let updatedLayers = layers\r\n        updatedLayers[currLayer] = {\r\n            ...updatedLayers[currLayer],\r\n            canUndo: !isNewLayer,\r\n            canRedo: false\r\n        }\r\n        //if the history is too long, remove the oldest step and associated data\r\n        if (updatedHistory[id].data.length > MAX_HISTORY_LENGTH) {\r\n            updatedHistory[id].data.shift()\r\n            updatedHistory[id].lastIndex--\r\n        }\r\n        updateStates(updatedHistory, updatedLayers, false)\r\n    }\r\n\r\n    const clearAction = () => {\r\n        updatedHistory = {\r\n            0: {\r\n                data: [context.getImageData(0, 0, width, height)],\r\n                lastIndex: 0\r\n            }\r\n        }\r\n        const updatedLayers = [{\r\n            id: 0,\r\n            name: \"Base\",\r\n            blending: \"normal\",\r\n            filters: {},\r\n            opacity: 1,\r\n            visible: true,\r\n            locked: false,\r\n            canUndo: false,\r\n            canRedo: false\r\n        }]\r\n        updateStates(updatedHistory, updatedLayers, true)\r\n    }\r\n\r\n    const duplicateLayer = () => {\r\n        let id = layers[currLayer].id\r\n        const target = document.getElementById(`drawCanvasLayer${id}`).getContext(\"2d\")\r\n        const image = history[id].data[history[id].lastIndex]\r\n        target.putImageData(image, 0, 0)\r\n    }\r\n\r\n    switch (command) {\r\n        case \"undo\":\r\n            undoAction();\r\n            break;\r\n        case \"redo\":\r\n            redoAction();\r\n            break;\r\n        case \"delete layer\":\r\n            //deleteLayer(currLayer);\r\n            break;\r\n        case \"duplicate layer\":\r\n            duplicateLayer();\r\n            break;\r\n        case \"save\":\r\n            saveAction();\r\n            break;\r\n        case \"clear\":\r\n            clearAction();\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n\r\n}","export const handleFile = (ctx, context, action, layers, setAction) => {\r\n\r\n    const height = ctx.canvas.height;\r\n    const width = ctx.canvas.width;\r\n\r\n    //Detects if the upload action has been removed, and if so, \r\n    // removes the input so to prevent upload dialog from reactivating\r\n    function checkCancelledUpload(input) {\r\n        document.body.onfocus = () => {\r\n            if (input.value.length > 0) {\r\n                document.body.onfocus = null;\r\n            } else {\r\n                input.remove();\r\n                setAction(false);\r\n                document.body.onfocus = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    const saveFile = () => {\r\n        let finalCanvas = document.createElement(\"canvas\");\r\n        let finalCtx = finalCanvas.getContext(\"2d\");\r\n        finalCanvas.width = width;\r\n        finalCanvas.height = height;\r\n        function constructFilters(filters) {\r\n            if (!filters) return \"\"\r\n            let filtersString = \"\";\r\n            Object.keys(filters).forEach((key) => {\r\n                if (key === \"hue-rotate\") {\r\n                    filtersString += `${key}(${filters[key]}deg) `\r\n                } else if (key === \"blur\") {\r\n                    filtersString += `${key}(${filters[key]}px) `\r\n                } else if (key === \"drop-shadow\") {\r\n                    filtersString += `${key}(${filters[key][0]}px ${filters[key][1]}px ${filters[key][2]}px ${filters[key][3]}) `\r\n                } else {\r\n                    filtersString += `${key}(${filters[key]}%) `\r\n                };\r\n            })\r\n            return filtersString\r\n        }\r\n        layers.forEach((layer) => {\r\n            if (layer.visible) {\r\n                finalCtx.globalCompositeOperation = layer.blending;\r\n                finalCtx.globalAlpha = layer.opacity;\r\n                if (layer.filters) {\r\n                    finalCtx.filter = constructFilters(layer.filters)\r\n                }\r\n                finalCtx.drawImage(\r\n                    document.getElementById(`drawCanvasLayer${layer.id}`),\r\n                    0,\r\n                    0\r\n                );\r\n            }\r\n        })\r\n        let downloadLink = document.createElement(\"a\");\r\n        downloadLink.setAttribute(\"download\", context.name + \".png\");\r\n        let dataURL = finalCanvas.getContext(\"2d\").canvas.toDataURL(\"image/png\");\r\n        let url = dataURL.replace(\r\n            /^data:image\\/png/,\r\n            \"data:application/octet-stream\",\r\n        );\r\n        downloadLink.setAttribute(\"href\", url);\r\n        downloadLink.click();\r\n    };\r\n    const newFile = () => {\r\n        const baseCanvas = document.getElementById(`drawCanvasLayer0`).getContext(\"2d\");\r\n        if (context.useAlpha) {\r\n            baseCanvas.fillStyle = \"#00000000\";\r\n        } else {\r\n            baseCanvas.fillStyle = \"#FFFFFFFF\";\r\n        }\r\n        baseCanvas.fillRect(0, 0, width, height);\r\n    };\r\n\r\n    const openFile = () => {\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"file\";\r\n        input.accept = \"image/*\";\r\n        input.onchange = (e) => {\r\n            const file = e.target.files[0];\r\n            const reader = new FileReader();\r\n            reader.onload = () => {\r\n                const image = new Image();\r\n                image.src = reader.result;\r\n                image.onload = () => {\r\n                    const baseCanvas = document.getElementById(`drawCanvasLayer0`);\r\n                    baseCanvas.width = image.width;\r\n                    baseCanvas.height = image.height;\r\n                    context.setDimentions({ width: image.width, height: image.height });\r\n                    context.setName(file.name);\r\n                    const baseCtx = baseCanvas.getContext(\"2d\");\r\n                    baseCtx.drawImage(image, 0, 0);\r\n                    setAction(\"Open Confirm\");\r\n                    input.remove();\r\n                };\r\n            };\r\n            reader.readAsDataURL(file);\r\n        };\r\n        input.click();\r\n        checkCancelledUpload(input);\r\n    }\r\n\r\n    const uploadImage = () => {\r\n        const input = document.createElement(\"input\");\r\n        input.type = \"file\";\r\n        input.accept = \"image/*\";\r\n        input.onchange = (e) => {\r\n            const file = e.target.files[0];\r\n            const reader = new FileReader();\r\n            reader.onload = () => {\r\n                const image = new Image();\r\n                image.src = reader.result;\r\n                image.onload = () => {\r\n                    const tempCanvas = document.createElement(\"canvas\");\r\n                    tempCanvas.width = image.width;\r\n                    tempCanvas.height = image.height;\r\n                    const tempCtx = tempCanvas.getContext(\"2d\");\r\n                    tempCtx.drawImage(image, 0, 0);\r\n                    const data = tempCtx.getImageData(0, 0, image.width, image.height);\r\n                    context.setClipboard({ data: data, state: \"carry\" });\r\n                    context.setTool(\"Select\");\r\n                    setAction(\"clipping\");\r\n                    input.remove();\r\n                };\r\n            };\r\n            reader.readAsDataURL(file);\r\n        };\r\n        input.click();\r\n        checkCancelledUpload(input);\r\n    }\r\n\r\n    switch (action) {\r\n        case \"new\":\r\n            newFile();\r\n            break;\r\n        case \"save\":\r\n            saveFile(ctx);\r\n            break;\r\n        case \"open\":\r\n            openFile(ctx);\r\n            break;\r\n        case \"image\":\r\n            uploadImage(ctx);\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}","import { handleTools } from \"./handleTools.js\";\r\nimport { handleHistory } from \"./handleHistory.js\";\r\nimport { handleFile } from \"./handleFile.js\";\r\nimport { handleTopMenu } from \"./handleTopMenu.js\";\r\n\r\nimport { dialogNew } from \"../Dialog/new.jsx\";\r\nimport { dialogChangeName } from \"../Dialog/changeName.jsx\";\r\nimport { dialogSaveAs } from \"../Dialog/saveAs.jsx\";\r\nimport { dialogCloseApp } from \"../Dialog/closeApp.jsx\";\r\n//TODO: update history when new layer is created\r\nexport const handleAction = (props) => {\r\n  let args = {};\r\n  const {\r\n    canvas,\r\n    ctx,\r\n    context,\r\n    params,\r\n    action,\r\n    setAction,\r\n    appMenu,\r\n    setAppMenu,\r\n    appDialog,\r\n    setAppDialog,\r\n    contextMenu,\r\n    canClose,\r\n    setCanClose,\r\n    isSelected,\r\n    title,\r\n    setTitle,\r\n    currLayer,\r\n    setCurrLayer,\r\n    layers,\r\n    setLayers\r\n  } = props;\r\n\r\n  switch (action) {\r\n    case \"Startup\":\r\n      handleFile(ctx, context, \"new\", layers);\r\n      handleHistory(ctx, context.history, context.setHistory, \"clear\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      setAction(false);\r\n      break;\r\n    case \"New\":\r\n      dialogNew(context, setAction, setAppDialog);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"New Confirm\":\r\n      setAppDialog(null);\r\n      handleFile(ctx, context, \"new\", layers, setAction);\r\n      setCurrLayer(0);\r\n      handleHistory(ctx, context.history, context.setHistory, \"clear\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      context.setClipboard({\r\n        data: {},\r\n        state: \"none\",\r\n      })\r\n      setAction(false);\r\n      break;\r\n    case \"Open\":\r\n      handleFile(ctx, context, \"open\", layers, setAction);\r\n      break;\r\n    case \"Open Confirm\":\r\n      setCurrLayer(0);\r\n      handleHistory(ctx, context.history, context.setHistory, \"clear\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      context.setClipboard({\r\n        data: {},\r\n        state: \"none\",\r\n      })\r\n      setAction(false);\r\n      break;\r\n    case \"Save\":\r\n      handleFile(ctx, context, \"save\", layers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Save As\":\r\n      dialogSaveAs(context, setAction, setAppDialog);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Change Name\":\r\n      dialogChangeName(context, setAction, setAppDialog);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Change Name Confirm\":\r\n      setTitle(context.name);\r\n      setAppDialog(null);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Image\":\r\n      handleFile(ctx, context, \"image\", layers, setAction);\r\n      break;\r\n    case \"Undo\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"undo\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Redo\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"redo\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"New Layer\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"save\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Delete Layer\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"delete layer\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Duplicate Layer\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"duplicate layer\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Zoom In\":\r\n      if (context.zoom < 4) {\r\n        if (context.zoom < 1) {\r\n          context.setZoom(context.zoom + 0.25);\r\n          args = { zoom: context.zoom + 0.25 };\r\n        } else {\r\n          context.setZoom(context.zoom + 1);\r\n          args = { zoom: context.zoom + 1 };\r\n        }\r\n        handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      }\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Zoom Out\":\r\n      if (context.zoom > 0.25) {\r\n        if (context.zoom <= 1) {\r\n          context.setZoom(context.zoom - 0.25);\r\n          args = { zoom: context.zoom - 0.25 };\r\n        } else {\r\n          context.setZoom(context.zoom - 1);\r\n          args = { zoom: context.zoom - 1 };\r\n        }\r\n        handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      }\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Zoom Reset\":\r\n      context.setZoom(1);\r\n      args = { zoom: 1 };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"Zoom Min\":\r\n      args = { zoom: 0.25 };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      setAction(false);\r\n      break;\r\n    case \"Zoom Max\":\r\n      args = { zoom: 4 };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      setAction(false);\r\n      break;\r\n    case \"Zoom Default\":\r\n      args = { zoom: 1 };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      setAction(false);\r\n      break;\r\n    case \"Zoom Change\":\r\n      args = { zoom: 2 } // Any value between 0.25 and 4 except for 1 will work to correctly update top menu\r\n      handleTopMenu(appMenu, setAppMenu, args, \"zoom\");\r\n      setAction(false);\r\n      break;\r\n    case \"Cut\":\r\n      //TODO\r\n      setAction(false);\r\n      break;\r\n    case \"Copy\":\r\n      //TODO\r\n      setAction(false);\r\n      break;\r\n    case \"Paste\":\r\n      //TODO\r\n      setAction(false);\r\n      break;\r\n    case \"Select All\":\r\n      //TODO\r\n      setAction(false);\r\n      break;\r\n    case \"Select Clear\":\r\n      //TODO\r\n      setAction(false);\r\n      break;\r\n    case \"finished\":\r\n      handleHistory(ctx, context.history, context.setHistory, \"save\", appMenu, setAppMenu, setCanClose, currLayer, layers, setLayers);\r\n      setAction(false);\r\n      break;\r\n    case \"drawing\":\r\n      if (context.cursor.down && !layers[currLayer].locked) {\r\n        handleTools(canvas, context.cursor, context.setCursor, params, action, setAction);\r\n      } else {\r\n        setAction(\"finished\");\r\n      }\r\n      break;\r\n    case \"spraying\":\r\n      if (context.cursor.down && !layers[currLayer].locked) {\r\n        //Allows for a continuous spray without moving the mouse\r\n        setTimeout(() => {\r\n          setAction(\"drawing\")\r\n        }, 100);\r\n      } else {\r\n        setAction(\"finished\");\r\n      }\r\n      break;\r\n    case \"settingPoints\":\r\n      if (context.cursor.down) {\r\n        handleTools(canvas, context.cursor, context.setCursor, params, action, setAction);\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"cancel\":\r\n    case \"clipping\":\r\n    case \"confirm\":\r\n      handleTools(canvas, context.cursor, context.setCursor, params, action, setAction);\r\n      break;\r\n    case false:\r\n      if (context.cursor.down && !layers[currLayer].locked) {\r\n        handleTools(canvas, context.cursor, context.setCursor, params, action, setAction);\r\n      }\r\n      break;\r\n    case \"topNavBar\":\r\n      context.setView({ ...context.view, topNavBar: !context.view.topNavBar });\r\n      args = { view: { ...context.view, topNavBar: !context.view.topNavBar } };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"view\");\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"contentBar\":\r\n      context.setView({ ...context.view, contentBar: !context.view.contentBar });\r\n      args = { view: { ...context.view, contentBar: !context.view.contentBar } };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"view\");\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"bottomNavBar\":\r\n      context.setView({ ...context.view, bottomNavBar: !context.view.bottomNavBar });\r\n      args = { view: { ...context.view, bottomNavBar: !context.view.bottomNavBar } };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"view\");\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    case \"toolBar\":\r\n      context.setView({ ...context.view, toolBar: !context.view.toolBar });\r\n      args = { view: { ...context.view, toolBar: !context.view.toolBar } };\r\n      handleTopMenu(appMenu, setAppMenu, args, \"view\");\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    /*case \"menuBar\":\r\n      context.setView({ ...context.view, menuBar: !context.view.menuBar });\r\n      args={view: { ...context.view, menuBar: !context.view.menuBar }};\r\n      handleTopMenu(appMenu, setAppMenu, args, \"view\");\r\n      setAction(false);\r\n      break;*/\r\n    case \"Close\":\r\n      if (!canClose) {\r\n        dialogCloseApp(setCanClose, setAction, setAppDialog);\r\n      }\r\n      break;\r\n    case \"Save and Close\":\r\n      handleFile(ctx, context, \"save\");\r\n      setCanClose(true);\r\n      setAction(\"Close\");\r\n      break;\r\n    case \"Cancel Dialog\":\r\n      if (context.clipboard.state === \"carry\" && context.tool === \"Select\") {\r\n        setAction(\"clipping\")\r\n      } else {\r\n        setAction(false);\r\n      }\r\n      break;\r\n    default:\r\n      setAction(false);\r\n      break;\r\n  }\r\n};","export const dialogNew = (context, setAction, setAppDialog) => {\r\n\r\n\r\n    context.setNewParams({ ...context.newParams, width: context.dimentions.width, height: context.dimentions.height, name: context.name, alpha: context.useAlpha });\r\n\r\n    let title = \"New File\";\r\n\r\n    const info = <>\r\n        <label htmlFor=\"New title\">Name</label>\r\n        <br />\r\n        <input\r\n            id=\"New title\"\r\n            type=\"text\"\r\n            value={context.newParams.name}\r\n            onChange={(e) => { context.setNewParams({ ...context.newParams, name: e.target.value }); setAction(\"New\") }} />\r\n        <br />\r\n        <label htmlFor=\"Width\">Width</label>\r\n        <br />\r\n        <input\r\n            id=\"Width\"\r\n            type=\"number\"\r\n            value={context.newParams.width}\r\n            onChange={(e) => { context.setNewParams({ ...context.newParams, width: e.target.value }); setAction(\"New\") }} />\r\n        <br />\r\n        <label htmlFor=\"Height\">Height</label>\r\n        <br />\r\n        <input\r\n            id=\"Height\"\r\n            type=\"number\"\r\n            value={context.newParams.height}\r\n            onChange={(e) => { context.setNewParams({ ...context.newParams, height: e.target.value }); setAction(\"New\") }} />\r\n        <br />\r\n        <label htmlFor=\"Alpha\">Alpha</label>\r\n        <br />\r\n        <input\r\n            id=\"Alpha\"\r\n            type=\"checkbox\"\r\n            checked={context.newParams.alpha}\r\n            onChange={(e) => { context.setNewParams({ ...context.newParams, alpha: e.target.checked }); setAction(\"New\") }} />\r\n        <br />\r\n    </>;\r\n\r\n\r\n    const actions = {\r\n        Confirm: () => {\r\n            context.setDimentions({ height: context.newParams.height, width: context.newParams.width });\r\n            context.setName(context.newParams.name);\r\n            context.setUseAlpha(context.newParams.alpha);\r\n            setAction(\"New Confirm\");\r\n            setAppDialog(null);\r\n        },\r\n        Cancel: () => {\r\n            setAppDialog(null);\r\n            setAction(\"Cancel Dialog\");\r\n        }\r\n    }\r\n\r\n    setAppDialog({ title: title, info: info, actions: actions });\r\n}","export const dialogSaveAs = (context, setAction, setAppDialog) => {\r\n\r\n    const title = \"Download As\";\r\n\r\n    const info = <>\r\n        <label htmlFor=\"New Name\">Name</label>\r\n        <br />\r\n        <input\r\n            id=\"New name\"\r\n            type=\"text\"\r\n            value={context.name}\r\n            onChange={(e) => { context.setName(e.target.value); setAction(\"Change Name\") }} />\r\n        <br />\r\n    </>;\r\n\r\n    const actions = {\r\n        Confirm: () => {\r\n            setAction(\"Save\");\r\n            setAppDialog(null);\r\n        },\r\n        Cancel: () => {\r\n            setAppDialog(null);\r\n            setAction(\"Cancel Dialog\");\r\n        }\r\n    };\r\n\r\n    setAppDialog({ title: title, info: info, actions: actions });\r\n}","export const dialogChangeName = (context, setAction, setAppDialog) => {\r\n\r\n    const title = \"Change Name\";\r\n\r\n    const info = <>\r\n        <label htmlFor=\"New title\">Name</label>\r\n        <br />\r\n        <input\r\n            id=\"New title\"\r\n            type=\"text\"\r\n            value={context.name}\r\n            onChange={(e) => { context.setName(e.target.value); setAction(\"Change Name\") }} />\r\n        <br />\r\n    </>;\r\n\r\n    const actions = {\r\n        Confirm: () => {\r\n            setAction(\"Change Name Confirm\");\r\n            setAppDialog(null);\r\n        },\r\n        Cancel: () => {\r\n            setAppDialog(null);\r\n            setAction(\"Cancel Dialog\");\r\n        }\r\n    };\r\n\r\n    setAppDialog({ title: title, info: info, actions: actions });\r\n}","export const dialogCloseApp = (setCanClose, setAction, setAppDialog) => {\r\n    \r\n      setAppDialog({\r\n        title: \"Warning\",\r\n        info: \"Do you want to download the file before closing?\",\r\n        actions: {\r\n          Save: () => {\r\n            setAction(\"Save and Close\");\r\n            setAppDialog(null);\r\n          },\r\n          Close: () => {\r\n            setCanClose(true);\r\n            setAppDialog(null);\r\n          },\r\n          Cancel: () => {\r\n            setAppDialog(null);\r\n            setAction(\"Cancel Dialog\");\r\n          }\r\n        }\r\n      });\r\n}","import { useContext, useEffect } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { handleAction } from \"../Handlers/handleAction.jsx\";\r\nexport default function DrawCanvas({ action, setAction, appMenu, setAppMenu, appDialog, setAppDialog, contextMenu, canClose, setCanClose, title, setTitle }) {\r\n\r\n  const context = useContext(Context);\r\n  const layers = context.layers;\r\n  const setLayers = context.setLayers;\r\n  const currLayer = context.currLayer;\r\n  const setCurrLayer = context.setCurrLayer;\r\n  const tool = context.tool;\r\n  const brushPoints = context.brushPoints;\r\n  const setBrushPoints = context.setBrushPoints;\r\n  const subTool = context.subTool;\r\n  const curveControls = context.curveControls;\r\n  const setCurveControls = context.setCurveControls;\r\n  const size = context.size;\r\n  const selectedColor = context.color.selected;\r\n  const color1 = context.color[1];\r\n  const setColor1 = (v) => context.setColor({ ...context.color, 1: v, selected: v });\r\n  const color2 = context.color[2];\r\n  const setColor2 = (v) => context.setColor({ ...context.color, 2: v, selected: v });\r\n  const text = context.text;\r\n  const setText = context.setText;\r\n  const clipboard = context.clipboard;\r\n  const setClipboard = context.setClipboard;\r\n  const params = {\r\n    tool,\r\n    brushPoints,\r\n    setBrushPoints,\r\n    subTool,\r\n    curveControls,\r\n    setCurveControls,\r\n    size,\r\n    selectedColor,\r\n    color1,\r\n    setColor1,\r\n    color2,\r\n    setColor2,\r\n    text,\r\n    setText,\r\n    clipboard,\r\n    setClipboard,\r\n  };\r\n\r\n  function constructFilters(filters) {\r\n    if (!filters) return \"\"\r\n    let filtersString = \"\";\r\n    Object.keys(filters).forEach((key) => {\r\n      if (key === \"hue-rotate\") {\r\n        //Note: CSS filters rotate in the opposite direction as Canvas filter\r\n        //unfortunatelly, this does not quite capture the full difference between the two resulting colors\r\n        filtersString += `${key}(-${filters[key]}deg) `\r\n      } else if (key === \"blur\") {\r\n        filtersString += `${key}(${filters[key]}px) `\r\n      } else if (key === \"drop-shadow\") {\r\n        filtersString += `${key}(${filters[key][0]}px ${filters[key][1]}px ${filters[key][2]}px ${filters[key][3]}) `\r\n      } else {\r\n        filtersString += `${key}(${filters[key]}%) `\r\n      }\r\n    });\r\n    return filtersString\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (layers[currLayer].id === undefined) return\r\n    let canvas = document.getElementById(`drawCanvasLayer${layers[currLayer].id}`);\r\n    let ctx = canvas.getContext(\"2d\", {\r\n      willReadFrequently: true,\r\n    });\r\n    handleAction({ canvas, ctx, params, action, setAction, context, appMenu, setAppMenu, appDialog, setAppDialog, contextMenu, canClose, setCanClose, title, setTitle, currLayer, setCurrLayer, layers, setLayers });\r\n  }, [context.cursor, action]);\r\n\r\n  useEffect(() => {\r\n    let offsetX = (context.dimentions.width / 2 - context.zoom * context.dimentions.width / 2) * -1 / context.zoom;\r\n    let offsetY = (context.dimentions.height / 2 - context.zoom * context.dimentions.height / 2) * -1 / context.zoom;\r\n    document.getElementById(\"drawDocCheckersBackground\").style.transform = `scale(${context.zoom}) translate(${offsetX}px,${offsetY}px)`;\r\n    document.getElementById(\"previewCanvas\").style.transform = `scale(${context.zoom}) translate(${offsetX}px,${offsetY}px)`;\r\n    //document.getElementById(\"carryCanvas\").style.transform = `scale(${context.zoom}) translate(${offsetX}px,${offsetY}px)`;\r\n    document.getElementById(\"interfaceCanvas\").style.transform = `scale(${context.zoom}) translate(${offsetX}px,${offsetY}px)`;\r\n    const layers = document.getElementsByClassName(\"drawCanvasLayer\");\r\n    if (layers.length > 0) {\r\n      for (let i = 0; i < layers.length; i++) {\r\n        layers[i].style.transform = `scale(${context.zoom}) translate(${offsetX}px,${offsetY}px)`;\r\n      }\r\n    }\r\n  }, [context.zoom, context.cursor]);\r\n\r\n  return (\r\n    <>\r\n      <img\r\n        id=\"drawDocCheckersBackground\"\r\n        className=\"drawDocCheckersBackground\"\r\n        height={context.dimentions.height} width={context.dimentions.width}\r\n      />\r\n      {layers.length > 0 && layers.map((layer, index) => {\r\n        return (\r\n          <canvas\r\n            key={layer.id}\r\n            id={`drawCanvasLayer${layer.id}`}\r\n            className={\"drawCanvasLayer\"}\r\n            style={{\r\n              display: layer.visible ? \"block\" : \"none\",\r\n              filter: constructFilters(layer.filters),\r\n              opacity: layer.opacity,\r\n              mixBlendMode: layer.blending,\r\n              zIndex: index\r\n            }}\r\n            height={context.dimentions.height} width={context.dimentions.width}\r\n          />\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};","import { useRef, useEffect, useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { handleDraw } from \"../Handlers/handleDraw.js\";\r\n\r\nexport default function PreviewCanvas() {\r\n\r\n    const context = useContext(Context);\r\n    const canvasPreviewRef = useRef(null);\r\n    const cursor = context.cursor;\r\n    const tool = context.tool;\r\n    const brushPoints = context.brushPoints;\r\n    const setBrushPoints = context.setBrushPoints;\r\n    const subTool = context.subTool;\r\n    const curveControls = context.curveControls;\r\n    const setCurveControls = context.setCurveControls;\r\n    const size = context.size;\r\n    const selectedColor = context.color.selected;\r\n    const color1 = context.color[1];\r\n    const setColor1 = (v) => context.setColor({ ...context.color, 1: v });\r\n    const color2 = context.color[2];\r\n    const setColor2 = (v) => context.setColor({ ...context.color, 2: v });\r\n    const text = context.text;\r\n    const setText = context.setText;\r\n    const clipboard = context.clipboard;\r\n    const setClipboard = context.setClipboard;\r\n    const layers = context.layers;\r\n    const currLayer = context.currLayer;\r\n    const params = {\r\n        tool,\r\n        subTool,\r\n        brushPoints,\r\n        setBrushPoints,\r\n        curveControls,\r\n        setCurveControls,\r\n        size,\r\n        selectedColor,\r\n        color1,\r\n        setColor1,\r\n        color2,\r\n        setColor2,\r\n        text,\r\n        setText,\r\n        clipboard,\r\n        setClipboard,\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!layers[currLayer].locked) {\r\n            handleDraw(canvasPreviewRef.current, cursor, params, true);\r\n        }\r\n    }, [cursor, params]);\r\n\r\n    return (\r\n        <canvas\r\n            ref={canvasPreviewRef}\r\n            style={{\r\n                display: layers[currLayer].locked ? \"none\" : \"block\",\r\n                color: params.selectedColor,\r\n                zIndex: currLayer\r\n            }}\r\n            id=\"previewCanvas\"\r\n            height={context.dimentions.height}\r\n            width={context.dimentions.width}\r\n        />\r\n    );\r\n};","import { useState, useEffect, useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\n\r\nexport default function SelectionCanvas() {\r\n    const context = useContext(Context);\r\n    const cursor = context.cursor;\r\n    const setCursor = context.setCursor;\r\n    const zoom = context.zoom;\r\n    const tool = context.tool;\r\n    const subtool = context.subTool;\r\n    const setSubTool = context.setSubTool;\r\n    const layers = context.layers;\r\n    const currLayer = context.currLayer;\r\n    const clipboard = context.clipboard;\r\n    const curveControls = context.curveControls;\r\n    const setCurveControls = context.setCurveControls;\r\n\r\n    const [selectionBox, setSelectionBox] = useState({\r\n        left: 0 + \"px\",\r\n        top: 0 + \"px\",\r\n        height: 0 + \"px\",\r\n        width: 0 + \"px\",\r\n        canUsePointer: true\r\n    })\r\n\r\n    const [selectionCircle, setSelectionCircle] = useState({\r\n        left: 0 + \"px\",\r\n        top: 0 + \"px\",\r\n        diameter: 0 + \"px\"\r\n    })\r\n\r\n    const [selectionEllipse, setSelectionEllipse] = useState({\r\n        left: 0 + \"px\",\r\n        top: 0 + \"px\",\r\n        width: 0 + \"px\",\r\n        height: 0 + \"px\"\r\n    })\r\n\r\n    const [resizeDelta, setResizeDelta] = useState([0, 0, true])\r\n    const [dragDelta, setDragDelta] = useState([0, 0, 0, 0])\r\n    const [rotateStartPos, setRotateStartPos] = useState([0, 0, 0])\r\n    const [dragPivotDelta, setDragPivotDelta] = useState([0, 0, false])\r\n\r\n    //Note: Firefox returns zero values during a drag event, therefore, \r\n    // in order to avoid incorrect values, values of zero are ignored\r\n    const getCursorFromEvent = (e) => {\r\n        let cursorX, cursorY, flag = false;\r\n        if (e.button === 0) {\r\n            if (e.clientX !== 0 && e.clientY !== 0) {\r\n                cursorX = e.clientX;\r\n                cursorY = e.clientY;\r\n                flag = true;\r\n            }\r\n        } else {\r\n            if (e.touches[0].clientX !== 0 && e.touches[0].clientY !== 0) {\r\n                cursorX = e.touches[0].clientX;\r\n                cursorY = e.touches[0].clientY;\r\n                flag = true;\r\n            }\r\n        }\r\n        if (!flag) {\r\n            return [0, 0, false]\r\n        } else {\r\n            let canvas = document.getElementById(\"interfaceCanvas\");\r\n            let ctx = canvas.getContext('2d', { alpha: true });\r\n            let boundary = canvas.getBoundingClientRect();\r\n            const scaleX = (ctx.canvas.width / boundary.width);\r\n            const scaleY = (ctx.canvas.height / boundary.height);\r\n            cursorX = (cursorX - boundary.left) * scaleX;\r\n            cursorY = (cursorY - boundary.top) * scaleY;\r\n            return [cursorX, cursorY, true]\r\n        }\r\n    }\r\n\r\n    const handleResizeStart = (e, direction) => {\r\n        e.stopPropagation();\r\n        setCursor({ ...cursor, selecting: true });\r\n        const cursorPos = getCursorFromEvent(e);\r\n        let newDeltaX = 0;\r\n        let newDeltaY = 0;\r\n        if (cursorPos[2] === false) return\r\n        if (direction.indexOf(\"N\") !== -1) {\r\n            newDeltaY = cursorPos[1] - Math.min(cursor.start.y, cursor.end.y);\r\n        } else if (direction.indexOf(\"S\") !== -1) {\r\n            newDeltaY = cursorPos[1] - Math.max(cursor.start.y, cursor.end.y);\r\n        }\r\n        if (direction.indexOf(\"W\") !== -1) {\r\n            newDeltaX = cursorPos[0] - Math.min(cursor.start.x, cursor.end.x);\r\n        } else if (direction.indexOf(\"E\") !== -1) {\r\n            newDeltaX = cursorPos[0] - Math.max(cursor.start.x, cursor.end.x);\r\n        }\r\n        setResizeDelta([newDeltaX, newDeltaY]);\r\n    }\r\n\r\n    function handleResizeCommon(e, cursorPos, direction) {\r\n        // check for inverted axis\r\n        let invertX = false, invertY = false;\r\n        if (cursor.start.x > cursor.end.x) invertX = true;\r\n        if (cursor.start.y > cursor.end.y) invertY = true;\r\n        // calculate difference between cursor and selectionBox\r\n        let newStartX = cursor.start.x, newStartY = cursor.start.y, newEndX = cursor.end.x, newEndY = cursor.end.y;\r\n        if (direction.indexOf(\"N\") !== -1) {\r\n            invertY ? newEndY = cursorPos[1] - resizeDelta[1] : newStartY = cursorPos[1] - resizeDelta[1]\r\n        } else if (direction.indexOf(\"S\") !== -1) {\r\n            invertY ? newStartY = cursorPos[1] - resizeDelta[1] : newEndY = cursorPos[1] - resizeDelta[1]\r\n        }\r\n        if (direction.indexOf(\"E\") !== -1) {\r\n            invertX ? newStartX = cursorPos[0] - resizeDelta[0] : newEndX = cursorPos[0] - resizeDelta[0]\r\n        } else if (direction.indexOf(\"W\") !== -1) {\r\n            invertX ? newEndX = cursorPos[0] - resizeDelta[0] : newStartX = cursorPos[0] - resizeDelta[0]\r\n        }\r\n        return [newStartX, newStartY, newEndX, newEndY]\r\n    }\r\n\r\n    const handleResize = (e, direction) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        const resizeResult = handleResizeCommon(e, cursorPos, direction);\r\n        setCursor({ ...cursor, start: { x: resizeResult[0], y: resizeResult[1] }, end: { x: resizeResult[2], y: resizeResult[3] } })\r\n    }\r\n\r\n    const handleResizeEnd = (e, direction) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        const resizeResult = handleResizeCommon(e, cursorPos, direction);\r\n        setCursor({ ...cursor, start: { x: resizeResult[0], y: resizeResult[1] }, end: { x: resizeResult[2], y: resizeResult[3] }, selecting: false })\r\n    }\r\n\r\n    const handleDragStart = (e) => {\r\n        e.stopPropagation();\r\n        setCursor({ ...cursor, selecting: true });\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.id !== \"drawDocSelectionBox\"\r\n            && e.target.id !== \"drawDocSelectionEllipse\"\r\n            && e.target.id !== \"drawDocSelectionCircle\"\r\n            && e.target.id !== \"drawDocSelectionBoxDragPivot\") {\r\n            return\r\n        }\r\n        let startDeltaX = 0, startDeltaY = 0, endDeltaX = 0, endDeltaY = 0;\r\n        startDeltaX = cursorPos[0] - cursor.start.x;\r\n        startDeltaY = cursorPos[1] - cursor.start.y;\r\n        endDeltaX = cursorPos[0] - cursor.end.x;\r\n        endDeltaY = cursorPos[1] - cursor.end.y;\r\n        setDragDelta([startDeltaX, startDeltaY, endDeltaX, endDeltaY]);\r\n    }\r\n\r\n    const handleDrag = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.id !== \"drawDocSelectionBox\"\r\n            && e.target.id !== \"drawDocSelectionEllipse\"\r\n            && e.target.id !== \"drawDocSelectionCircle\"\r\n            && e.target.id !== \"drawDocSelectionBoxDragPivot\") {\r\n            return\r\n        }\r\n        setCursor({\r\n            ...cursor,\r\n            start: { x: cursorPos[0] - dragDelta[0], y: cursorPos[1] - dragDelta[1] },\r\n            end: { x: cursorPos[0] - dragDelta[2], y: cursorPos[1] - dragDelta[3] }\r\n        })\r\n    }\r\n\r\n    const handleDragEnd = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.id !== \"drawDocSelectionBox\"\r\n            && e.target.id !== \"drawDocSelectionEllipse\"\r\n            && e.target.id !== \"drawDocSelectionCircle\"\r\n            && e.target.id !== \"drawDocSelectionBoxDragPivot\") {\r\n            return\r\n        }\r\n        setCursor({\r\n            ...cursor,\r\n            start: { x: cursorPos[0] - dragDelta[0], y: cursorPos[1] - dragDelta[1] },\r\n            end: { x: cursorPos[0] - dragDelta[2], y: cursorPos[1] - dragDelta[3] },\r\n            selecting: false\r\n        })\r\n    }\r\n\r\n    const handleCircleRotateStart = (e) => {\r\n        setCursor({ ...cursor, selecting: true });\r\n        const cursorPos = getCursorFromEvent(e);\r\n        const boundary = document.getElementById(\"previewCanvas\").getBoundingClientRect();\r\n        if (cursorPos[2] === false) return\r\n        setRotateStartPos([cursorPos[0], cursorPos[1], subtool.angle, boundary.left, boundary.top]);\r\n    }\r\n\r\n    const handleCircleRotate = (e) => {\r\n        e.preventDefault();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        //TODO: cursor position must be adjusted to indicate its relative position instead of absolute\r\n        if (cursorPos[2] === false) return\r\n        let top = Number(selectionCircle.top.slice(0, -2));\r\n        let left = Number(selectionCircle.left.slice(0, -2));\r\n        let diameter = Number(selectionCircle.diameter.slice(0, -2));\r\n        let centerX = left + (diameter / 2) + rotateStartPos[3];\r\n        let centerY = top + (diameter / 2) + rotateStartPos[4];\r\n        let horizontal = centerX > cursorPos[0] ? centerX - cursorPos[0] : cursorPos[0] - centerX;\r\n        let vertical = centerY > cursorPos[1] ? centerY - cursorPos[1] : cursorPos[1] - centerY;\r\n        let hypothenuse = Math.sqrt(Math.pow(horizontal, 2) + Math.pow(vertical, 2));\r\n        let currAngleRad = Math.acos((Math.pow(horizontal, 2) + Math.pow(hypothenuse, 2) - Math.pow(vertical, 2)) / (2 * horizontal * hypothenuse))\r\n        let currAngleDeg = currAngleRad / (Math.PI / 180)\r\n        let angle = 0;\r\n        if (cursorPos[0] > centerX && cursorPos[1] < centerY) angle = 90 - currAngleDeg\r\n        else if (cursorPos[0] > centerX && cursorPos[1] > centerY) angle = 90 + currAngleDeg\r\n        else if (cursorPos[0] < centerX && cursorPos[1] > centerY) angle = 180 + 90 - currAngleDeg\r\n        else if (cursorPos[0] < centerX && cursorPos[1] < centerY) angle = 270 + currAngleDeg\r\n        setSubTool({ ...subtool, angle: angle })\r\n    }\r\n\r\n    const handleCircleRotateEnd = (e) => {\r\n        handleCircleRotate(e);\r\n        setCursor({ ...cursor, selecting: false });\r\n    }\r\n\r\n    const handleDragPivotStart = (e, pivot) => {\r\n        e.stopPropagation();\r\n        setCursor({ ...cursor, selecting: true });\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.className !== \"drawDocSelectionPivotPoint\") return\r\n        let startDeltaX = 0, startDeltaY = 0, initialX = 0, initialY = 0;\r\n        switch (pivot) {\r\n            case 0:\r\n                initialX = cursor.start.x;\r\n                initialY = cursor.start.y;\r\n                break;\r\n            case 1:\r\n                initialX = curveControls.controlPoint1.x;\r\n                initialY = curveControls.controlPoint1.y;\r\n                break;\r\n            case 2:\r\n                initialX = curveControls.controlPoint2.x;\r\n                initialY = curveControls.controlPoint2.y;\r\n                break;\r\n            case 3:\r\n                initialX = cursor.end.x;\r\n                initialY = cursor.end.y;\r\n                break;\r\n        }\r\n        startDeltaX = cursorPos[0] - initialX;\r\n        startDeltaY = cursorPos[1] - initialY;\r\n        setDragPivotDelta([startDeltaX, startDeltaY]);\r\n    }\r\n\r\n    const handleDragPivot = (e, pivot) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.className !== \"drawDocSelectionPivotPoint\") return\r\n        switch (pivot) {\r\n            case 0:\r\n                setCursor({\r\n                    ...cursor,\r\n                    start: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                });\r\n                if (subtool.shape === \"Curve\") {\r\n                    setCurveControls({\r\n                        ...curveControls,\r\n                        start: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                    })\r\n                }\r\n                break;\r\n            case 1:\r\n                setCurveControls({\r\n                    ...curveControls,\r\n                    controlPoint1: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                });\r\n                break;\r\n            case 2:\r\n                setCurveControls({\r\n                    ...curveControls,\r\n                    controlPoint2: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                })\r\n                break;\r\n            case 3:\r\n                setCursor({\r\n                    ...cursor,\r\n                    end: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                });\r\n                if (subtool.shape === \"Curve\") {\r\n                    setCurveControls({\r\n                        ...curveControls,\r\n                        end: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                    })\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    const handleDragPivotEnd = (e, pivot) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const cursorPos = getCursorFromEvent(e);\r\n        if (cursorPos[2] === false) return\r\n        if (e.target.className !== \"drawDocSelectionPivotPoint\") return\r\n        switch (pivot) {\r\n            case 0:\r\n                setCursor({\r\n                    ...cursor,\r\n                    start: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] },\r\n                    selecting: false\r\n                });\r\n                if (subtool.shape === \"Curve\") {\r\n                    setCurveControls({\r\n                        ...curveControls,\r\n                        start: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                    })\r\n                }\r\n                break;\r\n            case 1:\r\n                setCursor({\r\n                    ...cursor,\r\n                    selecting: false\r\n                })\r\n                setCurveControls({\r\n                    ...curveControls,\r\n                    controlPoint1: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                });\r\n                break;\r\n            case 2:\r\n                setCursor({\r\n                    ...cursor,\r\n                    selecting: false\r\n                })\r\n                setCurveControls({\r\n                    ...curveControls,\r\n                    controlPoint2: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                })\r\n                break;\r\n            case 3:\r\n                setCursor({\r\n                    ...cursor,\r\n                    end: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] },\r\n                    selecting: false\r\n                });\r\n                if (subtool.shape === \"Curve\") {\r\n                    setCurveControls({\r\n                        ...curveControls,\r\n                        end: { x: cursorPos[0] - dragPivotDelta[0], y: cursorPos[1] - dragPivotDelta[1] }\r\n                    })\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    //Handles position and sizing calculations for each selection div\r\n    useEffect(() => {\r\n        if (tool !== \"Select\" || clipboard.state !== \"carry\") {\r\n            let left = Math.min(cursor.start.x, cursor.end.x);\r\n            let right = Math.max(cursor.start.x, cursor.end.x);\r\n            let top = Math.min(cursor.start.y, cursor.end.y);\r\n            let bottom = Math.max(cursor.start.y, cursor.end.y);\r\n            let height = bottom - top;\r\n            let width = right - left;\r\n            setSelectionBox({\r\n                ...selectionBox,\r\n                left: Math.floor(left * zoom) + \"px\",\r\n                top: Math.floor(top * zoom) + \"px\",\r\n                width: Math.floor(width * zoom) + \"px\",\r\n                height: Math.floor(height * zoom) + \"px\"\r\n            })\r\n            let centerLeft = left + Math.floor(width / 2);\r\n            let centerTop = top + Math.floor(height / 2);\r\n            let diameter = Math.min(width, height);\r\n            setSelectionCircle({\r\n                ...selectionCircle,\r\n                left: Math.floor((centerLeft - (diameter / 2)) * zoom) + \"px\",\r\n                top: Math.floor((centerTop - (diameter / 2)) * zoom) + \"px\",\r\n                diameter: Math.floor(diameter * zoom) + \"px\"\r\n            })\r\n            setSelectionEllipse({\r\n                ...selectionEllipse,\r\n                left: Math.floor(left * zoom) + \"px\",\r\n                top: Math.floor(top * zoom) + \"px\",\r\n                width: Math.floor(width * zoom) + \"px\",\r\n                height: Math.floor(height * zoom) + \"px\"\r\n            })\r\n        } else {\r\n            setSelectionBox({\r\n                ...selectionBox,\r\n                left: Math.floor(cursor.end.x * zoom) + \"px\",\r\n                top: Math.floor(cursor.end.y * zoom) + \"px\",\r\n                width: Math.floor(clipboard.data.width * zoom) + \"px\",\r\n                height: Math.floor(clipboard.data.height * zoom) + \"px\"\r\n            })\r\n        }\r\n    }, [cursor, zoom, tool, clipboard.state]);\r\n\r\n    if (layers[currLayer].locked) return null\r\n    return (\r\n        <>\r\n            {(tool === \"Select\" || (tool === \"Shape\" && subtool.shape !== \"Curve\" && subtool.shape !== \"Line\") || tool === \"Text\") &&\r\n                <div\r\n                    id=\"drawDocSelectionBox\"\r\n                    style={{\r\n                        top: selectionBox.top,\r\n                        left: selectionBox.left,\r\n                        width: selectionBox.width,\r\n                        height: selectionBox.height,\r\n                        pointerEvents: cursor.down ? \"none\" : \"auto\",\r\n                        zIndex: layers.length + 2\r\n                    }}\r\n                    draggable\r\n                    onDragStart={(e) => { if (!cursor.down) handleDragStart(e) }}\r\n                    onDrag={(e) => { if (!cursor.down) handleDrag(e) }}\r\n                    onDragEnd={(e) => { if (!cursor.down) handleDragEnd(e) }}\r\n                >\r\n                    {tool === \"Text\" &&\r\n                        <div id=\"drawDocSelectionBoxDragPivot\" />\r\n                    }\r\n                    {(tool !== \"Select\" || clipboard.state !== \"carry\") &&\r\n                        <>\r\n                            <div\r\n                                id=\"drawDocSelectionBoxNW\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"NW\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"NW\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"NW\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxN\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"N\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"N\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"N\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxNE\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"NE\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"NE\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"NE\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxE\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"E\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"E\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"E\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxSE\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"SE\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"SE\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"SE\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxS\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"S\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"S\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"S\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxSW\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"SW\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"SW\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"SW\") }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionBoxW\"\r\n                                draggable\r\n                                onDragStart={(e) => { if (!cursor.down) handleResizeStart(e, \"W\") }}\r\n                                onDrag={(e) => { if (!cursor.down) handleResize(e, \"W\") }}\r\n                                onDragEnd={(e) => { if (!cursor.down) handleResizeEnd(e, \"W\") }}\r\n                            />\r\n                        </>}\r\n                </div>\r\n            }\r\n            {tool === \"Shape\" && subtool.shape !== \"Line\" && subtool.shape !== \"Curve\" && subtool.stretch &&\r\n                <div\r\n                    id=\"drawDocSelectionEllipse\"\r\n                    style={{\r\n                        top: selectionEllipse.top,\r\n                        left: selectionEllipse.left,\r\n                        width: selectionEllipse.width,\r\n                        height: selectionEllipse.height,\r\n                        rotate: subtool.angle + \"deg\",\r\n                        zIndex: layers.length + 2\r\n                    }}\r\n                    draggable\r\n                    onDragStart={(e) => { if (!cursor.down) handleDragStart(e) }}\r\n                    onDrag={(e) => { if (!cursor.down) handleDrag(e) }}\r\n                    onDragEnd={(e) => { if (!cursor.down) handleDragEnd(e) }}\r\n                >\r\n                </div>}\r\n            {tool === \"Shape\" && subtool.shape !== \"Line\" && subtool.shape !== \"Curve\" &&\r\n                <div\r\n                    id=\"drawDocSelectionCircle\"\r\n                    style={{\r\n                        top: selectionCircle.top,\r\n                        left: selectionCircle.left,\r\n                        width: selectionCircle.diameter,\r\n                        height: selectionCircle.diameter,\r\n                        rotate: subtool.angle + \"deg\",\r\n                        zIndex: layers.length + 2\r\n                    }}\r\n                    draggable\r\n                    onDragStart={(e) => { if (!cursor.down) handleDragStart(e) }}\r\n                    onDrag={(e) => { if (!cursor.down) handleDrag(e) }}\r\n                    onDragEnd={(e) => { if (!cursor.down) handleDragEnd(e) }}\r\n                >\r\n                    <div\r\n                        id=\"drawDocSelectionCirclePoint\"\r\n                        draggable\r\n                        onDragStart={(e) => { if (!cursor.down) handleCircleRotateStart(e) }}\r\n                        onDrag={(e) => { if (!cursor.down) handleCircleRotate(e) }}\r\n                        onDragEnd={(e) => { if (!cursor.down) handleCircleRotateEnd(e) }}\r\n                    />\r\n                </div>\r\n            }\r\n            {tool === \"Text\" && !cursor.down &&\r\n                <textarea id=\"drawDocSelectionBoxText\"\r\n                    style={{\r\n                        top: selectionBox.top,\r\n                        left: selectionBox.left,\r\n                        width: selectionBox.width,\r\n                        height: selectionBox.height,\r\n                        caretColor: context.color.selected,\r\n                        fontSize: context.size * context.zoom + \"px\",\r\n                        fontFamily: context.text.fontFamily,\r\n                        lineHeight: context.text.lineHeight,\r\n                        zIndex: layers.length + 2\r\n                    }}\r\n                    spellCheck={false}\r\n                    value={context.text.text}\r\n                    onChange={(e) => context.setText({ ...context.text, text: e.target.value })}\r\n                />\r\n            }\r\n            {tool === \"Shape\" && subtool.shape === \"Curve\" &&\r\n                <>\r\n                    {curveControls.controlPoint1.x === -1 && curveControls.controlPoint2.x === -1 &&\r\n                        <div\r\n                            id=\"drawDocSelectionPivotLineStartEnd\"\r\n                            className=\"drawDocSelectionPivotLine\"\r\n                            style={{\r\n                                display: \"block\",\r\n                                top: Math.floor(curveControls.start.y * zoom) + \"px\",\r\n                                left: Math.floor(curveControls.start.x * zoom) + \"px\",\r\n                                width: Math.floor(\r\n                                    Math.sqrt(Math.pow(curveControls.end.x - curveControls.start.x, 2) + Math.pow(curveControls.end.y - curveControls.start.y, 2)) * zoom) + \"px\",\r\n                                rotate: Math.floor(Math.atan2(curveControls.end.y - curveControls.start.y, curveControls.end.x - curveControls.start.x) * 180 / Math.PI) + \"deg\",\r\n                                zIndex: layers.length + 2\r\n                            }}\r\n                        />\r\n                    }\r\n                    {curveControls.controlPoint1.x !== -1 && curveControls.controlPoint2.x === -1 &&\r\n                        <>\r\n                            <div\r\n                                id=\"drawDocSelectionPivotLineStart1\"\r\n                                className=\"drawDocSelectionPivotLine\"\r\n                                style={{\r\n                                    display: \"block\",\r\n                                    top: Math.floor(curveControls.start.y * zoom) + \"px\",\r\n                                    left: Math.floor(curveControls.start.x * zoom) + \"px\",\r\n                                    width: Math.floor(\r\n                                        Math.sqrt(Math.pow(curveControls.controlPoint1.x - curveControls.start.x, 2) + Math.pow(curveControls.controlPoint1.y - curveControls.start.y, 2)) * zoom) + \"px\",\r\n                                    rotate: Math.floor(Math.atan2(curveControls.controlPoint1.y - curveControls.start.y, curveControls.controlPoint1.x - curveControls.start.x) * 180 / Math.PI) + \"deg\",\r\n                                    zIndex: layers.length + 2\r\n                                }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionPivotLine1End\"\r\n                                className=\"drawDocSelectionPivotLine\"\r\n                                style={{\r\n                                    display: \"block\",\r\n                                    top: Math.floor(curveControls.controlPoint1.y * zoom) + \"px\",\r\n                                    left: Math.floor(curveControls.controlPoint1.x * zoom) + \"px\",\r\n                                    width: Math.floor(\r\n                                        Math.sqrt(Math.pow(curveControls.end.x - curveControls.controlPoint1.x, 2) + Math.pow(curveControls.end.y - curveControls.controlPoint1.y, 2)) * zoom) + \"px\",\r\n                                    rotate: Math.floor(Math.atan2(curveControls.end.y - curveControls.controlPoint1.y, curveControls.end.x - curveControls.controlPoint1.x) * 180 / Math.PI) + \"deg\",\r\n                                    zIndex: layers.length + 2\r\n                                }}\r\n                            />\r\n                        </>\r\n                    }\r\n                    {curveControls.controlPoint1.x !== -1 && curveControls.controlPoint2.x !== -1 &&\r\n                        <>\r\n                            <div\r\n                                id=\"drawDocSelectionPivotLineStart1\"\r\n                                className=\"drawDocSelectionPivotLine\"\r\n                                style={{\r\n                                    display: \"block\",\r\n                                    top: Math.floor(curveControls.start.y * zoom) + \"px\",\r\n                                    left: Math.floor(curveControls.start.x * zoom) + \"px\",\r\n                                    width: Math.floor(\r\n                                        Math.sqrt(Math.pow(curveControls.controlPoint1.x - curveControls.start.x, 2) + Math.pow(curveControls.controlPoint1.y - curveControls.start.y, 2)) * zoom) + \"px\",\r\n                                    rotate: Math.floor(Math.atan2(curveControls.controlPoint1.y - curveControls.start.y, curveControls.controlPoint1.x - curveControls.start.x) * 180 / Math.PI) + \"deg\",\r\n                                    zIndex: layers.length + 2\r\n                                }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionPivotLine12\"\r\n                                className=\"drawDocSelectionPivotLine\"\r\n                                style={{\r\n                                    display: \"block\",\r\n                                    top: Math.floor(curveControls.controlPoint1.y * zoom) + \"px\",\r\n                                    left: Math.floor(curveControls.controlPoint1.x * zoom) + \"px\",\r\n                                    width: Math.floor(\r\n                                        Math.sqrt(Math.pow(curveControls.controlPoint2.x - curveControls.controlPoint1.x, 2) + Math.pow(curveControls.controlPoint2.y - curveControls.controlPoint1.y, 2)) * zoom) + \"px\",\r\n                                    rotate: Math.floor(Math.atan2(curveControls.controlPoint2.y - curveControls.controlPoint1.y, curveControls.controlPoint2.x - curveControls.controlPoint1.x) * 180 / Math.PI) + \"deg\",\r\n                                    zIndex: layers.length + 2\r\n                                }}\r\n                            />\r\n                            <div\r\n                                id=\"drawDocSelectionPivotLine2End\"\r\n                                className=\"drawDocSelectionPivotLine\"\r\n                                style={{\r\n                                    display: \"block\",\r\n                                    top: Math.floor(curveControls.controlPoint2.y * zoom) + \"px\",\r\n                                    left: Math.floor(curveControls.controlPoint2.x * zoom) + \"px\",\r\n                                    width: Math.floor(\r\n                                        Math.sqrt(Math.pow(curveControls.end.x - curveControls.controlPoint2.x, 2) + Math.pow(curveControls.end.y - curveControls.controlPoint2.y, 2)) * zoom) + \"px\",\r\n                                    rotate: Math.floor(Math.atan2(curveControls.end.y - curveControls.controlPoint2.y, curveControls.end.x - curveControls.controlPoint2.x) * 180 / Math.PI) + \"deg\",\r\n                                    zIndex: layers.length + 2\r\n                                }}\r\n                            />\r\n                        </>\r\n                    }\r\n                    <div\r\n                        id=\"drawDocSelectionPivotPoint1\"\r\n                        className=\"drawDocSelectionPivotPoint\"\r\n                        style={{\r\n                            display: curveControls.controlPoint1.x > -1 && !cursor.down ? \"block\" : \"none\",\r\n                            top: Math.floor(curveControls.controlPoint1.y * zoom) + \"px\",\r\n                            left: Math.floor(curveControls.controlPoint1.x * zoom) + \"px\",\r\n                            zIndex: layers.length + 2\r\n                        }}\r\n                        draggable\r\n                        onDragStart={(e) => { if (!cursor.down) handleDragPivotStart(e, 1) }}\r\n                        onDrag={(e) => { if (!cursor.down) handleDragPivot(e, 1) }}\r\n                        onDragEnd={(e) => { if (!cursor.down) handleDragPivotEnd(e, 1) }}\r\n                    />\r\n                    <div\r\n                        id=\"drawDocSelectionPivotPoint2\"\r\n                        className=\"drawDocSelectionPivotPoint\"\r\n                        style={{\r\n                            display: curveControls.controlPoint2.x > -1 && !cursor.down ? \"block\" : \"none\",\r\n                            top: Math.floor(curveControls.controlPoint2.y * zoom) + \"px\",\r\n                            left: Math.floor(curveControls.controlPoint2.x * zoom) + \"px\",\r\n                            zIndex: layers.length + 2\r\n                        }}\r\n                        draggable\r\n                        onDragStart={(e) => { if (!cursor.down) handleDragPivotStart(e, 2) }}\r\n                        onDrag={(e) => { if (!cursor.down) handleDragPivot(e, 2) }}\r\n                        onDragEnd={(e) => { if (!cursor.down) handleDragPivotEnd(e, 2) }}\r\n                    />\r\n                </>\r\n            }\r\n            {tool === \"Shape\" && (subtool.shape === \"Line\" || subtool.shape === \"Curve\") &&\r\n                <>\r\n                    <div\r\n                        id=\"drawDocSelectionPivotStartPoint\"\r\n                        className=\"drawDocSelectionPivotPoint\"\r\n                        style={{\r\n                            display: !cursor.down ? \"block\" : \"none\",\r\n                            top: subtool.shape === \"Curve\" ? Math.floor(curveControls.start.y * zoom) + \"px\" : Math.floor(cursor.start.y * zoom) + \"px\",\r\n                            left: subtool.shape === \"Curve\" ? Math.floor(curveControls.start.x * zoom) + \"px\" : Math.floor(cursor.start.x * zoom) + \"px\",\r\n                            zIndex: layers.length + 2\r\n                        }}\r\n                        draggable\r\n                        onDragStart={(e) => { if (!cursor.down) handleDragPivotStart(e, 0) }}\r\n                        onDrag={(e) => { if (!cursor.down) handleDragPivot(e, 0) }}\r\n                        onDragEnd={(e) => { if (!cursor.down) handleDragPivotEnd(e, 0) }}\r\n                    />\r\n                    <div\r\n                        id=\"drawDocSelectionPivotEndPoint\"\r\n                        className=\"drawDocSelectionPivotPoint\"\r\n                        style={{\r\n                            display: !cursor.down ? \"block\" : \"none\",\r\n                            top: subtool.shape === \"Curve\" ? Math.floor(curveControls.end.y * zoom) + \"px\" : Math.floor(cursor.end.y * zoom) + \"px\",\r\n                            left: subtool.shape === \"Curve\" ? Math.floor(curveControls.end.x * zoom) + \"px\" : Math.floor(cursor.end.x * zoom) + \"px\",\r\n                            zIndex: layers.length + 2\r\n                        }}\r\n                        draggable\r\n                        onDragStart={(e) => { if (!cursor.down) handleDragPivotStart(e, 3) }}\r\n                        onDrag={(e) => { if (!cursor.down) handleDragPivot(e, 3) }}\r\n                        onDragEnd={(e) => { if (!cursor.down) handleDragPivotEnd(e, 3) }}\r\n                    />\r\n                </>\r\n            }\r\n\r\n        </>\r\n    )\r\n}","import { useState, useEffect, useContext, Fragment } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { handleTopMenu } from \"../Handlers/handleTopMenu.js\";\r\nimport ColorPicker from \"../../../System/GlobalComponents/ColorPicker/ColorPicker.jsx\";\r\nimport { RiEyeCloseFill, RiEyeFill, RiEditLine } from \"react-icons/ri\";\r\nimport { FaTrashCan } from \"react-icons/fa6\";\r\nimport { BiUndo, BiRedo } from \"react-icons/bi\";\r\nimport { IoDuplicateSharp } from \"react-icons/io5\";\r\nimport { TiLockOpen, TiLockClosed } from \"react-icons/ti\";\r\nimport { IoClose } from \"react-icons/io5\";\r\n\r\nexport default function LayersWindow(props) {\r\n\r\n    const action = props.action;\r\n    const setAction = props.setAction;\r\n    const contextMenu = props.contextMenu;\r\n    const appMenu = props.appMenu;\r\n    const setAppMenu = props.setAppMenu;\r\n\r\n    const context = useContext(Context);\r\n    const history = context.history;\r\n    const setHistory = context.setHistory;\r\n    const currLayer = context.currLayer;\r\n    const setCurrLayer = context.setCurrLayer;\r\n    const layers = context.layers;\r\n    const setLayers = context.setLayers;\r\n    const lastLayer = context.lastLayer;\r\n    const setLastLayer = context.setLastLayer;\r\n\r\n    const [layersCanvasPreviews, setLayersCanvasPreviews] = useState([]);\r\n    const [renameLayerIndex, setRenameLayerIndex] = useState(-1);\r\n    const [dragTargetIndex, setDragTargetIndex] = useState(-1);\r\n    const [dropTargetIndex, setDropTargetIndex] = useState(-1);\r\n\r\n    const BLEND_LIST = [\r\n        \"normal\",\r\n        \"multiply\",\r\n        \"screen\",\r\n        \"overlay\",\r\n        \"darken\",\r\n        \"lighten\",\r\n        \"color-dodge\",\r\n        \"color-burn\",\r\n        \"hard-light\",\r\n        \"soft-light\",\r\n        \"difference\",\r\n        \"exclusion\",\r\n        \"hue\",\r\n        \"saturation\",\r\n        \"color\",\r\n        \"luminosity\"\r\n    ];\r\n    const FILTER_LIST = [\r\n        [\"blur\", \"length\"],\r\n        [\"brightness\", \"percentage\"],\r\n        [\"contrast\", \"percentage\"],\r\n        [\"grayscale\", \"percentage\"],\r\n        [\"hue-rotate\", \"angle\"],\r\n        [\"invert\", \"percentage\"],\r\n        [\"saturate\", \"percentage\"],\r\n        [\"sepia\", \"percentage\"],\r\n        [\"drop-shadow\", \"shadow\"]\r\n    ];\r\n\r\n\r\n    function formatListName(name) {\r\n        //Replaces all \"-\" with \" \"\r\n        let formattedName = name.replace(/-/g, \" \");\r\n        //Capitalizes the first letter of each word\r\n        formattedName = formattedName.replace(/\\b([a-z-]{3,})/g, (match) => match.charAt(0).toUpperCase() + match.slice(1));\r\n        return formattedName\r\n    }\r\n\r\n    const getImageFromCanvasRef = (id, notMain) => {\r\n        const canvas = document.getElementById(id);\r\n        const ctx = notMain ?\r\n            canvas.getContext('2d', { alpha: true }) :\r\n            canvas.getContext('2d', { alpha: false });\r\n        return ctx.canvas.toDataURL(\"image/png\")\r\n    }\r\n\r\n    const changeCurrLayer = (index) => {\r\n        setCurrLayer(index);\r\n        let args;\r\n        handleTopMenu(appMenu, setAppMenu, args = { history: { ...layers[index] } }, \"history\");\r\n    }\r\n\r\n    const createNewLayer = () => {\r\n        const newLayer = {\r\n            id: lastLayer + 1,\r\n            name: `Layer ${lastLayer + 1}`,\r\n            blending: \"normal\",\r\n            filters: {},\r\n            opacity: 1,\r\n            visible: true,\r\n            locked: false,\r\n            canUndo: false,\r\n            canRedo: false\r\n        }\r\n        setLayers([...layers, newLayer]);\r\n        setCurrLayer(layers.length);\r\n        setLastLayer(lastLayer + 1);\r\n        setAction(\"New Layer\");\r\n    }\r\n\r\n    const renameLayer = (e, index) => {\r\n        const newLayers = [...layers];\r\n        newLayers[index].name = e.target.value;\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (renameLayerIndex !== -1) {\r\n            const target = document.getElementById(`drawDocLayerNameInput${renameLayerIndex}`);\r\n            target.focus();\r\n            target.select();\r\n            target.addEventListener('blur', () => setRenameLayerIndex(-1));\r\n            target.addEventListener(\"keydown\", (e) => {\r\n                e.key === \"Enter\" && setRenameLayerIndex(-1);\r\n            });\r\n            return () => {\r\n                target.removeEventListener('blur', () => setRenameLayerIndex(-1))\r\n                target.removeEventListener(\"keydown\", (e) => {\r\n                    e.key === \"Enter\" && setRenameLayerIndex(-1);\r\n                });\r\n            };\r\n        }\r\n    }, [renameLayerIndex])\r\n\r\n    const toggleVisibility = (index) => {\r\n        const newLayers = [...layers];\r\n        newLayers[index].visible = !newLayers[index].visible;\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const toggleLock = (index) => {\r\n        const newLayers = [...layers];\r\n        newLayers[index].locked = !newLayers[index].locked;\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const deleteLayer = (index) => {\r\n        setLayers(layers.filter((_layer, i) => i !== index));\r\n        if (index === currLayer || currLayer > layers.length - 2) {\r\n            setCurrLayer(0);\r\n        }\r\n        setAction(\"Delete Layer\");\r\n    }\r\n\r\n    const duplicateLayer = (index) => {\r\n        let newId = lastLayer + 1;\r\n        const newLayer = {\r\n            id: newId,\r\n            name: `Dupe ${layers[index].name}`,\r\n            blending: layers[index].blending,\r\n            filters: layers[index].filters,\r\n            opacity: layers[index].opacity,\r\n            visible: true,\r\n            locked: layers[index].locked,\r\n            canUndo: layers[index].canUndo,\r\n            canRedo: layers[index].canRedo\r\n        }\r\n        setLayers([...layers.slice(0, index + 1), newLayer, ...layers.slice(index + 1)]);\r\n        setCurrLayer(index + 1);\r\n        setLastLayer(lastLayer + 1);\r\n        let newHistory = history\r\n        newHistory[newId] = history[layers[index].id];\r\n        setHistory(newHistory);\r\n        setAction(\"Duplicate Layer\");\r\n    }\r\n\r\n    const changeBlending = (index, value) => {\r\n        const newLayers = [...layers];\r\n        newLayers[index].blending = value;\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const changeOpacity = (index, value) => {\r\n        const newLayers = [...layers];\r\n        newLayers[index].opacity = value;\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const addFilter = (index, key) => {\r\n        if (layers[index].filters[key]) return\r\n        const newLayers = [...layers];\r\n        if (key !== \"drop-shadow\") {\r\n            newLayers[index].filters[key] = 0;\r\n        } else {\r\n            newLayers[index].filters[key] = [0, 0, 0, \"hsla(0,0,0,0)\"]\r\n        }\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const changeFilter = (index, key, value, subkey) => {\r\n        const newLayers = [...layers];\r\n        if (key !== \"drop-shadow\") {\r\n            newLayers[index].filters[key] = value;\r\n        } else {\r\n            newLayers[index].filters[key][subkey] = value\r\n        }\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const removeFilter = (index, key) => {\r\n        const newLayers = [...layers];\r\n        delete newLayers[index].filters[key];\r\n        setLayers(newLayers);\r\n    }\r\n\r\n    const handleLayerDragOver = (e, index) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.dataTransfer.dropEffect = \"move\";\r\n        setDropTargetIndex(index);\r\n    }\r\n\r\n    const handleLayerDrop = (e, index) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        let newLayers = [];\r\n        const draggedLayer = layers[dragTargetIndex];\r\n        //Base layer is not allowed to be dragged, terminates the drag\r\n        //If the target has been dropped on itself, terminates the drag\r\n        if (dragTargetIndex < 1 || dragTargetIndex === index) {\r\n            setDropTargetIndex(-1);\r\n            setDragTargetIndex(-1);\r\n            return\r\n        }\r\n        //No Layer other than Base is allowed in the start of the Array\r\n        else if (index === 0) {\r\n            newLayers = [\r\n                layers[0],\r\n                draggedLayer,\r\n                ...layers.filter((_layer, i) => i !== dragTargetIndex && i !== 0)\r\n            ];\r\n        }\r\n        //Indicates the drop zone is not a layer window, thus its at the end of the Array\r\n        else if (index === layers.length) {\r\n            newLayers = [\r\n                ...layers.filter((_layer, i) => i !== dragTargetIndex),\r\n                draggedLayer\r\n            ]\r\n        }\r\n        //If the target has been dropped on the last layer, places the dragged layer before the last layer\r\n        else if (index === layers.length - 1) {\r\n            const dropLayer = layers[index];\r\n            newLayers = [\r\n                ...layers.filter((_layer, i) => i < index && i !== dragTargetIndex),\r\n                draggedLayer,\r\n                dropLayer\r\n            ]\r\n        }\r\n        //If the target has been dropped on another layer other than itself or base layer\r\n        else {\r\n            const dropLayer = layers[index];\r\n            newLayers = [\r\n                ...layers.filter((_layer, i) => i < index && i !== dragTargetIndex),\r\n                index < dragTargetIndex ? draggedLayer : dropLayer,\r\n                index > dragTargetIndex ? draggedLayer : dropLayer,\r\n                ...layers.filter((_layer, i) => i > index && i !== dragTargetIndex)\r\n            ]\r\n        }\r\n        setLayers(newLayers);\r\n        setDropTargetIndex(-1);\r\n        setDragTargetIndex(-1);\r\n    }\r\n\r\n    //Updates image previews\r\n    useEffect(() => {\r\n        layers.length > 0 && setLayersCanvasPreviews(layers.map((layer) => getImageFromCanvasRef(`drawCanvasLayer${layer.id}`, true)));\r\n    }, [history, layers, action]);\r\n\r\n    return (\r\n        <>\r\n            <div id=\"drawDocLayersWindowNav\">\r\n                <div id=\"drawDocLayersWindowHeaderMixes\">\r\n                    <select\r\n                        id=\"drawDocBlendingSelect\"\r\n                        title=\"Change Blending\"\r\n                        aria-label=\"Change Blending\"\r\n                        onChange={(e) => changeBlending(currLayer, e.target.value)}\r\n                        value={layers[currLayer].blending}\r\n                        disabled={layers[currLayer].locked || currLayer === 0}\r\n                    >\r\n                        {BLEND_LIST.map((blend, index) => {\r\n                            return <option key={index} value={blend}>{formatListName(blend)}</option>\r\n                        })}\r\n                    </select>\r\n                    <div>\r\n                        <label htmlFor=\"drawDocOpacityInput\">Opacity:</label>\r\n                        <input\r\n                            id=\"drawDocOpacityInput\"\r\n                            type=\"number\"\r\n                            min=\"0\"\r\n                            max=\"1\"\r\n                            step=\"0.01\"\r\n                            value={layers[currLayer].opacity}\r\n                            onChange={(e) => changeOpacity(currLayer, e.target.value)}\r\n                            disabled={layers[currLayer].locked || currLayer === 0}\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <div id=\"drawDocLayersWindowHeaderOptions\">\r\n                    <button\r\n                        title=\"Duplicate Layer\"\r\n                        aria-label=\"Duplicate Layer\"\r\n                        onClick={() => duplicateLayer(currLayer)}\r\n                    >\r\n                        <IoDuplicateSharp />\r\n                    </button>\r\n                    <button\r\n                        title=\"Rename Layer\"\r\n                        aria-label=\"Rename Layer\"\r\n                        disabled={currLayer === 0}\r\n                        onClick={() => setRenameLayerIndex(currLayer)}\r\n                    >\r\n                        <RiEditLine />\r\n                    </button>\r\n                    <button\r\n                        title={layers[currLayer].locked ? \"Unlock Layer\" : \"Lock Layer\"}\r\n                        aria-label={layers[currLayer].locked ? \"Unlock Layer\" : \"Lock Layer\"}\r\n                        onClick={() => toggleLock(currLayer)}\r\n                        className={layers[currLayer].locked ? \"buttonActive\" : \"\"}\r\n                    >\r\n                        {layers[currLayer].locked ? <TiLockClosed /> : <TiLockOpen />}\r\n                    </button>\r\n                    <button\r\n                        title=\"Delete Layer\"\r\n                        aria-label=\"Delete Layer\"\r\n                        disabled={currLayer === 0 || layers[currLayer].locked}\r\n                        onClick={() => deleteLayer(currLayer)}\r\n                    >\r\n                        <FaTrashCan />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            <div id=\"drawDocLayersWindow\"\r\n                onDragOver={(e) => { handleLayerDragOver(e, layers.length) }}\r\n                onDrop={(e) => { handleLayerDrop(e, layers.length); }}\r\n            >\r\n                {layers.map((layer, index) => {\r\n                    return (\r\n                        <Fragment key={layer.id}>\r\n                            {index !== 0 && <hr style={{ display: dropTargetIndex === index ? \"block\" : \"none\" }} />}\r\n                            <div\r\n                                className=\"drawDocLayersWindowLayer\"\r\n                                draggable={index !== 0}\r\n                                onDragStart={(e) => setDragTargetIndex(index)}\r\n                                onDrag={(e) => e.preventDefault()}\r\n                                onDragOver={(e) => { handleLayerDragOver(e, index) }}\r\n                                onDrop={(e) => { handleLayerDrop(e, index) }}\r\n                                style={{ cursor: index === 0 ? \"default\" : \"grab\" }}\r\n                            ><div>\r\n                                    <img\r\n                                        src={layersCanvasPreviews[index] ? layersCanvasPreviews[index] : \"\"}\r\n                                        className=\"drawDocCheckersBackground\"\r\n                                        onClick={() => changeCurrLayer(index)}\r\n                                        draggable={index !== 0}\r\n                                    />\r\n                                    <div>\r\n                                        <div>\r\n                                            <input\r\n                                                type=\"radio\"\r\n                                                value={index}\r\n                                                checked={currLayer === index}\r\n                                                onChange={() => changeCurrLayer(index)}\r\n                                            />\r\n                                            <span\r\n                                                style={{\r\n                                                    textDecoration: index === currLayer ? \"underline\" : \"none\",\r\n                                                    display: index === renameLayerIndex ? \"none\" : \"inline-block\"\r\n                                                }}\r\n                                            >\r\n                                                {layer.name}\r\n                                            </span>\r\n                                            <input\r\n                                                style={{ display: index === renameLayerIndex ? \"inline-block\" : \"none\" }}\r\n                                                id={`drawDocLayerNameInput${index}`}\r\n                                                type=\"text\"\r\n                                                value={layer.name}\r\n                                                onChange={(e) => {\r\n                                                    renameLayer(e, index);\r\n                                                }}\r\n                                            />\r\n                                        </div>\r\n                                        <div>\r\n                                            <button\r\n                                                title=\"Toggle Visibility\"\r\n                                                aria-label=\"Toggle Visibility\"\r\n                                                onClick={() => toggleVisibility(index)}\r\n                                            >\r\n                                                {layer.visible ? <RiEyeFill /> : <RiEyeCloseFill />}\r\n                                            </button>\r\n                                            <button\r\n                                                title=\"Undo Layer\"\r\n                                                aria-label=\"Undo Layer\"\r\n                                                disabled={!layer.canUndo || layer.locked}\r\n                                                onClick={() => { setCurrLayer(index); setAction(\"Undo\") }}\r\n                                            >\r\n                                                <BiUndo />\r\n                                            </button>\r\n                                            <button\r\n                                                title=\"Redo Layer\"\r\n                                                aria-label=\"Redo Layer\"\r\n                                                disabled={!layer.canRedo || layer.locked}\r\n                                                onClick={() => { setCurrLayer(index); setAction(\"Redo\") }}\r\n                                            >\r\n                                                <BiRedo />\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div>\r\n                                        Add Filter:\r\n                                        <select\r\n                                            title=\"Add filter\"\r\n                                            aria-label=\"Add filter\"\r\n                                            value=\"\"\r\n                                            onChange={(e) => addFilter(index, e.target.value)}\r\n                                            disabled={layer.locked || index === 0}\r\n                                        >\r\n                                            <option value=\"\">Select</option>\r\n                                            {FILTER_LIST.map((filter, index) => {\r\n                                                return <option key={index} value={filter[0]}>{formatListName(filter[0])}</option>\r\n                                            })}\r\n                                        </select>\r\n                                    </div>\r\n                                </div>\r\n                                <div\r\n                                    className=\"drawDocLayersFilterList\"\r\n                                >\r\n                                    {layer.filters && Object.keys(layer.filters).map((key) => {\r\n                                        return <div key={key}>\r\n                                            <span>{formatListName(key)}</span>\r\n                                            {FILTER_LIST.find((filter) => filter[0] === key)[1] === \"length\" &&\r\n                                                <div><div><input\r\n                                                    type=\"number\"\r\n                                                    min=\"0\"\r\n                                                    step=\"1\"\r\n                                                    value={layer.filters[key]}\r\n                                                    onChange={(e) => changeFilter(index, key, e.target.value)}\r\n                                                />px</div></div>}\r\n                                            {FILTER_LIST.find((filter) => filter[0] === key)[1] === \"percentage\" &&\r\n                                                <div><div><input\r\n                                                    type=\"number\"\r\n                                                    min=\"0\"\r\n                                                    max=\"100\"\r\n                                                    step=\"1\"\r\n                                                    value={layer.filters[key]}\r\n                                                    onChange={(e) => changeFilter(index, key, e.target.value)}\r\n                                                />%</div></div>}\r\n                                            {FILTER_LIST.find((filter) => filter[0] === key)[1] === \"angle\" &&\r\n                                                <div><div><input\r\n                                                    type=\"number\"\r\n                                                    min=\"0\"\r\n                                                    max=\"359\"\r\n                                                    step=\"1\"\r\n                                                    value={layer.filters[key]}\r\n                                                    onChange={(e) => changeFilter(index, key, e.target.value)}\r\n                                                /></div></div>}\r\n                                            {FILTER_LIST.find((filter) => filter[0] === key)[1] === \"shadow\" &&\r\n                                                <div>\r\n                                                    <div>\r\n                                                        Offset X\r\n                                                        <input\r\n                                                            type=\"number\"\r\n                                                            step=\"1\"\r\n                                                            value={layer.filters[key][0]}\r\n                                                            onChange={(e) => changeFilter(index, key, e.target.value, 0)}\r\n                                                        />px</div>\r\n                                                    <div>\r\n                                                        Offset Y\r\n                                                        <input\r\n                                                            type=\"number\"\r\n                                                            step=\"1\"\r\n                                                            value={layer.filters[key][1]}\r\n                                                            onChange={(e) => changeFilter(index, key, e.target.value, 1)}\r\n                                                        />px\r\n                                                    </div>\r\n                                                    <div>Blur:<input\r\n                                                        type=\"number\"\r\n                                                        min=\"0\"\r\n                                                        step=\"1\"\r\n                                                        value={layer.filters[key][2]}\r\n                                                        onChange={(e) => changeFilter(index, key, e.target.value, 2)}\r\n                                                    />px</div>\r\n                                                    <div>Color:\r\n                                                        <ColorPicker\r\n                                                            color={layer.filters[key][3]}\r\n                                                            setColor={(color) => changeFilter(index, key, color, 3)}\r\n                                                            useAlpha={true}\r\n                                                        /></div>\r\n                                                </div>}\r\n                                            <button\r\n                                                title=\"Delete Filter\"\r\n                                                aria-label=\"Delete Filter\"\r\n                                                onClick={() => removeFilter(index, key)}\r\n                                            >\r\n                                                <IoClose />\r\n                                            </button>\r\n                                        </div>\r\n                                    })}\r\n                                </div>\r\n                            </div>\r\n                            {index === 0 && <hr style={{ display: dropTargetIndex === index ? \"block\" : \"none\" }} />}\r\n                        </Fragment>)\r\n                })\r\n                }\r\n                {dropTargetIndex === layers.length && <hr />}\r\n                <button onClick={() => { createNewLayer() }}>\r\n                    New Layer\r\n                </button>\r\n            </div>\r\n        </>);\r\n};","import { useState, useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { GoTriangleLeft, GoTriangleRight } from \"react-icons/go\";\r\nimport LayersWindow from \"./LayersWindow.jsx\";\r\n\r\nexport default function ContentBar({ action, setAction, contextMenu, appMenu, setAppMenu }) {\r\n    const context = useContext(Context);\r\n    const [open, setOpen] = useState(false);\r\n    const [selected, setSelected] = useState(\"Layers\");\r\n\r\n    const handleContextMenu = (event) => {\r\n        event.preventDefault();\r\n        let content = { \"Hide\": { action:()=>setAction(\"contentBar\")} };\r\n        contextMenu.setOpen();\r\n        contextMenu.setPosition(event.clientX, event.clientY);\r\n        contextMenu.setContent(content);\r\n    };\r\n\r\n    if (context.view.contentBar) {\r\n        return (\r\n            <div id=\"drawDocContentBar\" onContextMenu={(event) => handleContextMenu(event)}>\r\n                <nav>\r\n                    <button onClick={() => setOpen(!open)}>{open ? <GoTriangleRight /> : <GoTriangleLeft />}</button>\r\n                    <ul>\r\n                        <li onClick={() => { setSelected(\"Layers\"); setOpen(true); }} style={{ textDecoration: selected === \"Layers\" ? \"underline\" : \"none\" }}>Layers</li>\r\n                    </ul>\r\n                </nav>\r\n                <div style={{ width: open ? \"auto\" : \"0\" }}>\r\n                    <LayersWindow action={action} setAction={setAction} contextMenu={contextMenu} appMenu={appMenu} setAppMenu={setAppMenu} />\r\n                </div>\r\n            </div>)\r\n    }\r\n}","import { useContext } from \"react\"\r\nimport { Context } from \"../Context.jsx\"\r\n\r\nexport default function CarryCanvas() {\r\n    const context = useContext(Context);\r\n    const tool = context.tool;\r\n    const clipboard = context.clipboard;\r\n    const cursor = context.cursor;\r\n    const zoom = context.zoom;\r\n    const currLayer = context.currLayer;\r\n    const layers = context.layers;\r\n        return (\r\n            <canvas \r\n            id=\"carryCanvas\" \r\n            height={clipboard.data.height}\r\n            width={clipboard.data.width}\r\n            style={{ \r\n                display:\"none\", \r\n                position: \"absolute\",\r\n                zIndex: currLayer, \r\n                top: cursor.end.y + \"px\", \r\n                left: cursor.end.x + \"px\"\r\n            }} />\r\n        )\r\n    \r\n}","import { useRef, useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\n\r\nexport default function CanvasInterface({ setAction, contextMenu }){\r\n    const context = useContext(Context);\r\n    const interfaceRef = useRef(null);\r\n    const cursor = context.cursor;\r\n    const setCursor = context.setCursor;\r\n    const tool = context.tool;\r\n    const subTool = context.subTool;\r\n    const curveControls = context.curveControls;\r\n    const setCurveControls = context.setCurveControls;\r\n    const size = context.size;\r\n    const selectedColor = context.color.selected;\r\n    const color1 = context.color[1];\r\n    const setColor1 = (v) => context.setColor({ ...context.color, 1: v });\r\n    const color2 = context.color[2];\r\n    const setColor2 = (v) => context.setColor({ ...context.color, 2: v });\r\n    const text = context.text;\r\n    const setText = context.setText;\r\n    const clipboard = context.clipboard;\r\n    const setClipboard = context.setClipboard;\r\n    const layers = context.layers;\r\n    const currLayer = context.currLayer;\r\n    const params = {\r\n        tool,\r\n        subTool,\r\n        curveControls,\r\n        setCurveControls,\r\n        size,\r\n        selectedColor,\r\n        color1,\r\n        setColor1,\r\n        color2,\r\n        setColor2,\r\n        text,\r\n        setText,\r\n        clipboard,\r\n        setClipboard,\r\n    };\r\n\r\n    const getCorrectedPosition = (x, y) => {\r\n        let canvas = interfaceRef.current;\r\n        let ctx = canvas.getContext('2d', { alpha: true });\r\n        let boundary = canvas.getBoundingClientRect();\r\n        const scaleX = (ctx.canvas.width / boundary.width);\r\n        const scaleY = (ctx.canvas.height / boundary.height);\r\n        const newX = (x - boundary.left) * scaleX;\r\n        const newY = (y - boundary.top) * scaleY;\r\n        return { x: newX, y: newY };\r\n    };\r\n\r\n    const handleCursor = (e) => {\r\n        const pos = getCorrectedPosition(e.clientX, e.clientY);\r\n        if (e.button === 0) {\r\n            switch (e.type) {\r\n                case \"mousedown\":\r\n                    if (cursor.down) {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y },\r\n                            end: { x: pos.x, y: pos.y },\r\n                        });\r\n                    } else {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            down: true,\r\n                            start: { x: pos.x, y: pos.y },\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"mouseup\":\r\n                    setCursor({\r\n                        ...cursor,\r\n                        end: { x: pos.x, y: pos.y },\r\n                        down: false\r\n                    });\r\n                    break;\r\n                case \"mousemove\":\r\n                     if (!cursor.down) {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y }\r\n                        });\r\n                    } else {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y },\r\n                            end: { x: pos.x, y: pos.y },\r\n                        })\r\n                    }\r\n                    break;\r\n                case \"mouseleave\":\r\n                    setCursor({\r\n                        ...cursor,\r\n                        current: { x: pos.x, y: pos.y },\r\n                    });\r\n                    break;\r\n                case \"mouseenter\":\r\n                    if (e.buttons !== 0) {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            down: true,\r\n                            current: { x: pos.x, y: pos.y },\r\n                            end: { x: pos.x, y: pos.y },\r\n                        });\r\n                    }\r\n                    else {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            down: false,\r\n                            current: { x: pos.x, y: pos.y },\r\n                        })\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleTouch = (e) => {\r\n        e.preventDefault();\r\n        const pos = getCorrectedPosition(e.touches[0].clientX, e.touches[0].clientY);\r\n        if (e.touches.length === 1) {\r\n            switch (e.type) {\r\n                case \"touchstart\":\r\n                    if (cursor.down) {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y },\r\n                            end: { x: pos.x, y: pos.y },\r\n                        });\r\n                    } else {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            down: true,\r\n                            start: { x: pos.x, y: pos.y }\r\n                        });\r\n                    }\r\n                    break;\r\n                case \"touchend\":\r\n                    setCursor({\r\n                        ...cursor,\r\n                        end: { x: pos.x, y: pos.y },\r\n                        down: false\r\n                    });\r\n                    break;\r\n                case \"touchmove\":\r\n                    if (!cursor.down) {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y }\r\n                        });\r\n                    }\r\n                    else {\r\n                        setCursor({\r\n                            ...cursor,\r\n                            current: { x: pos.x, y: pos.y },\r\n                            end: { x: pos.x, y: pos.y },\r\n                        })\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            };\r\n        } else {\r\n            setCursor({\r\n                ...cursor,\r\n                current: { x: 0, y: 0 },\r\n                end: { x: pos.x, y: pos.y },\r\n                down: false\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleContextMenu = (event) => {\r\n        event.preventDefault();\r\n        let content = {\r\n            \"Undo\": { action: () => setAction(\"Undo\"), disabled: !context.history.canUndo || layers[currLayer].locked },\r\n            \"Redo\": { action: () => setAction(\"Redo\"), disabled: !context.history.canRedo || layers[currLayer].locked },\r\n            \"LineBreak\": {},\r\n            \"Zoom In\": { action: () => setAction(\"Zoom In\"), disabled: context.zoom === 4 },\r\n            \"Zoom Out\": { action: () => setAction(\"Zoom Out\"), disabled: context.zoom === 0.25 },\r\n            \"Zoom Reset\": { action: () => setAction(\"Zoom Reset\"), disabled: context.zoom === 1 },\r\n        };\r\n        contextMenu.setOpen();\r\n        contextMenu.setPosition(event.clientX, event.clientY);\r\n        contextMenu.setContent(content);\r\n    };\r\n    return (\r\n        <canvas\r\n            ref={interfaceRef}\r\n            style={{ \r\n                position: \"absolute\",\r\n                top: 0,\r\n                left: 0,\r\n                color: params.selectedColor,\r\n                zIndex: layers.length+2\r\n            }}\r\n            className={layers[currLayer].locked ? \"cursorLocked\" : (\"cursor\" + params.tool)}\r\n            id=\"interfaceCanvas\"\r\n            height={context.dimentions.height}\r\n            width={context.dimentions.width}\r\n            onMouseDown={(e) => { if (!cursor.selecting) handleCursor(e) }}\r\n            onMouseUp={(e) => { if (!cursor.selecting) handleCursor(e) }}\r\n            onMouseMove={(e) => { if (!cursor.selecting) handleCursor(e) }}\r\n            onMouseLeave={(e) => { if (!cursor.selecting) handleCursor(e) }}\r\n            onMouseEnter={(e) => { if (!cursor.selecting) handleCursor(e) }}\r\n            onTouchStart={(e) => { if (!cursor.selecting) handleTouch(e) }}\r\n            onTouchEnd={(e) => { if (!cursor.selecting) handleTouch(e) }}\r\n            onTouchMove={(e) => { if (!cursor.selecting) handleTouch(e) }}\r\n            onTouchCancel={(e) => { if (!cursor.selecting) handleTouch(e) }}\r\n            onContextMenu={(e) => { if (!cursor.selecting) handleContextMenu(e) }}\r\n        />\r\n    );\r\n\r\n}","import { useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { BiUndo, BiRedo } from \"react-icons/bi\";\r\nimport { TfiSave, TfiFile } from \"react-icons/tfi\";\r\nimport { FaImage } from \"react-icons/fa\";\r\nimport { CiLineHeight } from \"react-icons/ci\";\r\nimport { AiOutlineColumnHeight } from \"react-icons/ai\";\r\nimport { RiFontSize, RiShapesLine } from \"react-icons/ri\";\r\nimport { BiShapePolygon } from \"react-icons/bi\";\r\n\r\nimport ColorPicker from \"../../../System/GlobalComponents/ColorPicker/ColorPicker.jsx\";\r\n\r\nexport const TopNavBar = ({ setAction, contextMenu }) => {\r\n  const context = useContext(Context);\r\n\r\n  const handleZoom = (e) => {\r\n    context.setZoom(Number(e.target.value));\r\n    if (e.target.value === \"0.25\") {\r\n      setAction(\"Zoom Min\");\r\n    } else if (e.target.value === \"4\") {\r\n      setAction(\"Zoom Max\");\r\n    }\r\n    else if (e.target.value === \"1\") {\r\n      setAction(\"Zoom Default\");\r\n    }\r\n    else {\r\n      setAction(\"Zoom Change\");\r\n    }\r\n  }\r\n\r\n  const handleContextMenu = (event) => {\r\n    event.preventDefault();\r\n    let content = { \"Hide\": { action: () => setAction(\"topNavBar\") } };\r\n    contextMenu.setOpen();\r\n    contextMenu.setPosition(event.clientX, event.clientY);\r\n    contextMenu.setContent(content);\r\n  };\r\n\r\n  if (context.view.topNavBar) {\r\n    return (\r\n      <nav id=\"drawDocTopNavBar\" onContextMenu={(event) => handleContextMenu(event)}>\r\n        <button title=\"Undo\" onClick={() => setAction(\"Undo\")} disabled={!context.layers[context.currLayer].canUndo || context.layers[context.currLayer].locked}>\r\n          <BiUndo />\r\n        </button>\r\n        <button title=\"Redo\" onClick={() => setAction(\"Redo\")} disabled={!context.layers[context.currLayer].canRedo || context.layers[context.currLayer].locked}>\r\n          <BiRedo />\r\n        </button>\r\n        <vertical-rect ></vertical-rect>\r\n        <button title=\"New File\" onClick={() => setAction(\"New\")}>\r\n          <TfiFile />\r\n        </button>\r\n        <button title=\"Download File\" onClick={() => setAction(\"Save\")}>\r\n          <TfiSave />\r\n        </button>\r\n        <vertical-rect ></vertical-rect>\r\n        <button title=\"Upload Image\" onClick={() => setAction(\"Image\")} disabled={context.layers[context.currLayer].locked}>\r\n          <FaImage />\r\n        </button>\r\n        <vertical-rect ></vertical-rect>\r\n        <div style={{ display: \"flex\" }}>\r\n          <button title=\"Color 1\" className={context.color.selected === context.color[1] ? \"buttonActive\" : \"\"}\r\n            onClick={() => context.setColor({ ...context.color, selected: context.color[1] })}>\r\n            <label htmlFor=\"drawColor1\" style={{ textDecoration: context.color.selected === context.color[1] ? \"underline\" : \"\" }} onClick={(e) => e.preventDefault()}>1</label>\r\n          </button>\r\n          <ColorPicker\r\n            color={context.color[1]}\r\n            setColor={(color) => { context.setColor({ ...context.color, selected: color, 1: color }) }}\r\n            useAlpha={true}\r\n          />\r\n        </div>\r\n        <vertical-rect ></vertical-rect>\r\n        <div style={{ display: \"flex\" }}>\r\n          <button title=\"Color 2\" className={context.color.selected === context.color[2] ? \"buttonActive\" : \"\"}\r\n            onClick={() => context.setColor({ ...context.color, selected: context.color[2] })}>\r\n            <label htmlFor=\"drawColor2\" style={{ textDecoration: context.color.selected === context.color[2] ? \"underline\" : \"\" }} onClick={(e) => e.preventDefault()}>2</label>\r\n          </button>\r\n          <ColorPicker\r\n            color={context.color[2]}\r\n            setColor={(color) => context.setColor({ ...context.color, selected: color, 2: color })}\r\n            useAlpha={true}\r\n          />\r\n        </div>\r\n        <vertical-rect ></vertical-rect>\r\n        {context.tool === \"Magnifier\" &&\r\n          <select\r\n            value={context.zoom}\r\n            onChange={(e) => { handleZoom(e) }}\r\n            title=\"Zoom\"\r\n          >\r\n            <option value={0.25}>25%</option>\r\n            <option value={0.5}>50%</option>\r\n            <option value={0.75}>75%</option>\r\n            <option value={1}>100%</option>\r\n            <option value={2}>200%</option>\r\n            <option value={3}>300%</option>\r\n            <option value={4}>400%</option>\r\n          </select>}\r\n        {context.tool !== \"Select\" && context.tool !== \"Pipette\" && context.tool !== \"Magnifier\" && context.tool !== \"Bucket\" &&\r\n          <>\r\n            <AiOutlineColumnHeight />\r\n            <input\r\n              type=\"number\"\r\n              min=\"1\"\r\n              max=\"100\"\r\n              value={context.size}\r\n              onChange={(e) => context.setSize(Number(e.target.value))}\r\n              title={context.tool === \"Text\" ? \"Font Size\" : context.tool === \"Shape\" ? \"Line Width\" : \"Radius\"}\r\n            />\r\n          </>\r\n        }\r\n        {context.tool === \"Text\" &&\r\n          <>\r\n            <vertical-rect ></vertical-rect>\r\n            <RiFontSize />\r\n            <select\r\n              title=\"Font Family\"\r\n              value={context.text.fontFamily}\r\n              onChange={(e) => context.setText({ ...context.text, fontFamily: e.target.value })}\r\n            >\r\n              <option>Arial</option>\r\n              <option>Times New Roman</option>\r\n              <option>Monospace</option>\r\n              <option>Verdana</option>\r\n              <option>Georgia</option>\r\n              <option>Courier New</option>\r\n              <option>Tahoma</option>\r\n              <option>Garamond</option>\r\n              <option>Impact</option>\r\n              <option>Comic Sans MS</option>\r\n              <option>Lucida Console</option>\r\n              <option>Lucida Sans Unicode</option>\r\n              <option>Palatino Linotype</option>\r\n              <option>Symbol</option>\r\n              <option>Wingdings</option>\r\n              <option>Helvetica</option>\r\n            </select>\r\n            <vertical-rect ></vertical-rect>\r\n            <CiLineHeight />\r\n            <input\r\n              title=\"Line Height\"\r\n              type=\"number\"\r\n              step=\"0.01\"\r\n              min=\"0\"\r\n              value={context.text.lineHeight}\r\n              onChange={(e) => { context.setText({ ...context.text, lineHeight: e.target.value }) }}\r\n            />\r\n            <vertical-rect ></vertical-rect>\r\n          </>\r\n        }\r\n        {context.tool === \"Shape\" &&\r\n          <>\r\n            <vertical-rect ></vertical-rect>\r\n            <RiShapesLine />\r\n            <select\r\n              title=\"Shape\"\r\n              value={context.subTool.shape}\r\n              onChange={(e) => context.setSubTool({ ...context.subTool, shape: e.target.value })}\r\n            >\r\n              <option>Line</option>\r\n              <option>Curve</option>\r\n              <option>Circle</option>\r\n              <option>Rectangle</option>\r\n              <option>Squagle</option>\r\n              <option>Polygon</option>\r\n              <option>Star</option>\r\n              <option>Arrow</option>\r\n              <option>Heart</option>\r\n            </select>\r\n            <vertical-rect ></vertical-rect>\r\n            {(context.subTool.shape === \"Polygon\" || context.subTool.shape === \"Star\") &&\r\n              <>\r\n                <BiShapePolygon />\r\n                <input\r\n                  type=\"number\"\r\n                  title=\"Sides\"\r\n                  value={context.subTool.sides}\r\n                  onChange={(e) => context.setSubTool({ ...context.subTool, sides: e.target.value })}\r\n                  min=\"3\"\r\n                  step=\"1\" />\r\n                <vertical-rect ></vertical-rect>\r\n              </>\r\n            }\r\n          </>}\r\n      </nav>\r\n    )\r\n  }\r\n}\r\n","import { useRef, useEffect } from \"react\";\r\n\r\nexport const SubToolIcon = ({ subtool, isSelected }) => {\r\n    let canvasSubToolRef = useRef(null);\r\n\r\n    const drawCircleIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.arc(\r\n            width / 2,\r\n            height / 2,\r\n            (height / 2) - 2,\r\n            0,\r\n            Math.PI * 2,\r\n        );\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n        context.stroke();\r\n        context.closePath();\r\n    };\r\n    const drawEllipseIcon = (context, width, height) => {\r\n        context.scale(1,0.5);\r\n        context.beginPath();\r\n        context.beginPath();\r\n        context.arc(\r\n            width / 2,\r\n            height,\r\n            (height / 2) - 2,\r\n            0,\r\n            Math.PI * 2,\r\n        );\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n        context.stroke();\r\n        context.closePath();\r\n        context.scale(1,2);\r\n    }\r\n    const drawRectangleIcon = (context, width, height) => {\r\n        if (subtool.fill) {\r\n            context.fillRect(0, height / 4, width, height / 2);\r\n        }\r\n        context.strokeRect(0, height / 4, width, height / 2);\r\n\r\n    };\r\n\r\n    const drawSquagleIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.roundRect(0, height / 4, width, height / 2, 10);\r\n        context.stroke();\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n    };\r\n\r\n    const drawPolygonIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        //context.moveTo(width/2, 0);\r\n        for (let i = 0; i < subtool.sides; i++) {\r\n            context.lineTo(\r\n                width / 2 + (width / 2 - 3) * Math.cos((2 * Math.PI * i / subtool.sides) - Math.PI / 2),\r\n                height / 2 + (height / 2 - 3) * Math.sin((2 * Math.PI * i / subtool.sides) - Math.PI / 2)\r\n            );\r\n        };\r\n        context.closePath();\r\n        context.stroke();\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n    }\r\n    const drawLineIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.moveTo(width / 4, 2);\r\n        context.lineTo(3 * width / 4, height - 2);\r\n        context.closePath();\r\n        context.stroke();\r\n    }\r\n    const drawCurveIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.moveTo(width / 6, 2);\r\n        context.bezierCurveTo(5 * width / 6, height / 5, width / 6, 4 * height / 5 - 2, 5 * width / 6, height - 2);\r\n        context.stroke();\r\n    }\r\n    const drawArrowIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.moveTo(2, height / 3);\r\n        context.lineTo(width / 2, height / 3);\r\n        context.lineTo(width / 2, 2);\r\n        context.lineTo(width - 2, height / 2);\r\n        context.lineTo(width / 2, height - 2);\r\n        context.lineTo(width / 2, 2 * height / 3);\r\n        context.lineTo(2, 2 * height / 3);\r\n        context.closePath();\r\n        context.stroke();\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n    }\r\n    const drawStarIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.moveTo(width / 2, 3);\r\n        for (let i = 0; i < subtool.sides * 2; i++) {\r\n            if (i % 2 === 0) {\r\n                context.lineTo(\r\n                    width / 2 + (width / 2 - 3) * Math.cos((2 * Math.PI * i / (subtool.sides * 2)) - Math.PI / 2),\r\n                    height / 2 + (height / 2 - 3) * Math.sin((2 * Math.PI * i / (subtool.sides * 2)) - Math.PI / 2)\r\n                );\r\n            } else {\r\n                context.lineTo(\r\n                    width / 2 + (width / 4 - 3) * Math.cos((2 * Math.PI * i / (subtool.sides * 2)) - Math.PI / 2),\r\n                    height / 2 + (height / 4 - 3) * Math.sin((2 * Math.PI * i / (subtool.sides * 2)) - Math.PI / 2)\r\n                );\r\n            }\r\n        };\r\n        context.closePath();\r\n        context.stroke();\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n    }\r\n    const drawHeartIcon = (context, width, height) => {\r\n        context.beginPath();\r\n        context.moveTo(width / 2, height-3);\r\n        //context.lineTo(width / 4, 2*height/3);\r\n        context.arc(width/4+1, height/3, width/4-1, 3*Math.PI/4, 0, false);\r\n        context.arc(3*width/4-1, height/3, width/4-1, Math.PI, Math.PI/4, false);\r\n        context.closePath();\r\n        context.stroke();\r\n        if (subtool.fill) {\r\n            context.fill();\r\n        }\r\n\r\n    }\r\n\r\n    const functionList = {\r\n        drawCircleIcon,\r\n        drawEllipseIcon,\r\n        drawRectangleIcon,\r\n        drawSquagleIcon,\r\n        drawPolygonIcon,\r\n        drawLineIcon,\r\n        drawCurveIcon,\r\n        drawStarIcon,\r\n        drawArrowIcon,\r\n        drawHeartIcon\r\n    };\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasSubToolRef.current;\r\n        const context = canvas.getContext(\"2d\");\r\n        const height = context.canvas.height;\r\n        const width = context.canvas.width;\r\n        context.clearRect(0, 0, width, height);\r\n        context.fillStyle = getComputedStyle(document.getElementById(\"drawDocToolBar\")).color;\r\n        context.strokeStyle = getComputedStyle(document.getElementById(\"drawDocToolBar\")).color;\r\n        context.lineWidth = 2;\r\n        functionList[\"draw\"+subtool.shape+\"Icon\"](context, width, height);\r\n    }, [subtool, isSelected]);\r\n\r\n\r\n    return <canvas ref={canvasSubToolRef} id=\"shapeCanvas\" width=\"25\" height=\"25\"  title=\"Custom Shape\"/>\r\n}","import { useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nimport { SubToolIcon } from \"./SubToolIcon.jsx\";\r\nimport { GiPaintBrush } from \"react-icons/gi\";\r\nimport {\r\n    TfiSpray,\r\n    TfiPaintBucket,\r\n    TfiEraser,\r\n} from \"react-icons/tfi\";\r\nimport { CgColorPicker } from \"react-icons/cg\";\r\nimport { RxLetterCaseCapitalize } from \"react-icons/rx\";\r\nimport { HiOutlineMagnifyingGlass } from \"react-icons/hi2\";\r\nimport { LuBoxSelect } from \"react-icons/lu\";\r\n\r\nexport const ToolBar = ({ setAction, contextMenu, isSelected }) => {\r\n    const context = useContext(Context);\r\n    const tool = context.tool;\r\n    const subTool = context.subTool;\r\n    const setTool = context.setTool;\r\n    const toolComponents = {\r\n        Brush: <GiPaintBrush title=\"Brush\" />,\r\n        Eraser: <TfiEraser title=\"Eraser\" />,\r\n        Bucket: <TfiPaintBucket title=\"Bucket\" />,\r\n        Spray: <TfiSpray title=\"Spray Can\" />,\r\n        Text: <RxLetterCaseCapitalize title=\"Insert Text\" />,\r\n        Pipette: <CgColorPicker title=\"Color Picker\" />,\r\n        Magnifier: <HiOutlineMagnifyingGlass title=\"Zoom\" />,\r\n        Select: <LuBoxSelect title=\"Selection\" />,\r\n        Shape: <SubToolIcon subtool={subTool} isSelected={isSelected}/>,\r\n    };\r\n    const handleContextMenu = (event) => {\r\n        event.preventDefault();\r\n        let content = { \"Hide\": { action:()=>setAction(\"toolBar\")} };\r\n        contextMenu.setOpen();\r\n        contextMenu.setPosition(event.clientX, event.clientY);\r\n        contextMenu.setContent(content);\r\n    };\r\n    if (context.view.toolBar) {\r\n        return (\r\n            <nav id=\"drawDocToolBar\" onContextMenu={(event) => handleContextMenu(event)}>\r\n                {Object.keys(toolComponents).map((name) => (\r\n                    <button\r\n                        key={name + \"drawToolDropdown\"}\r\n                        onClick={() => setTool(name)}\r\n                        className={tool === name ? \"buttonActive\" : \"\"}\r\n                    >\r\n                        {toolComponents[name]}\r\n                    </button>\r\n                ))}\r\n            </nav>\r\n        )\r\n    }\r\n}","import { useContext } from \"react\";\r\nimport { Context } from \"../Context.jsx\";\r\nexport const BottomNavBar = ({ action, setAction, contextMenu }) => {\r\n  const context = useContext(Context);\r\n  const handleContextMenu = (event) => {\r\n    event.preventDefault();\r\n    let content = { \"Hide\": { action: () => setAction(\"bottomNavBar\") }, }\r\n    contextMenu.setOpen();\r\n    contextMenu.setPosition(event.clientX, event.clientY);\r\n    contextMenu.setContent(content);\r\n  };\r\n  if (context.view.bottomNavBar) {\r\n    return (\r\n      <nav id=\"drawDocBottomNavBar\" onContextMenu={(event) => handleContextMenu(event)}>\r\n        {context.tool === \"Text\" &&\r\n          <>\r\n            <button\r\n              title=\"Confirm Text\"\r\n              onClick={() => setAction(\"confirm\")}\r\n              disabled={context.layers[context.currLayer].locked}\r\n            ><small>Confirm</small>\r\n            </button>\r\n            <vertical-rect ></vertical-rect>\r\n            <button\r\n              title=\"Use Fill\"\r\n              className={context.text.fill ? \"buttonActive\" : \"\"}\r\n              onClick={() => { context.setText({ ...context.text, fill: !context.text.fill }) }}\r\n            >\r\n              <small>Fill</small>\r\n            </button>\r\n            <vertical-rect ></vertical-rect>\r\n            <button\r\n              title=\"Use Stroke\"\r\n              className={context.text.stroke ? \"buttonActive\" : \"\"}\r\n              onClick={() => { context.setText({ ...context.text, stroke: !context.text.stroke }) }}\r\n            >\r\n              <small>Stroke</small>\r\n            </button>\r\n            <input\r\n              title=\"Stroke Width\"\r\n              type=\"number\"\r\n              step=\"1\"\r\n              min=\"1\"\r\n              max={context.size - 1}\r\n              value={context.text.strokeWidth}\r\n              onChange={(e) => { context.setText({ ...context.text, strokeWidth: e.target.value }) }}\r\n            />\r\n            <vertical-rect ></vertical-rect>\r\n          </>}\r\n        {context.tool === \"Select\" ?\r\n          <>{action === \"clipping\" && context.clipboard.state === \"carry\" ?\r\n            <button\r\n              title=\"Paste\"\r\n              onClick={() => { setAction(\"confirm\"); context.setClipboard({ ...context.clipboard, state: \"paste\" }) }}\r\n              disabled={context.layers[context.currLayer].locked}\r\n            ><small>Paste</small></button>\r\n            :\r\n            <>\r\n              <button\r\n                title=\"Cut\"\r\n                onClick={() => { setAction(\"clipping\"); context.setClipboard({ ...context.clipboard, state: \"cut\" }) }}\r\n              ><small>Cut</small></button>\r\n              <vertical-rect ></vertical-rect>\r\n              <button\r\n                title=\"Copy\"\r\n                onClick={() => { setAction(\"clipping\"); context.setClipboard({ ...context.clipboard, state: \"copy\" }) }}\r\n              ><small>Copy</small></button>\r\n            </>\r\n          }</>\r\n          : null}\r\n        {context.tool === \"Shape\" ?\r\n          <>\r\n            <button\r\n              title=\"Confirm Shape\"\r\n              onClick={() => setAction(\"confirm\")}\r\n              disabled={context.layers[context.currLayer].locked}\r\n            ><small>Confirm</small></button>\r\n            <vertical-rect ></vertical-rect>\r\n            {context.subTool.shape === \"Curve\" &&\r\n              <>\r\n                <button\r\n                  title=\"Cancel Shape\"\r\n                  onClick={() => setAction(\"cancel\")}\r\n                ><small>Cancel</small>\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n              </>\r\n            }\r\n            {context.subTool.shape !== \"Line\" && context.subTool.shape !== \"Curve\" ?\r\n              <>\r\n                <button\r\n                  title=\"Fill\"\r\n                  className={context.subTool.fill ? \"buttonActive\" : \"\"}\r\n                  onClick={() => context.setSubTool({ ...context.subTool, fill: !context.subTool.fill })}\r\n                ><small>Fill</small></button>\r\n                <vertical-rect ></vertical-rect>\r\n                {context.subTool.shape !== \"Rectangle\" && context.subTool.shape !== \"Squagle\" &&\r\n                  <><button\r\n                    title=\"Stretch\"\r\n                    className={context.subTool.stretch ? \"buttonActive\" : \"\"}\r\n                    onClick={() => context.setSubTool({ ...context.subTool, stretch: !context.subTool.stretch })}\r\n                  ><small>Stretch</small>\r\n                  </button>\r\n                    <vertical-rect ></vertical-rect></>}\r\n                <button>\r\n                  <label htmlFor=\"rotationAngle\">Rotation</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    title=\"Rotation Angle\"\r\n                    id=\"rotationAngle\"\r\n                    value={context.subTool.angle}\r\n                    onChange={(e) => context.setSubTool({ ...context.subTool, angle: e.target.value })}\r\n                    step=\"1\" />\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n                {context.subTool.shape === \"Polygon\" || context.subTool.shape === \"Star\" ?\r\n                  <>\r\n                    <button>\r\n                      <label htmlFor=\"startAngle\">Start Angle</label>\r\n                      <input\r\n                        type=\"number\"\r\n                        title=\"Start Angle\"\r\n                        id=\"startAngle\"\r\n                        value={context.subTool.startAngle}\r\n                        onChange={(e) => context.setSubTool({ ...context.subTool, startAngle: e.target.value })}\r\n                        step=\"1\" />\r\n                    </button>\r\n                    <vertical-rect ></vertical-rect>\r\n                  </> : null}\r\n              </>\r\n              : null}\r\n            {context.subTool.shape === \"Line\" && context.subTool.shape === \"Curve\" &&\r\n              <>\r\n                <button>\r\n                  <label htmlFor=\"lineCap\">Cap</label>\r\n                  <select\r\n                    id=\"lineCap\"\r\n                    value={context.subTool.lineCap}\r\n                    onChange={(e) => context.setSubTool({ ...context.subTool, lineCap: e.target.value })}>\r\n                    <option value=\"butt\">Butt</option>\r\n                    <option value=\"round\">Round</option>\r\n                    <option value=\"square\">Square</option>\r\n                  </select>\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n              </>}\r\n            {context.subTool.shape !== \"Line\" && context.subTool.shape !== \"Curve\" && context.subTool.shape !== \"Squagle\" && context.subTool.shape !== \"Rectangle\" &&\r\n              <><button>\r\n                <label htmlFor=\"lineJoin\">Joints</label>\r\n                <select\r\n                  id=\"lineJoin\"\r\n                  value={context.subTool.lineJoin}\r\n                  onChange={(e) => context.setSubTool({ ...context.subTool, lineJoin: e.target.value })}>\r\n                  <option value=\"miter\">Miter</option>\r\n                  <option value=\"round\">Round</option>\r\n                  <option value=\"bevel\">Bevel</option>\r\n                </select>\r\n              </button>\r\n                <vertical-rect ></vertical-rect>\r\n              </>}\r\n            {context.subTool.shape === \"Squagle\" &&\r\n              <><button>\r\n                <label htmlFor=\"topleft\">Top Left</label>\r\n                <input\r\n                  id=\"topleft\"\r\n                  type=\"number\"\r\n                  step=\"1\"\r\n                  min=\"0\"\r\n                  value={context.subTool.radii[0]}\r\n                  onChange={(e) => context.setSubTool({ ...context.subTool, radii: [e.target.value, ...context.subTool.radii.slice(1)] })}\r\n                />\r\n              </button>\r\n                <vertical-rect ></vertical-rect>\r\n                <button>\r\n                  <label htmlFor=\"topright\">Top Right</label>\r\n                  <input\r\n                    id=\"topright\"\r\n                    type=\"number\"\r\n                    step=\"1\"\r\n                    min=\"0\"\r\n                    value={context.subTool.radii[1]}\r\n                    onChange={(e) => context.setSubTool({ ...context.subTool, radii: [...context.subTool.radii.slice(0, 1), e.target.value, ...context.subTool.radii.slice(2)] })}\r\n                  />\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n                <button>\r\n                  <label htmlFor=\"bottomright\">Bottom Right</label>\r\n                  <input\r\n                    id=\"bottomright\"\r\n                    type=\"number\"\r\n                    step=\"1\"\r\n                    min=\"0\"\r\n                    value={context.subTool.radii[2]}\r\n                    onChange={(e) => context.setSubTool({ ...context.subTool, radii: [...context.subTool.radii.slice(0, 2), e.target.value, context.subTool.radii[3]] })}\r\n                  />\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n                <button>\r\n                  <label htmlFor=\"bottomleft\">Bottom Left</label>\r\n                  <input\r\n                    id=\"bottomleft\"\r\n                    type=\"number\"\r\n                    step=\"1\"\r\n                    min=\"0\"\r\n                    value={context.subTool.radii[3]}\r\n                    onChange={(e) => context.setSubTool({ ...context.subTool, radii: [...context.subTool.radii.slice(0, 3), e.target.value] })}\r\n                  />\r\n                </button>\r\n                <vertical-rect ></vertical-rect>\r\n              </>}\r\n          </> : null}\r\n      </nav>\r\n    )\r\n  }\r\n}","// Paint.exe style editor in javascript, makes use of two overlapping canvas elements\r\nimport { useContext } from \"react\";\r\n\r\nimport Provider from \"./Context.jsx\";\r\nimport { Context } from \"./Context.jsx\";\r\nimport DrawCanvas from \"./Components/DrawCanvas.jsx\";\r\nimport PreviewCanvas from \"./Components/PreviewCanvas.jsx\";\r\nimport SelectionCanvas from \"./Components/SelectionCanvas.jsx\";\r\nimport ContentBar from \"./Components/ContentBar.jsx\";\r\nimport CarryCanvas from \"./Components/CarryCanvas.jsx\";\r\nimport CanvasInterface from \"./Components/CanvasInterface.jsx\";\r\n\r\nimport { TopNavBar } from \"./Components/TopNavBar.jsx\";\r\nimport { ToolBar } from \"./Components/ToolBar.jsx\";\r\nimport { BottomNavBar } from \"./Components/BottomNavBar.jsx\";\r\n\r\nimport \"./style.css\";\r\nexport default function DrawDoc(props) {\r\n\r\n  const action = props.action;\r\n  const setAction = props.setAction;\r\n  const appMenu = props.appMenu;\r\n  const setAppMenu = props.setAppMenu;\r\n  const appDialog = props.appDialog;\r\n  const setAppDialog = props.setAppDialog;\r\n  const contextMenu = props.contextMenu;\r\n  const canClose = props.canClose;\r\n  const setCanClose = props.setCanClose;\r\n  const isSelected = props.isSelected;\r\n  const title = props.title;\r\n  const setTitle = props.setTitle;\r\n\r\n  const context = useContext(Context);\r\n\r\n  return (\r\n    <Provider>\r\n      <>\r\n        <TopNavBar\r\n          setAction={setAction}\r\n          contextMenu={contextMenu}\r\n        />\r\n        <div style={{\r\n          display: \"flex\",\r\n          flexDirection: \"row\",\r\n          width: \"100%\",\r\n          height: \"100%\",\r\n          margin: \"0px\"\r\n        }}>\r\n          <ToolBar\r\n            setAction={setAction}\r\n            contextMenu={contextMenu}\r\n            isSelected={isSelected}\r\n          />\r\n          <canvas-container>\r\n            <DrawCanvas\r\n              action={action}\r\n              setAction={setAction}\r\n              appMenu={appMenu}\r\n              setAppMenu={setAppMenu}\r\n              appDialog={appDialog}\r\n              setAppDialog={setAppDialog}\r\n              contextMenu={contextMenu}\r\n              canClose={canClose}\r\n              setCanClose={setCanClose}\r\n              title={title}\r\n              setTitle={setTitle}\r\n            />\r\n            <CarryCanvas />\r\n            <PreviewCanvas />\r\n            <CanvasInterface\r\n              action={action}\r\n              setAction={setAction}\r\n              contextMenu={contextMenu}\r\n            />\r\n            <SelectionCanvas />\r\n          </canvas-container>\r\n          <ContentBar\r\n            action={action}\r\n            setAction={setAction}\r\n            contextMenu={contextMenu}\r\n            appMenu={appMenu}\r\n            setAppMenu={setAppMenu}\r\n          />\r\n        </div>\r\n        <BottomNavBar\r\n          action={action}\r\n          setAction={setAction}\r\n          contextMenu={contextMenu}\r\n        />\r\n      </>\r\n    </Provider>\r\n  );\r\n};","export default function rgbToHsl(rgb) {\r\n    let r = rgb[0],\r\n        g = rgb[1],\r\n        b = rgb[2];\r\n    r /= 255;\r\n    g /= 255;\r\n    b /= 255;\r\n    let cmin = Math.min(r, g, b),\r\n        cmax = Math.max(r, g, b),\r\n        delta = cmax - cmin,\r\n        h = 0,\r\n        s = 0,\r\n        l = ((cmax + cmin) / 2);\r\n    if (delta === 0) {\r\n        s = 0;\r\n        h = 0;\r\n    }else {\r\n        if (l <= 0.5) {\r\n            s = delta / (cmax + cmin);\r\n        } else {\r\n            s = delta / (2 - cmax-cmin);\r\n        };\r\n        if (cmax === r) {\r\n            h = (g - b) / delta;\r\n        } else if (cmax === g) {\r\n            h = ((b - r) / delta) + 2;\r\n        } else if(cmax === b) {\r\n            h = ((r - g) / delta) + 4;\r\n        }\r\n    }\r\n    h = Math.round(h * 60);\r\n    if (h < 0) {\r\n        h += 360;\r\n    }\r\n    s = Math.abs(s * 100).toFixed(0);\r\n    l = (l * 100 ).toFixed(0);\r\n    let hsl = [h, s + '%', l + '%'];\r\n    return hsl;\r\n}","export default function rgbaToHsla(rgba) {\r\n    var r = rgba[0],\r\n        g = rgba[1],\r\n        b = rgba[2],\r\n        a = rgba[3];\r\n        var r = parseInt(rgba[1], 16);\r\n        var g = parseInt(rgba[2], 16);\r\n        var b = parseInt(rgba[3], 16);\r\n        var a = parseInt(rgba[4], 16);\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        let cmin = Math.min(r, g, b),\r\n            cmax = Math.max(r, g, b),\r\n            delta = cmax - cmin,\r\n            h = 0,\r\n            s = 0,\r\n            l = ((cmax + cmin) / 2);\r\n        if (delta === 0) {\r\n            s = 0;\r\n            h = 0;\r\n        }else {\r\n            if (l <= 0.5) {\r\n                s = delta / (cmax + cmin);\r\n            } else {\r\n                s = delta / (2 - cmax-cmin);\r\n            };\r\n            if (cmax === r) {\r\n                h = (g - b) / delta;\r\n            } else if (cmax === g) {\r\n                h = ((b - r) / delta) + 2;\r\n            } else if(cmax === b) {\r\n                h = ((r - g) / delta) + 4;\r\n            }\r\n        }\r\n        h = Math.round(h * 60);\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        s = Math.abs(s * 100).toFixed(0);\r\n        l = (l * 100 ).toFixed(0);\r\n        let hsla = [h, s + '%', l + '%', a];\r\n        return hsla;\r\n    }","/*\r\nCustom color picker to replace default color picker from input[type=\"color\"],\r\nallowing for the use of alpha channel. The color picker is open on click,\r\nand closes on blur. \r\nThe color preview is set on color change, and applied when confirmed, by use \r\nof the callback function setColor, which is passed as props.\r\nThe return value is always in hsl or hsla format.\r\nThe alpha channel is used only if the useAlpha prop is true.\r\n\r\nTODO: \r\nAdd support for gradients,\r\nAdd support for color values RGB, RGBA, hex, and hex with alpha\r\n*/\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport hexToRgb from \"./Converters/hexToRgb\";\r\nimport hexToRgba from \"./Converters/hexToRgba\";\r\nimport rgbToHsl from \"./Converters/rgbToHsl\";\r\nimport rgbaToHsla from \"./Converters/rgbaToHsla\";\r\nimport nameToHsl from \"./Converters/nameToHsl\";\r\nimport \"../styles.css\";\r\n\r\nexport default function ColorPicker({ color, setColor, useAlpha }) {\r\n    const colorPickerRef = useRef(null);\r\n    const hueLumRef = useRef(null);\r\n    const saturationRef = useRef(null);\r\n    const alphaRef = useRef(null);\r\n    const [colorSelectorPos, setColorSelectorPos] = useState({ x: 0, y: 0 });\r\n    const [saturationSliderPos, setSaturationSliderPos] = useState(0);\r\n    const [alphaSliderPos, setAlphaSliderPos] = useState(0);\r\n    const [open, setOpen] = useState(false);\r\n    const [hue, setHue] = useState(0);\r\n    const [lightness, setLightness] = useState(50);\r\n    const [saturation, setSaturation] = useState(100);\r\n    const [alpha, setAlpha] = useState(100);\r\n\r\n    // Focus color picker when open, allowing its closing on blur\r\n    useEffect(() => {\r\n        if (open) {\r\n            colorPickerRef.current.focus();\r\n        }\r\n    }, [open]);\r\n\r\n    // Closes color picker on blur\r\n    const handleBlur = (event) => {\r\n        if (!event.currentTarget.contains(event.relatedTarget)) {\r\n            setOpen(false);\r\n        }\r\n    };\r\n\r\n    // Set displayed color based on current hue, saturation, and lightness, and uptades slider positions\r\n    useEffect(() => {\r\n        if (color) {\r\n            if (useAlpha) {\r\n                let hslaColor = [];\r\n                if (color[0] === \"#\") {\r\n                    hslaColor = rgbaToHsla(hexToRgba(color));\r\n                } else if (color.slice(0, 4) === \"rgba\") {\r\n                    hslaColor = rgbaToHsla(color);\r\n                } else if (color.slice(0, 4) === \"hsla\") {\r\n                    for (let i = 0; i < color.length; i++) {\r\n                        var start;\r\n                        var end;\r\n                        if (color[i] === \"(\") {\r\n                            start = i + 1;\r\n                        } else if (color[i] === \")\") {\r\n                            end = i;\r\n                            hslaColor.push(color.slice(start, end));\r\n                        } else if (color[i] === \",\") {\r\n                            hslaColor.push(color.slice(start, i));\r\n                            start = i + 1;\r\n                        }\r\n                    }\r\n                }\r\n                setHue(Number(hslaColor[0]));\r\n                setSaturation(Number(hslaColor[1].slice(0, hslaColor[1].length - 1)));\r\n                setLightness(Number(hslaColor[2].slice(0, hslaColor[2].length - 1)));\r\n                setAlpha(Number(hslaColor[3]));\r\n                if (open) {\r\n                    const hueLumRect = hueLumRef.current.getBoundingClientRect();\r\n                    setColorSelectorPos({\r\n                        x: hslaColor[0] / 360 * hueLumRect.width,\r\n                        y: (100 - hslaColor[2].slice(0, hslaColor[2].length - 1)) / 100 * hueLumRect.height\r\n                    });\r\n                    const saturationRect = saturationRef.current.getBoundingClientRect();\r\n                    setSaturationSliderPos(((100 - hslaColor[1].slice(0, hslaColor[1].length - 1)) / 100) * saturationRect.height);\r\n                    const alphaRect = alphaRef.current.getBoundingClientRect();\r\n                    setAlphaSliderPos(hslaColor[3] * alphaRect.width);\r\n                }\r\n            } else {\r\n                let hslColor = [];\r\n                if (color[0] === \"#\") {\r\n                    hslColor = rgbToHsl(hexToRgb(color));\r\n                } else if (color.slice(0, 3) === \"rgb\") {\r\n                    hslColor = rgbToHsl(color);\r\n                } else if (color.slice(0, 3) === \"hsl\") {\r\n                    for (let i = 0; i < color.length; i++) {\r\n                        var start;\r\n                        var end;\r\n                        if (color[i] === \"(\") {\r\n                            start = i + 1;\r\n                        } else if (color[i] === \")\") {\r\n                            end = i;\r\n                            hslColor.push(color.slice(start, end));\r\n                        } else if (color[i] === \",\") {\r\n                            hslColor.push(color.slice(start, i));\r\n                            start = i + 1;\r\n                        }\r\n                    }\r\n                } else {\r\n                    hslColor = nameToHsl(color);\r\n                }\r\n                setHue(Number(hslColor[0]));\r\n                setSaturation(Number(hslColor[1].slice(0, hslColor[1].length - 1)));\r\n                setLightness(Number(hslColor[2].slice(0, hslColor[2].length - 1)));\r\n                if (open) {\r\n                    const hueLumRect = hueLumRef.current.getBoundingClientRect();\r\n                    setColorSelectorPos({\r\n                        x: hslColor[0] / 360 * hueLumRect.width,\r\n                        y: (100 - hslColor[2].slice(0, hslColor[2].length - 1)) / 100 * hueLumRect.height\r\n                    });\r\n                    const saturationRect = saturationRef.current.getBoundingClientRect();\r\n                    setSaturationSliderPos(((100 - hslColor[1].slice(0, hslColor[1].length - 1)) / 100) * saturationRect.height);\r\n                }\r\n            }\r\n        }\r\n    }, [open, color, useAlpha])\r\n\r\n    // Draw color map for hue on the x axis and lightness on the y axis, for the current saturation value\r\n    const drawColorMap = (ctx) => {\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n        let blockwidth = ctx.canvas.width / 360;\r\n        let blockheight = ctx.canvas.height / 100;\r\n        for (let i = 0; i < 360; i++) {\r\n            for (let j = 0; j < 100; j++) {\r\n                ctx.fillStyle = `hsl(${i},${saturation}%,${100 - j}%)`;\r\n                ctx.fillRect(i * blockwidth, j * blockheight, (i + 1) * blockwidth, (j + 1) * blockheight);\r\n            }\r\n        }\r\n    };\r\n\r\n    //Updates color map when saturation changes\r\n    useEffect(() => {\r\n        if (hueLumRef.current) {\r\n            const ctxColorPicker = hueLumRef.current.getContext(\"2d\", { alpha: false });\r\n            drawColorMap(ctxColorPicker);\r\n        }\r\n\r\n    }, [open, saturation]);\r\n\r\n    //Updates hue and luminance map slider positions when mouse moves, as well as their respective values\r\n    const handleHueLumMap = (event) => {\r\n        if (event.buttons !== 0) {\r\n            const rect = hueLumRef.current.getBoundingClientRect();\r\n            let x = event.clientX - rect.left;\r\n            let y = event.clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setColorSelectorPos({ x, y });\r\n                setHue(Math.floor(360 * x / rect.width));\r\n                setLightness(100 - Math.floor(100 * y / rect.height));\r\n            }\r\n        }\r\n    };\r\n    const touchHueLumMap = (event) => {\r\n        if (event.touches.length === 1) {\r\n            const rect = hueLumRef.current.getBoundingClientRect();\r\n            let x = event.touches[0].clientX - rect.left;\r\n            let y = event.touches[0].clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setColorSelectorPos({ x, y });\r\n                setHue(Math.floor(360 * x / rect.width));\r\n                setLightness(100 - Math.floor(100 * y / rect.height));\r\n            }\r\n        }\r\n    };\r\n\r\n    //Updates saturation slider position when mouse moves, as well as its value\r\n    const handleSaturationSlider = (event) => {\r\n        if (event.buttons !== 0) {\r\n            const rect = saturationRef.current.getBoundingClientRect();\r\n            let x = event.clientX - rect.left;\r\n            let y = event.clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setSaturation(100 - Math.floor(100 * y / rect.height));\r\n                setSaturationSliderPos(y);\r\n            }\r\n        }\r\n    };\r\n    const touchSaturationSlider = (event) => {\r\n        if (event.touches.length === 1) {\r\n            const rect = saturationRef.current.getBoundingClientRect();\r\n            let x = event.touches[0].clientX - rect.left;\r\n            let y = event.touches[0].clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setSaturation(100 - Math.floor(100 * y / rect.height));\r\n                setSaturationSliderPos(y);\r\n            }\r\n        }\r\n    };\r\n\r\n    //Updates alpha slider position when mouse moves, as well as its value\r\n    const handleAlphaSlider = (event) => {\r\n        if (event.buttons !== 0) {\r\n            const rect = alphaRef.current.getBoundingClientRect();\r\n            let x = event.clientX - rect.left;\r\n            let y = event.clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setAlpha((Math.floor(100 * x / rect.width)) / 100);\r\n                setAlphaSliderPos(x);\r\n            }\r\n        }\r\n    };\r\n    const touchAlphaSlider = (event) => {\r\n        if (event.touches.length === 1) {\r\n            const rect = alphaRef.current.getBoundingClientRect();\r\n            let x = event.touches[0].clientX - rect.left;\r\n            let y = event.touches[0].clientY - rect.top;\r\n            if (x >= 0 && x <= rect.width && y >= 0 && y <= rect.height) {\r\n                setAlpha((Math.floor(100 * x / rect.width)) / 100);\r\n                setAlphaSliderPos(x);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    const handleHueInput = (value) => {\r\n        setHue(value);\r\n        const rect = hueLumRef.current.getBoundingClientRect();\r\n        setColorSelectorPos({ ...colorSelectorPos, x: value / 360 * rect.width });\r\n    };\r\n\r\n    const handleLumInput = (value) => {\r\n        setLightness(value);\r\n        const rect = hueLumRef.current.getBoundingClientRect();\r\n        setColorSelectorPos({ ...colorSelectorPos, y: (100 - value) / 100 * rect.height });\r\n    };\r\n\r\n    const handleSaturationInput = (value) => {\r\n        setSaturation(value);\r\n        const rect = saturationRef.current.getBoundingClientRect();\r\n        setSaturationSliderPos(((100 - value) / 100) * rect.height);\r\n    };\r\n\r\n    const handleAlphaInput = (value) => {\r\n        setAlpha(value);\r\n        const rect = alphaRef.current.getBoundingClientRect();\r\n        setAlphaSliderPos(value * rect.width);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <color-picker-button onClick={() => setOpen(!open)} >\r\n                <div>\r\n                    <button style={{ background: color }} />\r\n                </div>\r\n            </color-picker-button>\r\n            {open && createPortal(\r\n                <color-picker-window\r\n                    tabIndex=\"0\"\r\n                    ref={colorPickerRef}\r\n                    onBlur={(e) => handleBlur(e)}\r\n                >\r\n                    <div>\r\n                        <hue-light-map>\r\n                            <canvas\r\n                                onMouseDown={(e) => handleHueLumMap(e)}\r\n                                onMouseMove={(e) => handleHueLumMap(e)}\r\n                                onTouchMove={(e) => touchHueLumMap(e)}\r\n                                onTouchStart={(e) => touchHueLumMap(e)}\r\n                                onTouchEnd={(e) => touchHueLumMap(e)}\r\n                                ref={hueLumRef} width=\"180\" height=\"180\"\r\n                                style={{ opacity: useAlpha ? alpha : 1 }}\r\n                            />\r\n                            <slider-thumb\r\n                                style={{\r\n                                    top: colorSelectorPos.y,\r\n                                    left: colorSelectorPos.x,\r\n                                    background:\r\n                                        useAlpha ?\r\n                                            `hsla(${hue},${saturation}%,${lightness}%, ${alpha})` :\r\n                                            `hsl(${hue},${saturation}%,${lightness}%)`\r\n                                }}\r\n                                onMouseDown={(e) => handleHueLumMap(e)}\r\n                                onMouseMove={(e) => handleHueLumMap(e)}\r\n                                onTouchMove={(e) => touchHueLumMap(e)}\r\n                                onTouchStart={(e) => touchHueLumMap(e)}\r\n                                onTouchEnd={(e) => touchHueLumMap(e)}\r\n                            />\r\n                        </hue-light-map>\r\n                        <saturation-slider title=\"Saturation\">\r\n                            <div\r\n                                ref={saturationRef}\r\n                                style={{\r\n                                    background:\r\n                                        `linear-gradient(0deg, hsl(${hue},0%,${lightness}%), hsla(${hue},100%,${lightness}%))`\r\n                                }}\r\n                                onMouseDown={(e) => handleSaturationSlider(e)}\r\n                                onMouseMove={(e) => handleSaturationSlider(e)}\r\n                                onTouchMove={(e) => touchSaturationSlider(e)}\r\n                                onTouchStart={(e) => touchSaturationSlider(e)}\r\n                                onTouchEnd={(e) => touchSaturationSlider(e)}\r\n                            />\r\n                            <slider-thumb\r\n                                style={{\r\n                                    top: saturationSliderPos,\r\n                                    background: `hsla(${hue},${saturation}%,${lightness}%, ${alpha})`\r\n                                }}\r\n                                onMouseDown={(e) => handleSaturationSlider(e)}\r\n                                onMouseMove={(e) => handleSaturationSlider(e)}\r\n                                onTouchMove={(e) => touchSaturationSlider(e)}\r\n                                onTouchStart={(e) => touchSaturationSlider(e)}\r\n                                onTouchEnd={(e) => touchSaturationSlider(e)}\r\n                            />\r\n                        </saturation-slider>\r\n                    </div>\r\n                    {useAlpha &&\r\n                        <alpha-slider title=\"Alpha\">\r\n                            <div\r\n                                ref={alphaRef}\r\n                                style={{\r\n                                    background:\r\n                                        `linear-gradient(90deg, hsla(${hue},${saturation}%,${lightness}%, 0), hsla(${hue},${saturation}%,${lightness}%, 1))`\r\n                                }}\r\n                                onMouseDown={(e) => handleAlphaSlider(e)}\r\n                                onMouseMove={(e) => handleAlphaSlider(e)}\r\n                                onTouchMove={(e) => touchAlphaSlider(e)}\r\n                                onTouchStart={(e) => touchAlphaSlider(e)}\r\n                                onTouchEnd={(e) => touchAlphaSlider(e)}\r\n                            />\r\n                            <slider-thumb\r\n                                style={{\r\n                                    left: alphaSliderPos,\r\n                                    background: `hsl(${hue},${saturation}%,${lightness}%, ${alpha})`\r\n                                }}\r\n                                onMouseDown={(e) => handleAlphaSlider(e)}\r\n                                onMouseMove={(e) => handleAlphaSlider(e)}\r\n                                onTouchMove={(e) => touchAlphaSlider(e)}\r\n                                onTouchStart={(e) => touchAlphaSlider(e)}\r\n                                onTouchEnd={(e) => touchAlphaSlider(e)}\r\n                            />\r\n                        </alpha-slider>\r\n                    }\r\n                    <color-inputs>\r\n                        <div>\r\n                            Hue\r\n                            <input type=\"number\" min=\"0\" max=\"360\" value={hue}\r\n                                onChange={(e) => handleHueInput(e.target.value)} />\r\n                        </div>\r\n                        <div>\r\n                            Lum.\r\n                            <input type=\"number\" min=\"0\" max=\"100\" value={lightness}\r\n                                onChange={(e) => handleLumInput(e.target.value)} />\r\n                        </div>\r\n                        <div>\r\n                            Sat.\r\n                            <input type=\"number\" min=\"0\" max=\"100\" value={saturation}\r\n                                onChange={(e) => handleSaturationInput(e.target.value)} />\r\n                        </div>\r\n                        {useAlpha &&\r\n                            <div>\r\n                                Alpha\r\n                                <input type=\"number\" min=\"0\" max=\"1\" step=\"0.01\" value={alpha}\r\n                                    onChange={(e) => handleAlphaInput(e.target.value)} />\r\n                            </div>\r\n                        }\r\n                    </color-inputs>\r\n                    <color-button >\r\n                        <button\r\n                            style={{\r\n                                background: useAlpha ? `hsla(${hue},${saturation}%,${lightness}%, ${alpha})` : `hsl(${hue},${saturation}%,${lightness}%)`\r\n                            }}\r\n                            onClick={() => { useAlpha ? setColor(`hsla(${hue},${saturation}%,${lightness}%, ${alpha})`) : setColor(`hsl(${hue},${saturation}%,${lightness}%)`) }}\r\n                        >\r\n                            Apply\r\n                        </button>\r\n                    </color-button>\r\n                </color-picker-window>\r\n                , document.getElementById(\"root\"))}\r\n        </>\r\n    );\r\n}","export default function hexToRgba(hex) {\r\n    var result;\r\n    if (hex.length === 5) {\r\n        result = /^#?([a-f\\d]{1})([a-f\\d]{1})([a-f\\d]{1})([a-f\\d]{1})$/i.exec(hex);\r\n        if(result[4] == 0){\r\n            result[4] = 'ff';\r\n        }\r\n    } else if(hex.length === 9) {\r\n        result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    }else if(hex.length === 8) {\r\n        result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n        result[4] = 'ff';\r\n    }\r\n        return result\r\n            ? [\r\n                parseInt(result[1], 16),\r\n                parseInt(result[2], 16),\r\n                parseInt(result[3], 16),\r\n                parseInt(result[4], 16) / 255,\r\n            ]\r\n            : null;\r\n}","export default function hexToRgb(hex) {\r\n    var result;\r\n    if(hex.length === 4){\r\n        result = /^#?([a-f\\d]{1})([a-f\\d]{1})([a-f\\d]{1})$/i.exec(hex);\r\n    }else{\r\n        result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n    }\r\n    return result\r\n        ? [\r\n               parseInt(result[1], 16),\r\n               parseInt(result[2], 16),\r\n               parseInt(result[3], 16),\r\n          ]\r\n        : null;\r\n}","export default function nameToHsl(name) {\r\n    switch(name){\r\n        case \"red\":\r\n            return [0, \"100%\", \"50%\"];\r\n        case \"green\":\r\n            return [120, \"100%\", \"50%\"];\r\n        case \"blue\":\r\n            return [240, \"100%\", \"50%\"];\r\n        case \"yellow\":\r\n            return [60, \"100%\", \"50%\"];\r\n        case \"cyan\":\r\n            return [180, \"100%\", \"50%\"];\r\n        case \"magenta\":\r\n            return [300, \"100%\", \"50%\"];\r\n        case \"black\":\r\n            return [0, \"0%\", \"0%\"];\r\n        case \"white\":\r\n            return [0, \"0%\", \"100%\"];\r\n        case \"gray\":\r\n        case \"grey\":\r\n            return [0, \"0%\", \"50%\"];\r\n        case \"lightgray\":\r\n        case \"lightgrey\":\r\n            return [0, \"0%\", \"75%\"];\r\n        case \"darkgray\":\r\n        case \"darkgrey\":\r\n            return [0, \"0%\", \"25%\"];\r\n        case \"brown\":\r\n            return [30, \"50%\", \"50%\"];\r\n        case \"orange\":\r\n            return [30, \"100%\", \"50%\"];\r\n        case \"purple\":\r\n            return [270, \"100%\", \"50%\"];\r\n        case \"pink\":\r\n            return [330, \"100%\", \"50%\"];\r\n        case \"lime\":\r\n            return [120, \"100%\", \"50%\"];\r\n        case \"teal\":\r\n            return [180, \"100%\", \"50%\"];\r\n        case \"aqua\":\r\n            return [240, \"100%\", \"50%\"];\r\n        case \"maroon\":\r\n            return [0, \"100%\", \"50%\"];\r\n        case \"navy\":\r\n            return [240, \"100%\", \"50%\"];\r\n        case \"olive\":\r\n            return [60, \"100%\", \"50%\"];\r\n        default:\r\n            return [0, \"0%\", \"0%\"];\r\n    }\r\n}"],"names":["Context","createContext","currLayer","layers","setLayers","lastLayer","setLastLayer","name","setName","setCurrLayer","history","setHistory","dimentions","setDimentions","useAlpha","setUseAlpha","newParams","setNewParams","tool","setTool","brushPoints","setBrushPoints","subTool","setSubTool","curveControls","setCurveControls","color","setColor","size","setSize","text","setText","clipboard","setClipboard","zoom","setZoom","cursor","setCursor","view","setView","_ref","children","useState","id","blending","filters","opacity","visible","locked","canUndo","canRedo","data","lastIndex","width","height","alpha","shape","fill","stretch","sides","angle","startAngle","lineJoin","lineCap","radii","state","start","x","y","end","controlPoint1","controlPoint2","selected","stroke","strokeWidth","lineHeight","fontFamily","current","down","selecting","toolBar","contentBar","topNavBar","bottomNavBar","menu","contextValue","_jsx","Provider","value","handleDraw","canvas","param","preview","action","ctx","getContext","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","imageSmoothingEnabled","startX","startY","endX","endY","drawEraser","strokeStyle","selectedColor","fillStyle","lineWidth","setLineDash","beginPath","arc","Math","PI","closePath","drawFunctions","drawBrush","length","moveTo","lineTo","drawSpray","randomX","random","randomNegativeX","randomY","randomNegativeY","sqrt","pow","fillRect","drawBucket","r","g","b","h","s","l","hslaColor","i","push","slice","round","temp1","temp2","tempR","tempG","tempB","secondTest","finalTest","tempColor","componentToHex","c","hex","Number","toString","hexColor","spans","parseInt","imageData","getImageData","pixelData","Uint32Array","buffer","getPixel","currX","currY","targetColor","floor","addSpan","left","right","line","direction","checkSpan","column","flag","depth","pop","lineOffset","console","log","error","putImageData","drawText","color1","color2","font","String","linesArr","split","lineIndex","maxWidth","top","whileBreak","measureText","firstText","firstTextIndex","whileBreak2","lastText","substring","toSpliced","forEach","index","fillText","strokeText","drawPipette","pixel","a","cmin","min","cmax","max","delta","abs","toFixed","setColor1","setColor2","drawSelect","carryCtx","document","getElementById","carryCanvas","drawImage","drawShape","radius","centerX","centerY","stretchX","stretchY","save","translate","rotate","restore","drawLine","drawCurve","startPoint","endPoint","bezierCurveTo","drawCircle","ellipse","drawRectangle","strokeRect","drawSquagle","roundRect","drawPolygon","cos","sin","drawStar","drawArrow","drawHeart","scale","clearRect","handleTools","params","setAction","newState","newStart","newEnd","newControlPoint1","newControlPoint2","handleTopMenu","appMenu","setAppMenu","args","updatedAppMenu","handleHistory","context","command","setCanClose","updatedHistory","updateStates","updatedLayers","canClose","undoAction","canUndoLayer","redoAction","canRedoLayer","duplicateLayer","target","image","saveAction","isNewLayer","targetCanvas","splice","shift","handleFile","checkCancelledUpload","input","body","onfocus","remove","saveFile","finalCanvas","createElement","finalCtx","layer","globalCompositeOperation","globalAlpha","filter","filtersString","Object","keys","key","constructFilters","downloadLink","setAttribute","url","toDataURL","replace","click","newFile","baseCanvas","openFile","type","accept","onchange","e","file","files","reader","FileReader","onload","Image","src","result","readAsDataURL","uploadImage","tempCanvas","tempCtx","handleAction","props","appDialog","setAppDialog","contextMenu","isSelected","title","setTitle","dialogNew","info","_jsxs","_Fragment","htmlFor","onChange","checked","actions","Confirm","Cancel","dialogSaveAs","dialogChangeName","setTimeout","dialogCloseApp","Save","Close","DrawCanvas","useContext","v","useEffect","undefined","willReadFrequently","offsetX","offsetY","style","transform","getElementsByClassName","className","map","display","mixBlendMode","zIndex","PreviewCanvas","canvasPreviewRef","useRef","ref","SelectionCanvas","subtool","selectionBox","setSelectionBox","canUsePointer","selectionCircle","setSelectionCircle","diameter","selectionEllipse","setSelectionEllipse","resizeDelta","setResizeDelta","dragDelta","setDragDelta","rotateStartPos","setRotateStartPos","dragPivotDelta","setDragPivotDelta","getCursorFromEvent","cursorX","cursorY","button","clientX","clientY","touches","boundary","getBoundingClientRect","scaleX","scaleY","handleResizeStart","stopPropagation","cursorPos","newDeltaX","newDeltaY","indexOf","handleResizeCommon","invertX","invertY","newStartX","newStartY","newEndX","newEndY","handleResize","preventDefault","resizeResult","handleResizeEnd","handleDragStart","startDeltaX","startDeltaY","endDeltaX","endDeltaY","handleDrag","handleDragEnd","handleCircleRotate","horizontal","vertical","hypothenuse","currAngleDeg","acos","handleDragPivotStart","pivot","initialX","initialY","handleDragPivot","handleDragPivotEnd","centerLeft","centerTop","pointerEvents","draggable","onDragStart","onDrag","onDragEnd","handleCircleRotateStart","handleCircleRotateEnd","caretColor","fontSize","spellCheck","atan2","LayersWindow","layersCanvasPreviews","setLayersCanvasPreviews","renameLayerIndex","setRenameLayerIndex","dragTargetIndex","setDragTargetIndex","dropTargetIndex","setDropTargetIndex","FILTER_LIST","formatListName","formattedName","match","charAt","toUpperCase","changeCurrLayer","focus","select","addEventListener","removeEventListener","changeFilter","subkey","newLayers","handleLayerDragOver","dataTransfer","dropEffect","handleLayerDrop","draggedLayer","_layer","dropLayer","getImageFromCanvasRef","notMain","changeBlending","disabled","blend","step","changeOpacity","onClick","newId","newLayer","newHistory","IoDuplicateSharp","RiEditLine","toggleLock","TiLockClosed","TiLockOpen","deleteLayer","FaTrashCan","onDragOver","onDrop","Fragment","textDecoration","renameLayer","toggleVisibility","RiEyeFill","RiEyeCloseFill","BiUndo","BiRedo","addFilter","find","ColorPicker","removeFilter","IoClose","createNewLayer","ContentBar","open","setOpen","setSelected","onContextMenu","event","content","setPosition","setContent","handleContextMenu","GoTriangleRight","GoTriangleLeft","CarryCanvas","position","CanvasInterface","interfaceRef","getCorrectedPosition","handleCursor","pos","buttons","handleTouch","onMouseDown","onMouseUp","onMouseMove","onMouseLeave","onMouseEnter","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","TopNavBar","TfiFile","TfiSave","FaImage","handleZoom","AiOutlineColumnHeight","RiFontSize","CiLineHeight","RiShapesLine","BiShapePolygon","SubToolIcon","canvasSubToolRef","functionList","drawCircleIcon","drawEllipseIcon","drawRectangleIcon","drawSquagleIcon","drawPolygonIcon","drawLineIcon","drawCurveIcon","drawStarIcon","drawArrowIcon","drawHeartIcon","getComputedStyle","ToolBar","toolComponents","Brush","GiPaintBrush","Eraser","TfiEraser","Bucket","TfiPaintBucket","Spray","TfiSpray","Text","RxLetterCaseCapitalize","Pipette","CgColorPicker","Magnifier","HiOutlineMagnifyingGlass","Select","LuBoxSelect","Shape","BottomNavBar","DrawDoc","flexDirection","margin","rgbToHsl","rgb","rgbaToHsla","rgba","colorPickerRef","hueLumRef","saturationRef","alphaRef","colorSelectorPos","setColorSelectorPos","saturationSliderPos","setSaturationSliderPos","alphaSliderPos","setAlphaSliderPos","hue","setHue","lightness","setLightness","saturation","setSaturation","setAlpha","exec","hexToRgba","hueLumRect","saturationRect","alphaRect","hslColor","hexToRgb","nameToHsl","blockwidth","blockheight","j","drawColorMap","handleHueLumMap","rect","touchHueLumMap","handleSaturationSlider","touchSaturationSlider","handleAlphaSlider","touchAlphaSlider","background","createPortal","tabIndex","onBlur","currentTarget","contains","relatedTarget","handleHueInput","handleLumInput","handleSaturationInput","handleAlphaInput"],"sourceRoot":""}