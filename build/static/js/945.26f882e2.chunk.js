"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[945],{6303:(t,n,a)=>{a.r(n),a.d(n,{default:()=>M});var e=a(5043),s=a(749),o=a(8711),i=a(7174),r=a(2373);const h=a.p+"static/media/Gyroscope.572cdad23e89a59df442.glb";var c=a(579);function M(){const[t,n]=(0,e.useState)("ready"),[a,u]=(0,e.useState)({heading:0,pitch:0,roll:0});var l=null;const d=()=>{const t=(0,i.p)(h),n=(0,e.useRef)();let o,r,M;t.scene.children.forEach((t=>{"External_Gimbal"===t.name&&(o=t),"Internal_Gimbal"===t.name&&(r=t),"Axis"===t.name&&(M=t)}));let u=0;return(0,s.F)(((t,n)=>{if("running"===t&&(u+=10*n),void 0!==o&&void 0!==r&&void 0!==M){let t=a.roll+Math.PI,n=a.pitch+Math.PI/2+u,e=u;o.quaternion.w=Math.cos(t/2),o.quaternion.y=Math.sin(t/2),o.quaternion.x=0,o.quaternion.z=0,r.quaternion.w=Math.cos(t/2)*Math.cos(n/2),r.quaternion.y=Math.sin(t/2)*Math.cos(n/2),r.quaternion.x=Math.cos(t/2)*Math.sin(n/2),r.quaternion.z=-Math.sin(t/2)*Math.sin(n/2),M.quaternion.w=Math.cos(t/2)*Math.cos((n+Math.PI/2)/2)*Math.cos(e/2)+Math.sin(t/2)*Math.sin((n+Math.PI/2)/2)*Math.sin(e/2),M.quaternion.y=Math.sin(t/2)*Math.cos((n+Math.PI/2)/2)*Math.cos(e/2)-Math.cos(t/2)*Math.sin((n+Math.PI/2)/2)*Math.sin(e/2),M.quaternion.x=Math.cos(t/2)*Math.sin((n+Math.PI/2)/2)*Math.cos(e/2)+Math.sin(t/2)*Math.cos((n+Math.PI/2)/2)*Math.sin(e/2),M.quaternion.z=Math.cos(t/2)*Math.cos((n+Math.PI/2)/2)*Math.sin(e/2)-Math.sin(t/2)*Math.sin((n+Math.PI/2)/2)*Math.cos(e/2)}})),(0,c.jsx)("primitive",{ref:n,object:t.scene,scale:1.6})};const p=()=>{(l=new M({frequency:4,referenceFrame:"device"})).start(),console.log("gyroscope started"),l.onreading=()=>{!function(t,n,a,e){const s=Math.atan2(2*(t*n+a*e),1-2*(n*n+a*a)),o=Math.asin(2*(t*a-e*n)),i=Math.atan2(2*(t*e+n*a),1-2*(t*t+n*n));u({heading:s,pitch:o,roll:i})}(l.quaternion[0],l.quaternion[1],l.quaternion[2],l.quaternion[3])}};return(0,e.useEffect)((()=>{"start"===t&&("AbsoluteOrientationSensor"in window?Promise(navigator.permissions.query({name:"gyroscope"})).then((t=>{t.every((t=>"granted"===t.state))?n("running"):n("not allowed")})):n("not supported")),"running"===t&&p()}),[t]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(o.Hl,{children:[(0,c.jsx)("ambientLight",{intensity:1}),(0,c.jsx)("pointLight",{position:[-10,-10,10],intensity:500}),(0,c.jsx)(d,{}),(0,c.jsx)(r.q,{makeDefault:!0,zoom:50,position:[0,0,10]})]}),"ready"===t&&(0,c.jsx)("button",{className:"gyroscopeStartButton",onClick:()=>n("start"),children:"Start"}),"not supported"===t&&(0,c.jsx)("div",{className:"gyroscopeWarning",children:"This feature is not supported on your device and/or browser"}),"not allowed"===t&&(0,c.jsx)("div",{className:"gyroscopeWarning",children:"This feature does not have permission to access your device sensors"})]})}}}]);
//# sourceMappingURL=945.26f882e2.chunk.js.map