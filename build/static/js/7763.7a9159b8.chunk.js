"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[7763],{7763:(e,t,o)=>{o.r(t),o.d(t,{default:()=>B});var n=o(5043),a=o(579);const l=(0,n.createContext)({name:"",setName:()=>{},history:{},setHistory:()=>{},dimentions:{},setDimentions:()=>{},tempDimentions:{},setTempDimentions:()=>{},tool:"",setTool:()=>{},subTool:{},setSubTool:()=>{},curveControls:{},setCurveControls:()=>{},color:{},setColor:()=>{},size:0,setSize:()=>{},text:{},setText:()=>{},clipboard:{},setClipboard:()=>{},zoom:1,setZoom:()=>{},cursor:{},setCursor:()=>{},view:{},setView:()=>{}});const s=function(e){let{children:t}=e;const[o,s]=(0,n.useState)("Untitled"),[i,r]=(0,n.useState)({history:[],index:0,canUndo:!1,canRedo:!1}),[c,d]=(0,n.useState)({width:350,height:350}),[h,u]=(0,n.useState)({width:350,height:350}),[x,g]=(0,n.useState)("Brush"),[p,m]=(0,n.useState)({shape:"Circle",fill:!1,stretch:!1,sides:4,angle:0,startAngle:0}),[b,f]=(0,n.useState)({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),[y,v]=(0,n.useState)({selected:"hsl(0, 100%, 0%)",1:"hsl(0, 100%, 0%)",2:"hsl(0, 100%, 100%)"}),[w,C]=(0,n.useState)(16),[M,j]=(0,n.useState)({text:"",fill:!0,stroke:!1,strokeWidth:2,lineHeight:1.2,fontFamily:"Arial",state:"none"}),[S,T]=(0,n.useState)({data:{},state:"none"}),[k,D]=(0,n.useState)(1),[P,I]=(0,n.useState)({current:{x:0,y:0},start:{x:0,y:0},end:{x:0,y:0},down:!1,selecting:!1}),[B,N]=(0,n.useState)({toolBar:!0,topNavBar:!0,bottomNavBar:!0,menu:!0}),z={name:o,setName:s,history:i,setHistory:r,dimentions:c,setDimentions:d,tempDimentions:h,setTempDimentions:u,tool:x,setTool:g,subTool:p,setSubTool:m,curveControls:b,setCurveControls:f,color:y,setColor:v,size:w,setSize:C,text:M,setText:j,clipboard:S,setClipboard:T,zoom:k,setZoom:D,cursor:P,setCursor:I,view:B,setView:N};return(0,a.jsx)(l.Provider,{value:z,children:t})},i=(e,t,o,n)=>{let a;a=n?e.getContext("2d",{alpha:!0}):e.getContext("2d",{alpha:!1}),a.webkitImageSmoothingEnabled=!1,a.mozImageSmoothingEnabled=!1,a.imageSmoothingEnabled=!1;const l=a.canvas.height,s=a.canvas.width,i=t.current.x,r=t.current.y,c=t.start.x,d=t.start.y,h=t.end.x,u=t.end.y,x=()=>{a.strokeStyle=o.selectedColor,a.fillStyle=o.selectedColor,a.lineWidth=1,a.setLineDash([]),a.beginPath(),a.arc(i,r,o.size,0,2*Math.PI),n?a.stroke():a.fill(),a.closePath()},g={drawBrush:()=>{a.fillStyle=o.selectedColor,a.strokeStyle=o.selectedColor,a.lineWidth=1,a.setLineDash([]),a.beginPath(),a.arc(i,r,o.size,0,2*Math.PI),a.stroke(),a.fill(),a.closePath()},drawEraser:x,drawSpray:()=>{let e=Math.random()*o.size,t=Math.random(),n=Math.random()*o.size,l=Math.random();for(;Math.sqrt(Math.pow(e,2)+Math.pow(n,2))>o.size;)e=Math.random()*o.size,n=Math.random()*o.size;l>.5&&(n*=-1),t>.5&&(e*=-1),a.fillStyle=o.selectedColor,a.fillRect(i+e,r+n,1,1)},drawBucket:()=>{let e,t,n,c,d,h,u=[];for(let T=0;T<o.selectedColor.length;T++){var x,g;"("===o.selectedColor[T]?x=T+1:")"===o.selectedColor[T]?(g=T,u.push(o.selectedColor.slice(x,g))):","===o.selectedColor[T]&&(u.push(o.selectedColor.slice(x,T)),x=T+1)}if(c=u[0]/360,d=u[1].slice(0,-1)/100,h=u[2].slice(0,-1)/100,0===d)e=255*h,t=255*h,n=255*h;else{let k,D,P,I,B;function N(e){return e<0?e+1:e>1?e-1:e}function z(e,t,o){return 6*o<1?t+6*(e-t)*o:2*o<1?e:3*o<2?t+(e-t)*(2/3-o)*6:t}k=h<.5?h*(1+d):h+d-h*d,D=2*h-k,P=N(c+1/3),I=N(c),B=N(c-1/3),e=Math.round(255*z(k,D,P)),t=Math.round(255*z(k,D,I)),n=Math.round(255*z(k,D,B))}function p(e){var t=Number(e).toString(16);return 1==t.length?"0"+t:t}let m="#"+p(e)+p(t)+p(n),b=[],f=parseInt("FF"+m.slice(5,7)+m.slice(3,5)+m.slice(1,3),16);const y=a.getImageData(0,0,s,l),v={width:y.width,height:y.height,data:new Uint32Array(y.data.buffer)};function w(e,t){return e<0||t<0||e>=v.width||t>=v.height?-1:v.data[t*y.width+e]}let C=w(Math.floor(i),Math.floor(r));if(-1===C||C===f)return;const M=(e,t,o,n)=>{b.push({left:e,right:t,line:o,direction:n})},j=(e,t,o,n)=>{let a,s,i=!1;if(!(o>=l||o<0)){for(s=e;s<t;++s){w(s,o)===C?i||(i=!0,a=s):i&&(i=!1,M(a,s-1,o,n))}i&&(i=!1,M(a,t-1,o,n))}};M(Math.floor(i),Math.floor(i),Math.floor(r),0);let S=0;for(;b.length>0&&S<5e3;){S++;const{left:R,right:A,line:E,direction:F}=b.pop();let $=R;for(;$>=0&&w($,E)===C;$--);++$;let Z=A;for(;Z<s&&w(Z,E)===C;++Z);const W=E*s;W+Z>v.data.length?(console.log("Attempt to access pixel data array beyond its maximum length"),v.data.fill(f,W+$,v.data.length)):v.data.fill(f,W+$,W+Z),F<=0?j($,Z,E-1,-1):(j($,R,E-1,-1),j(A,Z,E-1,-1)),F>=0?j($,Z,E+1,1):(j($,R,E+1,1),j(A,Z,E+1,1))}S>=5e3&&console.error("Bucket Tool maximum iterations exceeded, consider using a smaller canvas."),a.putImageData(y,0,0)},drawText:()=>{a.fillStyle=o.selectedColor,a.strokeStyle=o.selectedColor===o.color1?o.color2:o.color1,a.lineWidth=o.text.strokeWidth,a.font=String(o.size+"px "+o.text.fontFamily);let e=o.text.text.split("\n"),t=0,n=h>c?h-c:c-h,l=h>c?c:h,s=u>d?d:u,i=0;for(;t<e.length&&i<500;){if(a.measureText(e[t]).width>n){let o=e[t][0],l=1,s=0;for(;a.measureText(o).width<n&&s<500;)o+=e[t][l],l++,s++;let i=e[t].substring(l-1,e[t].length);e[t]=o.substring(0,l-1),e=e.toSpliced(t+1,0,i)}t++,i++}e.forEach(((e,t)=>{o.text.fill&&a.fillText(e,l,s+o.size+o.size*o.text.lineHeight*t),o.text.stroke&&a.strokeText(e,l,s+o.size+o.size*o.text.lineHeight*t)}))},drawPipette:()=>{let e=a.getImageData(i,r,1,1),t=e.data[0],n=e.data[1],l=e.data[2];t/=255,n/=255,l/=255;let s=Math.min(t,n,l),c=Math.max(t,n,l),d=c-s,h=0,u=0,x=(c+s)/2;0===d?(u=0,h=0):(u=x<=.5?d/(c+s):d/(2-c-s),c===t?h=(n-l)/d:c===n?h=(l-t)/d+2:c===l&&(h=(t-n)/d+4)),h=Math.round(60*h),h<0&&(h+=360),u=Math.abs(100*u).toFixed(0),x=(100*x).toFixed(0);let g="hsl("+h+","+u+"%,"+x+"%)";if("Pipette"!==o.tool)return g;o.selectedColor===o.color1?o.setColor1(g):o.setColor2(g)},drawSelect:()=>{switch(o.clipboard.state){case"copy":if(!n&&h-c!==0&&u-d!==0){let e=a.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"})}break;case"cut":if(!n&&h-c!==0&&u-d!==0){let e=a.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"}),o.selectedColor===o.color1?a.fillStyle=o.color2:a.fillStyle=o.color1,a.fillRect(c,d,h-c,u-d)}break;case"carry":t.down?a.putImageData(o.clipboard.data,i,r):a.putImageData(o.clipboard.data,h,u);break;case"paste":n||(a.putImageData(o.clipboard.data,h,u),o.setClipboard({...o.clipboard,state:"none"}))}},drawShape:()=>{a.strokeStyle=o.color1,a.fillStyle=o.color2,a.setLineDash([]),a.lineWidth=o.size;let e,t=(h-c)/2,n=(u-d)/2;e=Math.sqrt(Math.pow(h-c,2))/2<Math.sqrt(Math.pow(u-d,2))/2?Math.sqrt(Math.pow(h-c,2))/2:Math.sqrt(Math.pow(u-d,2))/2;let l=Math.sqrt(Math.pow((h-c)/(u-d),2)),s=Math.sqrt(Math.pow((u-d)/(h-c),2));o.subTool.stretch?l>s?s=1:l=1:(l=1,s=1),"Curve"!==o.subTool.shape&&"Line"!==o.subTool.shape&&(a.save(),a.translate(c+t,d+n),a.rotate(Math.PI*o.subTool.angle/180)),"Rectangle"===o.subTool.shape?g["draw"+o.subTool.shape](t,n):g["draw"+o.subTool.shape](l,s,e),"Line"!==o.subTool.shape&&"Curve"!==o.subTool.shape&&a.restore()},drawLine:()=>{a.beginPath(),a.moveTo(c,d),a.lineTo(h,u),a.stroke()},drawCurve:()=>{let e={x:0,y:0},t={x:0,y:0},n={x:0,y:0},l={x:0,y:0};a.beginPath(),-1===o.curveControls.start.x?(e={x:c,y:d},t={x:h,y:u},n={x:c,y:d},l={x:h,y:u}):-1===o.curveControls.controlPoint1.x?(e=o.curveControls.start,t=o.curveControls.end,n={x:h,y:u},l=o.curveControls.end):-1===o.curveControls.controlPoint2.x?(e=o.curveControls.start,t=o.curveControls.end,n=o.curveControls.controlPoint1,l={x:h,y:u}):(e=o.curveControls.start,t=o.curveControls.end,n=o.curveControls.controlPoint1,l=o.curveControls.controlPoint2),a.moveTo(e.x,e.y),a.bezierCurveTo(n.x,n.y,l.x,l.y,t.x,t.y),a.stroke()},drawCircle:(e,t,n)=>{a.beginPath(),a.ellipse(0,0,e*n,t*n,0,0,2*Math.PI),o.subTool.fill&&a.fill(),a.stroke()},drawRectangle:(e,t)=>{o.subTool.fill&&a.fillRect(-e,-t,h-c,u-d),a.strokeRect(-e,-t,h-c,u-d)},drawPolygon:(e,t,n)=>{a.beginPath();for(let l=0;l<o.subTool.sides+2;l++)a.lineTo(e*n*Math.cos(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n*Math.sin(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&a.fill(),a.stroke()},drawStar:(e,t,n)=>{a.beginPath();for(let l=0;l<2*o.subTool.sides+2;l++)l%2===0?a.lineTo(e*n*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle)):a.lineTo(e*n/3*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*n/3*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&a.fill(),a.stroke()},drawArrow:(e,t,n)=>{a.beginPath(),a.moveTo(e*-n*Math.cos(Math.PI/8),t*-n*Math.sin(Math.PI/8)),a.lineTo(0,t*-n*Math.sin(Math.PI/8)),a.lineTo(0,t*-n),a.lineTo(e*n,0),a.lineTo(0,t*n),a.lineTo(0,t*n*Math.sin(Math.PI/8)),a.lineTo(e*-n*Math.cos(Math.PI/8),t*n*Math.sin(Math.PI/8)),a.closePath(),o.subTool.fill&&a.fill(),a.stroke()},drawHeart:(e,t,n)=>{o.subTool.stretch&&(e>t?a.scale(e,1):a.scale(1,t)),a.beginPath(),a.moveTo(0,n),a.arc(-n/2,-n/5,n/2,3*Math.PI/4,0,!1),a.arc(n/2,-n/5,n/2,Math.PI,Math.PI/4,!1),a.closePath(),o.subTool.fill&&a.fill(),a.stroke()}};if(n){if(a.clearRect(0,0,s,l),"Magnifier"!==o.tool){if("Bucket"===o.tool||"Pipette"===o.tool)return;"Spray"===o.tool?x():g["draw"+o.tool]()}}else"Magnifier"!==o.tool&&g["draw"+o.tool]()},r=(e,t,o,n,a,l)=>{switch(n.tool){case"Brush":case"Eraser":i(e,t,n,!1),"drawing"!==a&&l("drawing");break;case"Bucket":i(e,t,n,!1),l("finished");break;case"Spray":for(let o=0;o<10;o++)i(e,t,n,!1);l("spraying");break;case"Text":0!==t.current.x&&0!==t.current.y&&n.setText({...n.text,state:"preview"}),"confirm"===a&&(i(e,t,n,!1),n.setText({...n.text,text:"",state:"none"}),l("finished"));break;case"Pipette":i(e,t,n,!1);break;case"Magnifier":default:break;case"Select":"clipping"===a&&"carry"!==n.clipboard.state?i(e,t,n,!1):"confirm"===a&&(i(e,t,n,!1),l("finished"));break;case"Shape":if("Curve"===n.subTool.shape&&t.down){let e=n.curveControls.state,o=n.curveControls.start,s=n.curveControls.end,i=n.curveControls.controlPoint1,r=n.curveControls.controlPoint2;"none"===n.curveControls.state?(l("settingPoints"),e="start",o={x:t.start.x,y:t.start.y},s={x:t.end.x,y:t.end.y}):"start"===n.curveControls.state?"settingPoints"===a?s={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point1",i={x:t.end.x,y:t.end.y}):"point1"===n.curveControls.state?"settingPoints"===a?i={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point2",r={x:t.end.x,y:t.end.y}):"point2"===n.curveControls.state&&(r={x:t.end.x,y:t.end.y}),n.setCurveControls({...n.curveControls,state:e,start:o,end:s,controlPoint1:i,controlPoint2:r})}else"Curve"===n.subTool.shape&&"cancel"===a&&n.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}});"confirm"===a&&(i(e,t,n,!1),"Curve"===n.subTool.shape&&n.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),l("finished"),o({...t,start:{x:0,y:0},end:{x:0,y:0}}))}},c=(e,t,o,n)=>{if(null===e)t({File:{New:{action:"New",keybind:"Alt+N",disabled:!1},Download:{action:"Save",keybind:"Ctrl+Alt+S",disabled:!0},"Download As":{action:"Save As",keybind:"Ctrl+Alt+Shift+S",disabled:!0,title:"Not Implemented"},"Change Name":{action:"Change Name",keybind:"F2",disabled:!1},LineBreak1:{},Close:{action:"Close",keybind:"Alt+Shift+F4",disabled:!1}},Edit:{Undo:{action:"Undo",keybind:"Ctrl+Z",disabled:!1},Redo:{action:"Redo",keybind:"Ctrl+Y",disabled:!1}},View:{"Zoom In":{action:"Zoom In",keybind:"Alt++",disabled:!1},"Zoom Out":{action:"Zoom Out",keybind:"Alt+-",disabled:!1},"Zoom Reset":{action:"Zoom Reset",keybind:"Alt+0",disabled:!0},LineBreak1:{},"Tool Bar":{action:"toolBar",checkbox:!0,disabled:!1},"Bottom Bar":{action:"bottomNavBar",checkbox:!0,disabled:!1},"Top Bar":{action:"topNavBar",checkbox:!0,disabled:!1}}});else{let a={...e};switch(n){case"history":let e=o.history.canUndo||o.history.canRedo;a={...a,File:{...a.File,Download:{...a.File.Download,disabled:!e},"Download As":{...a.File["Download As"],disabled:!e}},Edit:{...a.Edit,Undo:{...a.Edit.Undo,disabled:!o.history.canUndo},Redo:{...a.Edit.Redo,disabled:!o.history.canRedo}}};break;case"view":a={...a,View:{...a.View,"Tool Bar":{...a.View["Tool Bar"],checkbox:o.view.toolBar},"Bottom Bar":{...a.View["Bottom Bar"],checkbox:o.view.bottomNavBar},"Top Bar":{...a.View["Top Bar"],checkbox:o.view.topNavBar}}};break;case"zoom":a={...a,View:{...a.View,"Zoom In":{...a.View["Zoom In"],disabled:4===o.zoom},"Zoom Out":{...a.View["Zoom Out"],disabled:.25===o.zoom},"Zoom Reset":{...a.View["Zoom Reset"],disabled:1===o.zoom}}}}t(a)}},d=(e,t,o,n,a,l,s)=>{let i={},r={};const d=e.canvas.height,h=e.canvas.width,u=t.history,x=t.index;switch(n){case"undo":(()=>{if(u.length>0&&x>0){let n=!0;x-1===0&&(n=!1),e.putImageData(u[x-1],0,0),i={...t,index:x-1,canUndo:n,canRedo:!0},s(n),o(i),c(a,l,r={history:{...i}},"history")}})();break;case"redo":(()=>{let n=!0;x+1===u.length-1&&(n=!1),x<u.length-1&&(e.putImageData(u[x+1],0,0),i={...t,index:x+1,canUndo:!0,canRedo:n},o(i),s(!1),c(a,l,r={history:{...i}},"history"))})();break;case"save":u.length<50&&x===u.length?(i={history:[...u,e.getImageData(0,0,h,d)],index:x+1,canUndo:!0,canRedo:!1},o(i),c(a,l,r={history:{...i}},"history")):50===u.length&&x===u.length?(i={history:[...u.slice(1),e.getImageData(0,0,h,d)],index:x,canUndo:!0,canRedo:!1},o(i),c(a,l,r={history:{...i}},"history")):x<u.length&&(i={history:[...u.slice(0,x+1),e.getImageData(0,0,h,d)],index:x+1,canUndo:!0,canRedo:!1},o(i),c(a,l,r={history:{...i}},"history")),s(!1);break;case"clear":i={history:[e.getImageData(0,0,h,d)],index:0,canUndo:!1,canRedo:!1},o(i),s(!0),c(a,l,r={history:{...i}},"history")}},h=(e,t,o)=>{const n=e.canvas.height,a=e.canvas.width;switch(o){case"new":(e=>{e.fillStyle="#FFFFFF",e.fillRect(0,0,a,n)})(e);break;case"save":(e=>{let o=document.createElement("a");o.setAttribute("download",t+".png");let n=e.canvas.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");o.setAttribute("href",n),o.click()})(e)}},u=(e,t,o,n,l,s,i,u,x,g,p,m,b,f,y)=>{let v={};switch(n){case"Startup":h(t,s.name,"new"),d(t,s.history,s.setHistory,"clear",i,u,b),l(!1);break;case"New":((e,t,o)=>{e.setTempDimentions({width:e.dimentions.width,height:e.dimentions.height});const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("New")}}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"Width",children:"Width"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Width",type:"number",value:e.tempDimentions.width,onChange:o=>{e.setTempDimentions({...e.tempDimentions,width:o.target.value}),t("New")}}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"Height",children:"Height"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Height",type:"number",value:e.tempDimentions.height,onChange:o=>{e.setTempDimentions({...e.tempDimentions,height:o.target.value}),t("New")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{e.setDimentions({...e.tempDimentions}),t("New Confirm"),o(null)},Cancel:()=>{o(null),t(!1)}};o({title:"New File",info:n,actions:l})})(s,l,g),l(!1);break;case"New Confirm":g(null),h(t,s.name,"new"),d(t,s.history,s.setHistory,"clear",i,u,b),l(!1);break;case"Save":h(t,s.name,"save"),l(!1);break;case"Save As":((e,t,o)=>{const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New Name",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New name",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{t("Save"),o(null)},Cancel:()=>{o(null),t(!1)}};o({title:"Download As",info:n,actions:l})})(s,l,g),l(!1);break;case"Change Name":((e,t,o)=>{const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,a.jsx)("br",{})]}),l={Confirm:()=>{t("Change Name Confirm"),o(null)},Cancel:()=>{o(null),t(!1)}};o({title:"Change Name",info:n,actions:l})})(s,l,g),l(!1);break;case"Change Name Confirm":y(s.name),g(null),l(!1);break;case"Undo":d(t,s.history,s.setHistory,"undo",i,u,b),l(!1);break;case"Redo":d(t,s.history,s.setHistory,"redo",i,u,b),l(!1);break;case"Zoom In":s.zoom<4&&(s.zoom<1?(s.setZoom(s.zoom+.25),v={zoom:s.zoom+.25}):(s.setZoom(s.zoom+1),v={zoom:s.zoom+1}),c(i,u,v,"zoom")),l(!1);break;case"Zoom Out":s.zoom>.25&&(s.zoom<=1?(s.setZoom(s.zoom-.25),v={zoom:s.zoom-.25}):(s.setZoom(s.zoom-1),v={zoom:s.zoom-1}),c(i,u,v,"zoom")),l(!1);break;case"Zoom Reset":s.setZoom(1),v={zoom:1},c(i,u,v,"zoom"),l(!1);break;case"Zoom Min":v={zoom:.25},c(i,u,v,"zoom"),l(!1);break;case"Zoom Max":v={zoom:4},c(i,u,v,"zoom"),l(!1);break;case"Zoom Default":v={zoom:1},c(i,u,v,"zoom"),l(!1);break;case"Zoom Change":v={zoom:2},c(i,u,v,"zoom"),l(!1);break;case"Cut":case"Copy":case"Paste":case"Select All":case"Select Clear":l(!1);break;case"finished":d(t,s.history,s.setHistory,"save",i,u,b),l(!1);break;case"drawing":s.cursor.down?r(e,s.cursor,s.setCursor,o,n,l):l("finished");break;case"spraying":s.cursor.down?setTimeout((()=>{l("drawing")}),100):l("finished");break;case"settingPoints":s.cursor.down?r(e,s.cursor,s.setCursor,o,n,l):l(!1);break;case"cancel":case"clipping":case"confirm":r(e,s.cursor,s.setCursor,o,n,l);break;case!1:s.cursor.down&&r(e,s.cursor,s.setCursor,o,n,l);break;case"topNavBar":s.setView({...s.view,topNavBar:!s.view.topNavBar}),v={view:{...s.view,topNavBar:!s.view.topNavBar}},c(i,u,v,"view"),l(!1);break;case"bottomNavBar":s.setView({...s.view,bottomNavBar:!s.view.bottomNavBar}),v={view:{...s.view,bottomNavBar:!s.view.bottomNavBar}},c(i,u,v,"view"),l(!1);break;case"toolBar":s.setView({...s.view,toolBar:!s.view.toolBar}),v={view:{...s.view,toolBar:!s.view.toolBar}},c(i,u,v,"view"),l(!1);break;case"Close":m||((e,t,o)=>{o({title:"Warning",info:"Do you want to download the file before closing?",actions:{Save:()=>{t("Save and Close"),o(null)},Close:()=>{e(!0),o(null)},Cancel:()=>{o(null),t(!1)}}})})(b,l,g);break;case"Save and Close":h(t,s.name,"save"),b(!0),l("Close");break;default:l(!1)}},x=e=>{let{action:t,setAction:o,appMenu:s,setAppMenu:i,appDialog:r,setAppDialog:c,contextMenu:d,canClose:h,setCanClose:x,title:g,setTitle:p}=e;const m=(0,n.useRef)(null),b=(0,n.useContext)(l),f={tool:b.tool,subTool:b.subTool,curveControls:b.curveControls,setCurveControls:b.setCurveControls,size:b.size,selectedColor:b.color.selected,color1:b.color[1],setColor1:e=>b.setColor({...b.color,1:e,selected:e}),color2:b.color[2],setColor2:e=>b.setColor({...b.color,2:e,selected:e}),text:b.text,setText:b.setText,clipboard:b.clipboard,setClipboard:b.setClipboard};return(0,n.useEffect)((()=>{let e=m.current,n=e.getContext("2d",{willReadFrequently:!0});u(e,n,f,t,o,b,s,i,0,c,0,h,x,0,p)}),[b.cursor,t]),(0,n.useEffect)((()=>{let e=-1*(b.dimentions.width/2-b.zoom*b.dimentions.width/2)/b.zoom,t=-1*(b.dimentions.height/2-b.zoom*b.dimentions.height/2)/b.zoom;document.getElementById("previewCanvas").style.transform=`scale(${b.zoom}) translate(${e}px,${t}px)`,document.getElementById("drawCanvas").style.transform=`scale(${b.zoom}) translate(${e}px,${t}px)`}),[b.zoom]),(0,a.jsx)("canvas",{ref:m,id:"drawCanvas",height:b.dimentions.height,width:b.dimentions.width})},g=e=>{let{setAction:t,contextMenu:o}=e;const s=(0,n.useContext)(l),r=(0,n.useRef)(null),c=s.cursor,d=s.setCursor,h={tool:s.tool,subTool:s.subTool,curveControls:s.curveControls,setCurveControls:s.setCurveControls,size:s.size,selectedColor:s.color.selected,color1:s.color[1],setColor1:e=>s.setColor({...s.color,1:e}),color2:s.color[2],setColor2:e=>s.setColor({...s.color,2:e}),text:s.text,setText:s.setText,clipboard:s.clipboard,setClipboard:s.setClipboard},u=(e,t)=>{let o=r.current,n=o.getContext("2d",{alpha:!0}),a=o.getBoundingClientRect();const l=n.canvas.width/a.width,s=n.canvas.height/a.height;return{x:(e-a.left)*l,y:(t-a.top)*s}},x=e=>{const t=u(e.clientX,e.clientY);if(0===e.button)switch(e.type){case"mousedown":c.down?d({...c,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):d({...c,down:!0,start:{x:t.x,y:t.y}});break;case"mouseup":d({...c,end:{x:t.x,y:t.y},down:!1});break;case"mousemove":0===e.buttons?d({...c,down:!1,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c.down?d({...c,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):d({...c,current:{x:t.x,y:t.y}});break;case"mouseleave":d({...c,current:{x:t.x,y:t.y}});break;case"mouseenter":0!==e.buttons?d({...c,down:!0,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):d({...c,down:!1,current:{x:t.x,y:t.y}})}},g=e=>{e.preventDefault();const t=u(e.touches[0].clientX,e.touches[0].clientY);if(1===e.touches.length)switch(e.type){case"touchstart":c.down?d({...c,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):d({...c,down:!0,start:{x:t.x,y:t.y}});break;case"touchend":d({...c,end:{x:t.x,y:t.y},down:!1});break;case"touchmove":c.down?d({...c,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):d({...c,current:{x:t.x,y:t.y}})}else d({...c,current:{x:0,y:0},end:{x:t.x,y:t.y},down:!1})};(0,n.useEffect)((()=>{i(r.current,c,h,!0)}),[c,h]);return(0,a.jsx)("canvas",{ref:r,style:{color:h.selectedColor},className:"cursor"+h.tool,id:"previewCanvas",height:s.dimentions.height,width:s.dimentions.width,onMouseDown:e=>{c.selecting||x(e)},onMouseUp:e=>{c.selecting||x(e)},onMouseMove:e=>{c.selecting||x(e)},onMouseLeave:e=>{c.selecting||x(e)},onMouseEnter:e=>{c.selecting||x(e)},onTouchStart:e=>{c.selecting||g(e)},onTouchEnd:e=>{c.selecting||g(e)},onTouchMove:e=>{c.selecting||g(e)},onTouchCancel:e=>{c.selecting||g(e)},onContextMenu:e=>{c.selecting||(e=>{e.preventDefault();let n={Undo:{action:()=>t("Undo"),disabled:!s.history.canUndo},Redo:{action:()=>t("Redo"),disabled:!s.history.canRedo},LineBreak:{},"Zoom In":{action:()=>t("Zoom In"),disabled:4===s.zoom},"Zoom Out":{action:()=>t("Zoom Out"),disabled:.25===s.zoom},"Zoom Reset":{action:()=>t("Zoom Reset"),disabled:1===s.zoom}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e)}})};function p(){const e=(0,n.useContext)(l),t=e.cursor,o=e.setCursor,s=e.zoom,i=e.tool,r=e.subTool,c=e.setSubTool,d=e.clipboard,[h,u]=(0,n.useState)({display:"none",left:"0px",top:"0px",height:"0px",width:"0px",canUsePointer:!0}),[x,g]=(0,n.useState)({display:"none",left:"0px",top:"0px",diameter:"0px"}),[p,m]=(0,n.useState)({display:"none",left:"0px",top:"0px",width:"0px",height:"0px"}),[b,f]=(0,n.useState)([0,0,!0]),[y,v]=(0,n.useState)([0,0,0,0]),[w,C]=(0,n.useState)([0,0,0]),M=e=>{let t,o,n=!1;return 0===e.button?0!==e.clientX&&0!==e.clientY&&(t=e.clientX,o=e.clientY,n=!0):0!==e.touches[0].clientX&&0!==e.touches[0].clientY&&(t=e.touches[0].clientX,o=e.touches[0].clientY,n=!0),n?[t,o,!0]:[0,0,!1]},j=(e,n)=>{e.stopPropagation(),o({...t,selecting:!0});const a=M(e);let l=0,s=0;!1!==a[2]&&(-1!==n.indexOf("N")?s=a[1]-Math.min(t.start.y,t.end.y):-1!==n.indexOf("S")&&(s=a[1]-Math.max(t.start.y,t.end.y)),-1!==n.indexOf("W")?l=a[0]-Math.min(t.start.x,t.end.x):-1!==n.indexOf("E")&&(l=a[0]-Math.max(t.start.x,t.end.x)),f([l,s]))};function S(e,o,n){let a=!1,l=!1;t.start.x>t.end.x&&(a=!0),t.start.y>t.end.y&&(l=!0);let s=t.start.x,i=t.start.y,r=t.end.x,c=t.end.y;return-1!==n.indexOf("N")?l?c=o[1]-b[1]:i=o[1]-b[1]:-1!==n.indexOf("S")&&(l?i=o[1]-b[1]:c=o[1]-b[1]),-1!==n.indexOf("E")?a?s=o[0]-b[0]:r=o[0]-b[0]:-1!==n.indexOf("W")&&(a?r=o[0]-b[0]:s=o[0]-b[0]),[s,i,r,c]}const T=(e,n)=>{e.preventDefault(),e.stopPropagation();const a=M(e);if(!1===a[2])return;const l=S(0,a,n);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]}})},k=(e,n)=>{e.preventDefault(),e.stopPropagation();const a=M(e);if(!1===a[2])return;const l=S(0,a,n);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]},selecting:!1})},D=e=>{e.stopPropagation(),o({...t,selecting:!0});const n=M(e);if(!1===n[2])return;if("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id)return;let a=0,l=0,s=0,i=0;a=n[0]-t.start.x,l=n[1]-t.start.y,s=n[0]-t.end.x,i=n[1]-t.end.y,v([a,l,s,i])},P=e=>{e.preventDefault(),e.stopPropagation();const n=M(e);!1!==n[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:n[0]-y[0],y:n[1]-y[1]},end:{x:n[0]-y[2],y:n[1]-y[3]}}))},I=e=>{e.preventDefault(),e.stopPropagation();const n=M(e);!1!==n[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:n[0]-y[0],y:n[1]-y[1]},end:{x:n[0]-y[2],y:n[1]-y[3]},selecting:!1}))},B=e=>{e.preventDefault();const t=M(e);if(!1===t[2])return;let o=Number(x.top.slice(0,-2)),n=Number(x.left.slice(0,-2)),a=Number(x.diameter.slice(0,-2)),l=n+a/2+w[3],s=o+a/2+w[4],i=l>t[0]?l-t[0]:t[0]-l,d=s>t[1]?s-t[1]:t[1]-s,h=Math.sqrt(Math.pow(i,2)+Math.pow(d,2)),u=Math.acos((Math.pow(i,2)+Math.pow(h,2)-Math.pow(d,2))/(2*i*h))/(Math.PI/180),g=0;t[0]>l&&t[1]<s?g=90-u:t[0]>l&&t[1]>s?g=90+u:t[0]<l&&t[1]>s?g=270-u:t[0]<l&&t[1]<s&&(g=270+u),c({...r,angle:g})};return(0,n.useEffect)((()=>{"Shape"===i&&"Line"!==r.shape&&"Curve"!==r.shape?(u({...h,display:"block"}),"Shape"===i?(g({...x,display:"block"}),!0===r.stretch?m({...p,display:"block"}):m({...p,display:"none"})):(g({...x,display:"none"}),m({...p,display:"none"}))):"Select"===i?(g({...x,display:"none"}),m({...p,display:"none"}),"none"===d.state?u({...h,display:"block"}):u({...h,display:"none"})):"Text"===i?(u({...h,display:"block"}),g({...x,display:"none"}),m({...p,display:"none"})):(u({...h,display:"none"}),g({...x,display:"none"}),m({...p,display:"none"}))}),[i,r,d]),(0,n.useEffect)((()=>{let e=Math.min(t.start.x,t.end.x),o=Math.max(t.start.x,t.end.x),n=Math.min(t.start.y,t.end.y),a=Math.max(t.start.y,t.end.y)-n,l=o-e;u({...h,left:Math.floor(e*s)+"px",top:Math.floor(n*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(a*s)+"px"});let i=e+Math.floor(l/2),r=n+Math.floor(a/2),c=Math.min(l,a);g({...x,left:Math.floor((i-c/2)*s)+"px",top:Math.floor((r-c/2)*s)+"px",diameter:Math.floor(c*s)+"px"}),m({...p,left:Math.floor(e*s)+"px",top:Math.floor(n*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(a*s)+"px"})}),[t,s]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{id:"drawDocSelectionBox",style:{display:h.display,top:h.top,left:h.left,width:h.width,height:h.height,pointerEvents:t.down?"none":"auto"},draggable:!0,onDragStart:e=>{t.down||D(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||I(e)},children:["Text"===i&&(0,a.jsx)("div",{id:"drawDocSelectionBoxDragPivot"}),(0,a.jsx)("div",{id:"drawDocSelectionBoxNW",draggable:!0,onDragStart:e=>{t.down||j(e,"NW")},onDrag:e=>{t.down||T(e,"NW")},onDragEnd:e=>{t.down||k(e,"NW")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxN",draggable:!0,onDragStart:e=>{t.down||j(e,"N")},onDrag:e=>{t.down||T(e,"N")},onDragEnd:e=>{t.down||k(e,"N")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxNE",draggable:!0,onDragStart:e=>{t.down||j(e,"NE")},onDrag:e=>{t.down||T(e,"NE")},onDragEnd:e=>{t.down||k(e,"NE")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxE",draggable:!0,onDragStart:e=>{t.down||j(e,"E")},onDrag:e=>{t.down||T(e,"E")},onDragEnd:e=>{t.down||k(e,"E")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxSE",draggable:!0,onDragStart:e=>{t.down||j(e,"SE")},onDrag:e=>{t.down||T(e,"SE")},onDragEnd:e=>{t.down||k(e,"SE")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxS",draggable:!0,onDragStart:e=>{t.down||j(e,"S")},onDrag:e=>{t.down||T(e,"S")},onDragEnd:e=>{t.down||k(e,"S")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxSW",draggable:!0,onDragStart:e=>{t.down||j(e,"SW")},onDrag:e=>{t.down||T(e,"SW")},onDragEnd:e=>{t.down||k(e,"SW")}}),(0,a.jsx)("div",{id:"drawDocSelectionBoxW",draggable:!0,onDragStart:e=>{t.down||j(e,"W")},onDrag:e=>{t.down||T(e,"W")},onDragEnd:e=>{t.down||k(e,"W")}})]}),(0,a.jsx)("div",{id:"drawDocSelectionEllipse",style:{display:p.display,top:p.top,left:p.left,width:p.width,height:p.height,rotate:r.angle+"deg"},draggable:!0,onDragStart:e=>{t.down||D(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||I(e)}}),(0,a.jsx)("div",{id:"drawDocSelectionCircle",style:{display:x.display,top:x.top,left:x.left,width:x.diameter,height:x.diameter,rotate:r.angle+"deg"},draggable:!0,onDragStart:e=>{t.down||D(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||I(e)},children:(0,a.jsx)("div",{id:"drawDocSelectionCirclePoint",draggable:!0,onDragStart:e=>{t.down||(e=>{o({...t,selecting:!0});const n=M(e),a=document.getElementById("previewCanvas").getBoundingClientRect();!1!==n[2]&&C([n[0],n[1],r.angle,a.left,a.top])})(e)},onDrag:e=>{t.down||B(e)},onDragEnd:e=>{t.down||(e=>{B(e),o({...t,selecting:!1})})(e)}})}),"Text"===i&&!t.down&&(0,a.jsx)("textarea",{id:"drawDocSelectionBoxText",style:{display:h.display,top:h.top,left:h.left,width:h.width,height:h.height,caretColor:e.text.color,fontSize:e.size*e.zoom+"px",fontFamily:e.text.fontFamily,lineHeight:e.text.lineHeight},spellCheck:!1,value:e.text.text,onChange:t=>e.setText({...e.text,text:t.target.value})})]})}var m=o(9804),b=o(7980),f=o(5051),y=o(3825),v=o(7196),w=o(9106);const C=e=>{let{setAction:t,contextMenu:o}=e;const s=(0,n.useContext)(l);if(s.view.topNavBar)return(0,a.jsxs)("nav",{id:"drawDocTopNavBar",onContextMenu:e=>(e=>{e.preventDefault();let n={Hide:{action:()=>t("topNavBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e),children:[(0,a.jsx)("button",{title:"Undo",onClick:()=>t("Undo"),disabled:!s.history.canUndo,children:(0,a.jsx)(m.qHd,{})}),(0,a.jsx)("button",{title:"Redo",onClick:()=>t("Redo"),disabled:!s.history.canRedo,children:(0,a.jsx)(m.qQW,{})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"New File",onClick:()=>t("New"),children:(0,a.jsx)(b.QB2,{})}),(0,a.jsx)("button",{title:"Download File",onClick:()=>t("Save"),disabled:!(s.history.canRedo||s.history.canUndo),children:(0,a.jsx)(b.RZ0,{})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsx)("button",{title:"Color 1",className:s.color.selected===s.color[1]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[1]}),children:(0,a.jsx)("label",{htmlFor:"drawColor1",style:{textDecoration:s.color.selected===s.color[1]?"underline":""},onClick:e=>e.preventDefault(),children:"1"})}),(0,a.jsx)(w.A,{color:s.color[1],setColor:e=>{s.setColor({...s.color,selected:e,1:e})},useAlpha:!1})]}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("div",{style:{display:"flex"},children:[(0,a.jsx)("button",{title:"Color 2",className:s.color.selected===s.color[2]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[2]}),children:(0,a.jsx)("label",{htmlFor:"drawColor2",style:{textDecoration:s.color.selected===s.color[2]?"underline":""},onClick:e=>e.preventDefault(),children:"2"})}),(0,a.jsx)(w.A,{color:s.color[2],setColor:e=>s.setColor({...s.color,selected:e,2:e}),useAlpha:!1})]}),(0,a.jsx)("vertical-rect",{}),"Magnifier"===s.tool&&(0,a.jsxs)("select",{value:s.zoom,onChange:e=>{(e=>{s.setZoom(Number(e.target.value)),"0.25"===e.target.value?t("Zoom Min"):"4"===e.target.value?t("Zoom Max"):"1"===e.target.value?t("Zoom Default"):t("Zoom Change")})(e)},title:"Zoom",children:[(0,a.jsx)("option",{value:.25,children:"25%"}),(0,a.jsx)("option",{value:.5,children:"50%"}),(0,a.jsx)("option",{value:.75,children:"75%"}),(0,a.jsx)("option",{value:1,children:"100%"}),(0,a.jsx)("option",{value:2,children:"200%"}),(0,a.jsx)("option",{value:3,children:"300%"}),(0,a.jsx)("option",{value:4,children:"400%"})]}),"Select"!==s.tool&&"Pipette"!==s.tool&&"Magnifier"!==s.tool&&"Bucket"!==s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y._DL,{}),(0,a.jsx)("input",{type:"number",min:"1",max:"100",value:s.size,onChange:e=>s.setSize(Number(e.target.value)),title:"Text"===s.tool?"Font Size":"Shape"===s.tool?"Line Width":"Radius"})]}),"Text"===s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(v.Oui,{}),(0,a.jsxs)("select",{title:"Font Family",value:s.text.fontFamily,onChange:e=>s.setText({...s.text,fontFamily:e.target.value}),children:[(0,a.jsx)("option",{children:"Arial"}),(0,a.jsx)("option",{children:"Times New Roman"}),(0,a.jsx)("option",{children:"Monospace"}),(0,a.jsx)("option",{children:"Verdana"}),(0,a.jsx)("option",{children:"Georgia"}),(0,a.jsx)("option",{children:"Courier New"}),(0,a.jsx)("option",{children:"Tahoma"}),(0,a.jsx)("option",{children:"Garamond"}),(0,a.jsx)("option",{children:"Impact"}),(0,a.jsx)("option",{children:"Comic Sans MS"}),(0,a.jsx)("option",{children:"Lucida Console"}),(0,a.jsx)("option",{children:"Lucida Sans Unicode"}),(0,a.jsx)("option",{children:"Palatino Linotype"}),(0,a.jsx)("option",{children:"Symbol"}),(0,a.jsx)("option",{children:"Wingdings"}),(0,a.jsx)("option",{children:"Helvetica"})]}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(f.kZ9,{}),(0,a.jsx)("input",{title:"Line Height",type:"number",step:"0.01",min:"0",value:s.text.lineHeight,onChange:e=>{s.setText({...s.text,lineHeight:e.target.value})}}),(0,a.jsx)("vertical-rect",{})]}),"Shape"===s.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("vertical-rect",{}),(0,a.jsx)(v.u8p,{}),(0,a.jsxs)("select",{title:"Shape",value:s.subTool.shape,onChange:e=>s.setSubTool({...s.subTool,shape:e.target.value}),children:[(0,a.jsx)("option",{children:"Line"}),(0,a.jsx)("option",{children:"Curve"}),(0,a.jsx)("option",{children:"Circle"}),(0,a.jsx)("option",{children:"Rectangle"}),(0,a.jsx)("option",{children:"Polygon"}),(0,a.jsx)("option",{children:"Star"}),(0,a.jsx)("option",{children:"Arrow"}),(0,a.jsx)("option",{children:"Heart"})]}),(0,a.jsx)("vertical-rect",{}),("Polygon"===s.subTool.shape||"Star"===s.subTool.shape)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.RIm,{}),(0,a.jsx)("input",{type:"number",title:"Sides",value:s.subTool.sides,onChange:e=>s.setSubTool({...s.subTool,sides:e.target.value}),min:"3",step:"1"}),(0,a.jsx)("vertical-rect",{})]})]})]})},M=e=>{let{subtool:t,isSelected:o}=e,l=(0,n.useRef)(null);const s={drawCircleIcon:(e,o,n)=>{e.beginPath(),e.arc(o/2,n/2,n/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath()},drawEllipseIcon:(e,o,n)=>{e.scale(1,.5),e.beginPath(),e.beginPath(),e.arc(o/2,n,n/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath(),e.scale(1,2)},drawRectangleIcon:(e,o,n)=>{t.fill&&e.fillRect(0,n/4,o,n/2),e.strokeRect(0,n/4,o,n/2)},drawPolygonIcon:(e,o,n)=>{e.beginPath();for(let a=0;a<t.sides;a++)e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*a/t.sides-Math.PI/2),n/2+(n/2-3)*Math.sin(2*Math.PI*a/t.sides-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawLineIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/4,2),e.lineTo(3*t/4,o-2),e.closePath(),e.stroke()},drawCurveIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/6,2),e.bezierCurveTo(5*t/6,o/5,t/6,4*o/5-2,5*t/6,o-2),e.stroke()},drawStarIcon:(e,o,n)=>{e.beginPath(),e.moveTo(o/2,3);for(let a=0;a<2*t.sides;a++)a%2===0?e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*a/(2*t.sides)-Math.PI/2),n/2+(n/2-3)*Math.sin(2*Math.PI*a/(2*t.sides)-Math.PI/2)):e.lineTo(o/2+(o/4-3)*Math.cos(2*Math.PI*a/(2*t.sides)-Math.PI/2),n/2+(n/4-3)*Math.sin(2*Math.PI*a/(2*t.sides)-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawArrowIcon:(e,o,n)=>{e.beginPath(),e.moveTo(2,n/3),e.lineTo(o/2,n/3),e.lineTo(o/2,2),e.lineTo(o-2,n/2),e.lineTo(o/2,n-2),e.lineTo(o/2,2*n/3),e.lineTo(2,2*n/3),e.closePath(),e.stroke(),t.fill&&e.fill()},drawHeartIcon:(e,o,n)=>{e.beginPath(),e.moveTo(o/2,n-3),e.arc(o/4+1,n/3,o/4-1,3*Math.PI/4,0,!1),e.arc(3*o/4-1,n/3,o/4-1,Math.PI,Math.PI/4,!1),e.closePath(),e.stroke(),t.fill&&e.fill()}};return(0,n.useEffect)((()=>{const e=l.current.getContext("2d"),o=e.canvas.height,n=e.canvas.width;e.clearRect(0,0,n,o),e.fillStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.strokeStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.lineWidth=2,s["draw"+t.shape+"Icon"](e,n,o)}),[t,o]),(0,a.jsx)("canvas",{ref:l,id:"shapeCanvas",width:"25",height:"25",title:"Custom Shape"})};var j=o(2639),S=o(8973),T=o(2021),k=o(7962),D=o(9698);const P=e=>{let{setAction:t,contextMenu:o,isSelected:s}=e;const i=(0,n.useContext)(l),r=i.tool,c=i.subTool,d=i.setTool,h={Brush:(0,a.jsx)(j.Nw5,{title:"Brush"}),Eraser:(0,a.jsx)(b.qpr,{title:"Eraser"}),Bucket:(0,a.jsx)(b.ATI,{title:"Bucket"}),Spray:(0,a.jsx)(b.bOX,{title:"Spray Can"}),Text:(0,a.jsx)(T.tEi,{title:"Insert Text"}),Pipette:(0,a.jsx)(S._e3,{title:"Color Picker"}),Magnifier:(0,a.jsx)(k.JJh,{title:"Zoom"}),Select:(0,a.jsx)(D.ZdE,{title:"Selection"}),Shape:(0,a.jsx)(M,{subtool:c,isSelected:s})};if(i.view.toolBar)return(0,a.jsx)("nav",{id:"drawDocToolBar",onContextMenu:e=>(e=>{e.preventDefault();let n={Hide:{action:()=>t("toolBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(n)})(e),children:Object.keys(h).map((e=>(0,a.jsx)("button",{onClick:()=>d(e),className:r===e?"buttonActive":"",children:h[e]},e+"drawToolDropdown")))})},I=e=>{let{action:t,setAction:o,contextMenu:s}=e;const i=(0,n.useContext)(l);if(i.view.bottomNavBar)return(0,a.jsxs)("nav",{id:"drawDocBottomNavBar",onContextMenu:e=>(e=>{e.preventDefault();let t={Hide:{action:()=>o("bottomNavBar")}};s.setOpen(),s.setPosition(e.clientX,e.clientY),s.setContent(t)})(e),children:["Text"===i.tool&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Confirm Text",onClick:()=>o("confirm"),children:(0,a.jsx)("small",{children:"Confirm"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Use Fill",className:i.text.fill?"buttonActive":"",onClick:()=>{i.setText({...i.text,fill:!i.text.fill})},children:(0,a.jsx)("small",{children:"Fill"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Use Stroke",className:i.text.stroke?"buttonActive":"",onClick:()=>{i.setText({...i.text,stroke:!i.text.stroke})},children:(0,a.jsx)("small",{children:"Stroke"})}),(0,a.jsx)("input",{title:"Stroke Width",type:"number",step:"1",min:"1",max:i.size-1,value:i.text.strokeWidth,onChange:e=>{i.setText({...i.text,strokeWidth:e.target.value})}}),(0,a.jsx)("vertical-rect",{})]}),"Select"===i.tool?(0,a.jsx)(a.Fragment,{children:"clipping"===t&&"carry"===i.clipboard.state?(0,a.jsx)("button",{title:"Paste",onClick:()=>{o("confirm"),i.setClipboard({...i.clipboard,state:"paste"})},children:(0,a.jsx)("small",{children:"Paste"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Cut",onClick:()=>{o("clipping"),i.setClipboard({...i.clipboard,state:"cut"})},children:(0,a.jsx)("small",{children:"Cut"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Copy",onClick:()=>{o("clipping"),i.setClipboard({...i.clipboard,state:"copy"})},children:(0,a.jsx)("small",{children:"Copy"})})]})}):null,"Shape"===i.tool?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Confirm Shape",onClick:()=>o("confirm"),children:(0,a.jsx)("small",{children:"Confirm"})}),(0,a.jsx)("vertical-rect",{}),"Curve"===i.subTool.shape&&(0,a.jsx)("button",{title:"Cancel Shape",onClick:()=>o("cancel"),children:(0,a.jsx)("small",{children:"Cancel"})}),"Line"!==i.subTool.shape&&"Curve"!==i.subTool.shape?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{title:"Fill",className:i.subTool.fill?"buttonActive":"",onClick:()=>i.setSubTool({...i.subTool,fill:!i.subTool.fill}),children:(0,a.jsx)("small",{children:"Fill"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsx)("button",{title:"Stretch",className:i.subTool.stretch?"buttonActive":"",onClick:()=>i.setSubTool({...i.subTool,stretch:!i.subTool.stretch}),children:(0,a.jsx)("small",{children:"Stretch"})}),(0,a.jsx)("vertical-rect",{}),(0,a.jsxs)("button",{children:[(0,a.jsx)("label",{htmlFor:"rotationAngle",children:"Rotation"}),(0,a.jsx)("input",{type:"number",title:"Rotation Angle",id:"rotationAngle",value:i.subTool.angle,onChange:e=>i.setSubTool({...i.subTool,angle:e.target.value}),step:"1"})]}),(0,a.jsx)("vertical-rect",{}),"Polygon"===i.subTool.shape||"Star"===i.subTool.shape?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{children:[(0,a.jsx)("label",{htmlFor:"startAngle",children:"Start Angle"}),(0,a.jsx)("input",{type:"number",title:"Start Angle",id:"startAngle",value:i.subTool.startAngle,onChange:e=>i.setSubTool({...i.subTool,startAngle:e.target.value}),step:"1"})]}),(0,a.jsx)("vertical-rect",{})]}):null]}):null]}):null]})};function B(e){const t=e.action,o=e.setAction,i=e.appMenu,r=e.setAppMenu,c=e.appDialog,d=e.setAppDialog,h=e.contextMenu,u=e.canClose,m=e.setCanClose,b=e.isSelected,f=e.title,y=e.setTitle;(0,n.useContext)(l);return(0,a.jsx)(s,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C,{setAction:o,contextMenu:h}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%",margin:"0px"},children:[(0,a.jsx)(P,{setAction:o,contextMenu:h,isSelected:b}),(0,a.jsxs)("canvas-container",{children:[(0,a.jsx)(x,{action:t,setAction:o,appMenu:i,setAppMenu:r,appDialog:c,setAppDialog:d,contextMenu:h,canClose:u,setCanClose:m,title:f,setTitle:y}),(0,a.jsx)(g,{setAction:o,contextMenu:h}),(0,a.jsx)(p,{})]})]}),(0,a.jsx)(I,{action:t,setAction:o,contextMenu:h})]})})}},9106:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(5043),a=o(7950);function l(e){let t=e[0],o=e[1],n=e[2];t/=255,o/=255,n/=255;let a=Math.min(t,o,n),l=Math.max(t,o,n),s=l-a,i=0,r=0,c=(l+a)/2;return 0===s?(r=0,i=0):(r=c<=.5?s/(l+a):s/(2-l-a),l===t?i=(o-n)/s:l===o?i=(n-t)/s+2:l===n&&(i=(t-o)/s+4)),i=Math.round(60*i),i<0&&(i+=360),r=Math.abs(100*r).toFixed(0),c=(100*c).toFixed(0),[i,r+"%",c+"%"]}function s(e){var t=e[0],o=e[1],n=e[2],a=e[3];t=parseInt(e[1],16),o=parseInt(e[2],16),n=parseInt(e[3],16),a=parseInt(e[4],16);t/=255,o/=255,n/=255;let l=Math.min(t,o,n),s=Math.max(t,o,n),i=s-l,r=0,c=0,d=(s+l)/2;return 0===i?(c=0,r=0):(c=d<=.5?i/(s+l):i/(2-s-l),s===t?r=(o-n)/i:s===o?r=(n-t)/i+2:s===n&&(r=(t-o)/i+4)),r=Math.round(60*r),r<0&&(r+=360),c=Math.abs(100*c).toFixed(0),d=(100*d).toFixed(0),[r,c+"%",d+"%",a]}o(7915);var i=o(579);function r(e){let{color:t,setColor:o,useAlpha:r}=e;const c=(0,n.useRef)(null),d=(0,n.useRef)(null),h=(0,n.useRef)(null),u=(0,n.useRef)(null),[x,g]=(0,n.useState)({x:0,y:0}),[p,m]=(0,n.useState)(0),[b,f]=(0,n.useState)(0),[y,v]=(0,n.useState)(!1),[w,C]=(0,n.useState)(0),[M,j]=(0,n.useState)(50),[S,T]=(0,n.useState)(100),[k,D]=(0,n.useState)(100);(0,n.useEffect)((()=>{y&&c.current.focus()}),[y]);(0,n.useEffect)((()=>{if(t)if(r){let n=[];if("#"===t[0])n=s(function(e){var t;return 5===e.length?0==(t=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e))[4]&&(t[4]="ff"):9===e.length?t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e):8===e.length&&((t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))[4]="ff"),t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16)/255]:null}(t));else if("rgba"===t.slice(0,4))n=s(t);else if("hsla"===t.slice(0,4))for(let a=0;a<t.length;a++){"("===t[a]?e=a+1:")"===t[a]?(o=a,n.push(t.slice(e,o))):","===t[a]&&(n.push(t.slice(e,a)),e=a+1)}if(C(Number(n[0])),T(Number(n[1].slice(0,n[1].length-1))),j(Number(n[2].slice(0,n[2].length-1))),D(Number(n[3])),y){const e=d.current.getBoundingClientRect();g({x:n[0]/360*e.width,y:(100-n[2].slice(0,n[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-n[1].slice(0,n[1].length-1))/100*t.height);const o=u.current.getBoundingClientRect();f(n[3]*o.width)}}else{let n=[];if("#"===t[0])n=l(function(e){var t;return(t=4===e.length?/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e):/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}(t));else if("rgb"===t.slice(0,3))n=l(t);else if("hsl"===t.slice(0,3))for(let a=0;a<t.length;a++){var e,o;"("===t[a]?e=a+1:")"===t[a]?(o=a,n.push(t.slice(e,o))):","===t[a]&&(n.push(t.slice(e,a)),e=a+1)}else n=function(e){switch(e){case"red":case"maroon":return[0,"100%","50%"];case"green":case"lime":return[120,"100%","50%"];case"blue":case"aqua":case"navy":return[240,"100%","50%"];case"yellow":case"olive":return[60,"100%","50%"];case"cyan":case"teal":return[180,"100%","50%"];case"magenta":return[300,"100%","50%"];case"black":default:return[0,"0%","0%"];case"white":return[0,"0%","100%"];case"gray":case"grey":return[0,"0%","50%"];case"lightgray":case"lightgrey":return[0,"0%","75%"];case"darkgray":case"darkgrey":return[0,"0%","25%"];case"brown":return[30,"50%","50%"];case"orange":return[30,"100%","50%"];case"purple":return[270,"100%","50%"];case"pink":return[330,"100%","50%"]}}(t);if(C(Number(n[0])),T(Number(n[1].slice(0,n[1].length-1))),j(Number(n[2].slice(0,n[2].length-1))),y){const e=d.current.getBoundingClientRect();g({x:n[0]/360*e.width,y:(100-n[2].slice(0,n[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-n[1].slice(0,n[1].length-1))/100*t.height)}}}),[y,t,r]);(0,n.useEffect)((()=>{if(d.current){(e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height);let t=e.canvas.width/360,o=e.canvas.height/100;for(let n=0;n<360;n++)for(let a=0;a<100;a++)e.fillStyle=`hsl(${n},${S}%,${100-a}%)`,e.fillRect(n*t,a*o,(n+1)*t,(a+1)*o)})(d.current.getContext("2d",{alpha:!1}))}}),[y,S]);const P=e=>{if(0!==e.buttons){const t=d.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(g({x:o,y:n}),C(Math.floor(360*o/t.width)),j(100-Math.floor(100*n/t.height)))}},I=e=>{if(1===e.touches.length){const t=d.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(g({x:o,y:n}),C(Math.floor(360*o/t.width)),j(100-Math.floor(100*n/t.height)))}},B=e=>{if(0!==e.buttons){const t=h.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(T(100-Math.floor(100*n/t.height)),m(n))}},N=e=>{if(1===e.touches.length){const t=h.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(T(100-Math.floor(100*n/t.height)),m(n))}},z=e=>{if(0!==e.buttons){const t=u.current.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(D(Math.floor(100*o/t.width)/100),f(o))}},R=e=>{if(1===e.touches.length){const t=u.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&n>=0&&n<=t.height&&(D(Math.floor(100*o/t.width)/100),f(o))}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("color-picker-button",{onClick:()=>v(!y),children:(0,i.jsx)("div",{children:(0,i.jsx)("button",{style:{background:t}})})}),y&&(0,a.createPortal)((0,i.jsxs)("color-picker-window",{tabIndex:"0",ref:c,onBlur:e=>{var t;(t=e).currentTarget.contains(t.relatedTarget)||v(!1)},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("hue-light-map",{children:[(0,i.jsx)("canvas",{onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>I(e),onTouchStart:e=>I(e),onTouchEnd:e=>I(e),ref:d,width:"180",height:"180",style:{opacity:r?k:1}}),(0,i.jsx)("slider-thumb",{style:{top:x.y,left:x.x,background:r?`hsla(${w},${S}%,${M}%, ${k})`:`hsl(${w},${S}%,${M}%)`},onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>I(e),onTouchStart:e=>I(e),onTouchEnd:e=>I(e)})]}),(0,i.jsxs)("saturation-slider",{title:"Saturation",children:[(0,i.jsx)("div",{ref:h,style:{background:`linear-gradient(0deg, hsl(${w},0%,${M}%), hsla(${w},100%,${M}%))`},onMouseDown:e=>B(e),onMouseMove:e=>B(e),onTouchMove:e=>N(e),onTouchStart:e=>N(e),onTouchEnd:e=>N(e)}),(0,i.jsx)("slider-thumb",{style:{top:p,background:`hsla(${w},${S}%,${M}%, ${k})`},onMouseDown:e=>B(e),onMouseMove:e=>B(e),onTouchMove:e=>N(e),onTouchStart:e=>N(e),onTouchEnd:e=>N(e)})]})]}),r&&(0,i.jsxs)("alpha-slider",{title:"Alpha",children:[(0,i.jsx)("div",{ref:u,style:{background:`linear-gradient(90deg, hsla(${w},${S}%,${M}%, 0), hsla(${w},${S}%,${M}%, 1))`},onMouseDown:e=>z(e),onMouseMove:e=>z(e),onTouchMove:e=>R(e),onTouchStart:e=>R(e),onTouchEnd:e=>R(e)}),(0,i.jsx)("slider-thumb",{style:{left:b,background:`hsl(${w},${S}%,${M}%, ${k})`},onMouseDown:e=>z(e),onMouseMove:e=>z(e),onTouchMove:e=>R(e),onTouchStart:e=>R(e),onTouchEnd:e=>R(e)})]}),(0,i.jsxs)("color-inputs",{children:[(0,i.jsxs)("div",{children:["Hue",(0,i.jsx)("input",{type:"number",min:"0",max:"360",value:w,onChange:e=>(e=>{C(e);const t=d.current.getBoundingClientRect();g({...x,x:e/360*t.width})})(e.target.value)})]}),(0,i.jsxs)("div",{children:["Lum.",(0,i.jsx)("input",{type:"number",min:"0",max:"100",value:M,onChange:e=>(e=>{j(e);const t=d.current.getBoundingClientRect();g({...x,y:(100-e)/100*t.height})})(e.target.value)})]}),(0,i.jsxs)("div",{children:["Sat.",(0,i.jsx)("input",{type:"number",min:"0",max:"100",value:S,onChange:e=>(e=>{T(e);const t=h.current.getBoundingClientRect();m((100-e)/100*t.height)})(e.target.value)})]}),r&&(0,i.jsxs)("div",{children:["Alpha",(0,i.jsx)("input",{type:"number",min:"0",max:"1",step:"0.01",value:k,onChange:e=>(e=>{D(e);const t=u.current.getBoundingClientRect();f(e*t.width)})(e.target.value)})]})]}),(0,i.jsx)("color-button",{children:(0,i.jsx)("button",{style:{background:r?`hsla(${w},${S}%,${M}%, ${k})`:`hsl(${w},${S}%,${M}%)`},onClick:()=>{o(r?`hsla(${w},${S}%,${M}%, ${k})`:`hsl(${w},${S}%,${M}%)`)},children:"Apply"})})]}),document.getElementById("root"))]})}}}]);
//# sourceMappingURL=7763.7a9159b8.chunk.js.map