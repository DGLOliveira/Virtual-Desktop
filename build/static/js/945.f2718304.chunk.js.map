{"version":3,"file":"static/js/945.f2718304.chunk.js","mappings":"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","sources":["Apps/Gyroscope/index.jsx"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport { Canvas, useFrame } from \"@react-three/fiber\";\r\nimport { useGLTF, OrthographicCamera } from \"@react-three/drei\";\r\nimport GyroscopeObject from \"./Assets/Gyroscope.glb\";\r\nimport \"./style.css\";\r\nexport default function Gyroscope() {\r\n    const [state, setState] = useState(\"ready\");\r\n    const [angles, setAngles] = useState({\r\n        heading: 0,\r\n        pitch: 0,\r\n        roll: 0\r\n    });\r\n    var sensor = null;\r\n    const SENSOR_UPDATE_FREQUENCY = 4; //keep value low to avoid battery drain\r\n\r\n    //3D model of Gyroscope\r\n    const Gyro = () => {\r\n        const object = useGLTF(GyroscopeObject);\r\n        const ref = useRef();\r\n        let externalGimbal, internalGimbal, axis, rotor;\r\n        object.scene.children.forEach((child) => {\r\n            child.name === \"External_Gimbal\" ? (externalGimbal = child) : null;\r\n            child.name === \"Internal_Gimbal\" ? (internalGimbal = child) : null;\r\n            child.name === \"Axis\" ? (axis = child) : null;\r\n        })\r\n        let accDelta = 0;\r\n        //Animates 3D model\r\n        //Sensor quaternion values cannot be used directly\r\n        //Note that euler angles must be converted back to quaternion in order to prevent Gimbal lock\r\n        useFrame((state, delta) => {\r\n            if (state === \"running\") {\r\n                accDelta += delta * 10;\r\n            }\r\n            if (externalGimbal !== undefined && internalGimbal !== undefined && axis !== undefined) {\r\n                let alpha = angles.roll + Math.PI;\r\n                let beta = angles.pitch + Math.PI / 2 + accDelta;\r\n                let gama = accDelta;\r\n                externalGimbal.quaternion.w = Math.cos(alpha / 2);\r\n                externalGimbal.quaternion.y = Math.sin(alpha / 2);\r\n                externalGimbal.quaternion.x = 0;\r\n                externalGimbal.quaternion.z = 0;\r\n                internalGimbal.quaternion.w = Math.cos(alpha / 2) * Math.cos(beta / 2);\r\n                internalGimbal.quaternion.y = Math.sin(alpha / 2) * Math.cos(beta / 2);\r\n                internalGimbal.quaternion.x = Math.cos(alpha / 2) * Math.sin(beta / 2);\r\n                internalGimbal.quaternion.z = - Math.sin(alpha / 2) * Math.sin(beta / 2);\r\n                axis.quaternion.w = Math.cos(alpha / 2) * Math.cos((beta + Math.PI / 2) / 2) * Math.cos(gama / 2) + Math.sin(alpha / 2) * Math.sin((beta + Math.PI / 2) / 2) * Math.sin(gama / 2);\r\n                axis.quaternion.y = Math.sin(alpha / 2) * Math.cos((beta + Math.PI / 2) / 2) * Math.cos(gama / 2) - Math.cos(alpha / 2) * Math.sin((beta + Math.PI / 2) / 2) * Math.sin(gama / 2);\r\n                axis.quaternion.x = Math.cos(alpha / 2) * Math.sin((beta + Math.PI / 2) / 2) * Math.cos(gama / 2) + Math.sin(alpha / 2) * Math.cos((beta + Math.PI / 2) / 2) * Math.sin(gama / 2);\r\n                axis.quaternion.z = Math.cos(alpha / 2) * Math.cos((beta + Math.PI / 2) / 2) * Math.sin(gama / 2) - Math.sin(alpha / 2) * Math.sin((beta + Math.PI / 2) / 2) * Math.cos(gama / 2);\r\n            }\r\n        })\r\n        return <primitive ref={ref} object={object.scene} scale={1.6} />\r\n    }\r\n\r\n    //converts quaternion to angles in radians\r\n    function quaternionToAngles(x, y, z, w) {\r\n        const heading = Math.atan2(2 * (x * y + z * w), 1 - 2 * (y * y + z * z));\r\n        const pitch = Math.asin(2 * (x * z - w * y));\r\n        const roll = Math.atan2(2 * (x * w + y * z), 1 - 2 * (x * x + y * y));\r\n        setAngles({\r\n            heading: heading,\r\n            pitch: pitch,\r\n            roll: roll,\r\n        });\r\n    };\r\n\r\n    //runs gyroscope\r\n    const runGyroscope = () => {\r\n        const options = { frequency: SENSOR_UPDATE_FREQUENCY, referenceFrame: \"device\" };\r\n        sensor = new RelativeOrientationSensor(options);\r\n        sensor.start();\r\n        console.log(\"gyroscope started\");\r\n        sensor.onreading = () => {\r\n            quaternionToAngles(\r\n                sensor.quaternion[0],\r\n                sensor.quaternion[1],\r\n                sensor.quaternion[2],\r\n                sensor.quaternion[3]\r\n            );\r\n        }\r\n    };\r\n\r\n    //state machine\r\n    useEffect(() => {\r\n        if (state === \"start\") {\r\n            if (\"AbsoluteOrientationSensor\" in window) {\r\n                Promise.all([\r\n                    navigator.permissions.query({ name: \"gyroscope\" }),\r\n                    navigator.permissions.query({ name: \"accelerometer\" })\r\n                ]).then((results) => {\r\n                    if (results.every((result) => result.state === \"granted\")) {\r\n                        setState(\"running\");\r\n                    } else {\r\n                        setState(\"not allowed\");\r\n                    }\r\n                });\r\n            } else {\r\n                setState(\"not supported\");\r\n            }\r\n\r\n        }\r\n        if (state === \"running\") {\r\n            runGyroscope();\r\n        }\r\n    }, [state]);\r\n\r\n    return (<>\r\n        <Canvas>\r\n            <ambientLight intensity={1} />\r\n            <pointLight position={[-10, -10, 10]} intensity={500} />\r\n            <Gyro />\r\n            <OrthographicCamera makeDefault={true} zoom={50} position={[0, 0, 10]} />\r\n        </Canvas>\r\n        {state === \"ready\" &&\r\n            <button className=\"gyroscopeStartButton\" onClick={() => setState('start')}>\r\n                Start\r\n            </button>\r\n        }\r\n        {state === \"not supported\" &&\r\n            <div className=\"gyroscopeWarning\">\r\n                This feature is not supported on your device and/or browser\r\n            </div>\r\n        }\r\n        {state === \"not allowed\" &&\r\n            <div className=\"gyroscopeWarning\">\r\n                This feature does not have permission to access your device sensors\r\n            </div>\r\n        }\r\n    </>);\r\n}"],"names":["Gyroscope","state","setState","useState","angles","setAngles","heading","pitch","roll","sensor","Gyro","object","useGLTF","GyroscopeObject","ref","useRef","externalGimbal","internalGimbal","axis","scene","children","forEach","child","name","accDelta","useFrame","delta","undefined","alpha","Math","PI","beta","gama","quaternion","w","cos","y","sin","x","z","_jsx","scale","runGyroscope","RelativeOrientationSensor","frequency","referenceFrame","start","console","log","onreading","atan2","asin","quaternionToAngles","useEffect","window","Promise","all","navigator","permissions","query","then","results","every","result","_jsxs","_Fragment","Canvas","intensity","position","OrthographicCamera","makeDefault","zoom","className","onClick"],"sourceRoot":""}