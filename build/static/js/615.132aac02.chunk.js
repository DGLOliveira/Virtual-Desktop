"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[615],{615:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Z});var a=o(5043),n=o(579);const l=(0,a.createContext)({currLayer:0,layers:[],setLayers:()=>{},lastLayer:0,setLastLayer:()=>{},name:"",setName:()=>{},setCurrLayer:()=>{},history:{},setHistory:()=>{},dimentions:{},setDimentions:()=>{},tempDimentions:{},setTempDimentions:()=>{},tool:"",setTool:()=>{},subTool:{},setSubTool:()=>{},curveControls:{},setCurveControls:()=>{},color:{},setColor:()=>{},size:0,setSize:()=>{},text:{},setText:()=>{},clipboard:{},setClipboard:()=>{},zoom:1,setZoom:()=>{},cursor:{},setCursor:()=>{},view:{},setView:()=>{}});const s=function(e){let{children:t}=e;const[o,s]=(0,a.useState)(0),[r,i]=(0,a.useState)([{id:0,name:"Base",visible:!0,locked:!1,canUndo:!1,canRedo:!1}]),[c,d]=(0,a.useState)(0),[h,u]=(0,a.useState)("Untitled"),[x,g]=(0,a.useState)({0:{data:[],lastIndex:0}}),[p,m]=(0,a.useState)({width:350,height:350}),[y,b]=(0,a.useState)({width:350,height:350}),[v,C]=(0,a.useState)("Brush"),[f,w]=(0,a.useState)({shape:"Circle",fill:!1,stretch:!1,sides:4,angle:0,startAngle:0}),[j,k]=(0,a.useState)({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),[M,S]=(0,a.useState)({selected:"hsl(0, 100%, 0%)",1:"hsl(0, 100%, 0%)",2:"hsl(0, 100%, 100%)"}),[T,D]=(0,a.useState)(16),[I,B]=(0,a.useState)({text:"",fill:!0,stroke:!1,strokeWidth:2,lineHeight:1.2,fontFamily:"Arial",state:"none"}),[P,L]=(0,a.useState)({data:{},state:"none"}),[N,E]=(0,a.useState)(1),[A,z]=(0,a.useState)({current:{x:0,y:0},start:{x:0,y:0},end:{x:0,y:0},down:!1,selecting:!1}),[R,$]=(0,a.useState)({toolBar:!0,contentBar:!0,topNavBar:!0,bottomNavBar:!0,menu:!0}),F={currLayer:o,layers:r,setLayers:i,lastLayer:c,setLastLayer:d,name:h,setName:u,history:x,setHistory:g,setCurrLayer:s,dimentions:p,setDimentions:m,tempDimentions:y,setTempDimentions:b,tool:v,setTool:C,subTool:f,setSubTool:w,curveControls:j,setCurveControls:k,color:M,setColor:S,size:T,setSize:D,text:I,setText:B,clipboard:P,setClipboard:L,zoom:N,setZoom:E,cursor:A,setCursor:z,view:R,setView:$};return(0,n.jsx)(l.Provider,{value:F,children:t})},r=(e,t,o,a)=>{let n;n=a?e.getContext("2d",{alpha:!0}):e.getContext("2d",{alpha:!1}),n.webkitImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1;const l=n.canvas.height,s=n.canvas.width,r=t.current.x,i=t.current.y,c=t.start.x,d=t.start.y,h=t.end.x,u=t.end.y,x=()=>{n.strokeStyle=o.selectedColor,n.fillStyle=o.selectedColor,n.lineWidth=1,n.setLineDash([]),n.beginPath(),n.arc(r,i,o.size,0,2*Math.PI),a?n.stroke():n.fill(),n.closePath()},g={drawBrush:()=>{n.fillStyle=o.selectedColor,n.strokeStyle=o.selectedColor,n.lineWidth=1,n.setLineDash([]),n.beginPath(),n.arc(r,i,o.size,0,2*Math.PI),n.stroke(),n.fill(),n.closePath()},drawEraser:x,drawSpray:()=>{let e=Math.random()*o.size,t=Math.random(),a=Math.random()*o.size,l=Math.random();for(;Math.sqrt(Math.pow(e,2)+Math.pow(a,2))>o.size;)e=Math.random()*o.size,a=Math.random()*o.size;l>.5&&(a*=-1),t>.5&&(e*=-1),n.fillStyle=o.selectedColor,n.fillRect(r+e,i+a,1,1)},drawBucket:()=>{let e,t,a,c,d,h,u=[];for(let S=0;S<o.selectedColor.length;S++){var x,g;"("===o.selectedColor[S]?x=S+1:")"===o.selectedColor[S]?(g=S,u.push(o.selectedColor.slice(x,g))):","===o.selectedColor[S]&&(u.push(o.selectedColor.slice(x,S)),x=S+1)}if(c=u[0]/360,d=u[1].slice(0,-1)/100,h=u[2].slice(0,-1)/100,0===d)e=255*h,t=255*h,a=255*h;else{let T,D,I,B,P;function L(e){return e<0?e+1:e>1?e-1:e}function N(e,t,o){return 6*o<1?t+6*(e-t)*o:2*o<1?e:3*o<2?t+(e-t)*(2/3-o)*6:t}T=h<.5?h*(1+d):h+d-h*d,D=2*h-T,I=L(c+1/3),B=L(c),P=L(c-1/3),e=Math.round(255*N(T,D,I)),t=Math.round(255*N(T,D,B)),a=Math.round(255*N(T,D,P))}function p(e){var t=Number(e).toString(16);return 1==t.length?"0"+t:t}let m="#"+p(e)+p(t)+p(a),y=[],b=parseInt("FF"+m.slice(5,7)+m.slice(3,5)+m.slice(1,3),16);const v=n.getImageData(0,0,s,l),C={width:v.width,height:v.height,data:new Uint32Array(v.data.buffer)};function f(e,t){return e<0||t<0||e>=C.width||t>=C.height?-1:C.data[t*v.width+e]}let w=f(Math.floor(r),Math.floor(i));if(-1===w||w===b)return;const j=(e,t,o,a)=>{y.push({left:e,right:t,line:o,direction:a})},k=(e,t,o,a)=>{let n,s,r=!1;if(!(o>=l||o<0)){for(s=e;s<t;++s){f(s,o)===w?r||(r=!0,n=s):r&&(r=!1,j(n,s-1,o,a))}r&&(r=!1,j(n,t-1,o,a))}};j(Math.floor(r),Math.floor(r),Math.floor(i),0);let M=0;for(;y.length>0&&M<5e3;){M++;const{left:E,right:A,line:z,direction:R}=y.pop();let $=E;for(;$>=0&&f($,z)===w;$--);++$;let F=A;for(;F<s&&f(F,z)===w;++F);const Z=z*s;Z+F>C.data.length?(console.log("Attempt to access pixel data array beyond its maximum length"),C.data.fill(b,Z+$,C.data.length)):C.data.fill(b,Z+$,Z+F),R<=0?k($,F,z-1,-1):(k($,E,z-1,-1),k(A,F,z-1,-1)),R>=0?k($,F,z+1,1):(k($,E,z+1,1),k(A,F,z+1,1))}M>=5e3&&console.error("Bucket Tool maximum iterations exceeded, consider using a smaller canvas."),n.putImageData(v,0,0)},drawText:()=>{n.fillStyle=o.selectedColor,n.strokeStyle=o.selectedColor===o.color1?o.color2:o.color1,n.lineWidth=o.text.strokeWidth,n.font=String(o.size+"px "+o.text.fontFamily);let e=o.text.text.split("\n"),t=0,a=h>c?h-c:c-h,l=h>c?c:h,s=u>d?d:u,r=0;for(;t<e.length&&r<500;){if(n.measureText(e[t]).width>a){let o=e[t][0],l=1,s=0;for(;n.measureText(o).width<a&&s<500;)o+=e[t][l],l++,s++;let r=e[t].substring(l-1,e[t].length);e[t]=o.substring(0,l-1),e=e.toSpliced(t+1,0,r)}t++,r++}e.forEach(((e,t)=>{o.text.fill&&n.fillText(e,l,s+o.size+o.size*o.text.lineHeight*t),o.text.stroke&&n.strokeText(e,l,s+o.size+o.size*o.text.lineHeight*t)}))},drawPipette:()=>{let e=n.getImageData(r,i,1,1),t=e.data[0],a=e.data[1],l=e.data[2];t/=255,a/=255,l/=255;let s=Math.min(t,a,l),c=Math.max(t,a,l),d=c-s,h=0,u=0,x=(c+s)/2;0===d?(u=0,h=0):(u=x<=.5?d/(c+s):d/(2-c-s),c===t?h=(a-l)/d:c===a?h=(l-t)/d+2:c===l&&(h=(t-a)/d+4)),h=Math.round(60*h),h<0&&(h+=360),u=Math.abs(100*u).toFixed(0),x=(100*x).toFixed(0);let g="hsl("+h+","+u+"%,"+x+"%)";if("Pipette"!==o.tool)return g;o.selectedColor===o.color1?o.setColor1(g):o.setColor2(g)},drawSelect:()=>{switch(o.clipboard.state){case"copy":if(!a&&h-c!==0&&u-d!==0){let e=n.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"})}break;case"cut":if(!a&&h-c!==0&&u-d!==0){let e=n.getImageData(c,d,h-c,u-d);o.setClipboard({data:e,state:"carry"}),o.selectedColor===o.color1?n.fillStyle=o.color2:n.fillStyle=o.color1,n.fillRect(c,d,h-c,u-d)}break;case"carry":const e=document.getElementById("carryCanvas").getContext("2d");e.height=o.clipboard.data.height,e.width=o.clipboard.data.width,e.putImageData(o.clipboard.data,0,0),n.putImageData(o.clipboard.data,h,u);break;case"paste":if(!a){const e=document.getElementById("carryCanvas");n.drawImage(e,h,u),o.setClipboard({...o.clipboard,state:"none"})}}},drawShape:()=>{n.strokeStyle=o.color1,n.fillStyle=o.color2,n.setLineDash([]),n.lineWidth=o.size;let e,t=(h-c)/2,a=(u-d)/2;e=Math.sqrt(Math.pow(h-c,2))/2<Math.sqrt(Math.pow(u-d,2))/2?Math.sqrt(Math.pow(h-c,2))/2:Math.sqrt(Math.pow(u-d,2))/2;let l=Math.sqrt(Math.pow((h-c)/(u-d),2)),s=Math.sqrt(Math.pow((u-d)/(h-c),2));o.subTool.stretch?l>s?s=1:l=1:(l=1,s=1),"Curve"!==o.subTool.shape&&"Line"!==o.subTool.shape&&(n.save(),n.translate(c+t,d+a),n.rotate(Math.PI*o.subTool.angle/180)),"Rectangle"===o.subTool.shape?g["draw"+o.subTool.shape](t,a):g["draw"+o.subTool.shape](l,s,e),"Line"!==o.subTool.shape&&"Curve"!==o.subTool.shape&&n.restore()},drawLine:()=>{n.beginPath(),n.moveTo(c,d),n.lineTo(h,u),n.stroke()},drawCurve:()=>{let e={x:0,y:0},t={x:0,y:0},a={x:0,y:0},l={x:0,y:0};n.beginPath(),-1===o.curveControls.start.x?(e={x:c,y:d},t={x:h,y:u},a={x:c,y:d},l={x:h,y:u}):-1===o.curveControls.controlPoint1.x?(e=o.curveControls.start,t=o.curveControls.end,a={x:h,y:u},l=o.curveControls.end):-1===o.curveControls.controlPoint2.x?(e=o.curveControls.start,t=o.curveControls.end,a=o.curveControls.controlPoint1,l={x:h,y:u}):(e=o.curveControls.start,t=o.curveControls.end,a=o.curveControls.controlPoint1,l=o.curveControls.controlPoint2),n.moveTo(e.x,e.y),n.bezierCurveTo(a.x,a.y,l.x,l.y,t.x,t.y),n.stroke()},drawCircle:(e,t,a)=>{n.beginPath(),n.ellipse(0,0,e*a,t*a,0,0,2*Math.PI),o.subTool.fill&&n.fill(),n.stroke()},drawRectangle:(e,t)=>{o.subTool.fill&&n.fillRect(-e,-t,h-c,u-d),n.strokeRect(-e,-t,h-c,u-d)},drawPolygon:(e,t,a)=>{n.beginPath();for(let l=0;l<o.subTool.sides+2;l++)n.lineTo(e*a*Math.cos(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*a*Math.sin(2*Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&n.fill(),n.stroke()},drawStar:(e,t,a)=>{n.beginPath();for(let l=0;l<2*o.subTool.sides+2;l++)l%2===0?n.lineTo(e*a*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*a*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle)):n.lineTo(e*a/3*Math.cos(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle),t*a/3*Math.sin(Math.PI*l/o.subTool.sides-Math.PI/2+Math.PI/180*o.subTool.startAngle));o.subTool.fill&&n.fill(),n.stroke()},drawArrow:(e,t,a)=>{n.beginPath(),n.moveTo(e*-a*Math.cos(Math.PI/8),t*-a*Math.sin(Math.PI/8)),n.lineTo(0,t*-a*Math.sin(Math.PI/8)),n.lineTo(0,t*-a),n.lineTo(e*a,0),n.lineTo(0,t*a),n.lineTo(0,t*a*Math.sin(Math.PI/8)),n.lineTo(e*-a*Math.cos(Math.PI/8),t*a*Math.sin(Math.PI/8)),n.closePath(),o.subTool.fill&&n.fill(),n.stroke()},drawHeart:(e,t,a)=>{o.subTool.stretch&&(e>t?n.scale(e,1):n.scale(1,t)),n.beginPath(),n.moveTo(0,a),n.arc(-a/2,-a/5,a/2,3*Math.PI/4,0,!1),n.arc(a/2,-a/5,a/2,Math.PI,Math.PI/4,!1),n.closePath(),o.subTool.fill&&n.fill(),n.stroke()}};if(a){if(n.clearRect(0,0,s,l),"Magnifier"!==o.tool){if("Bucket"===o.tool||"Pipette"===o.tool)return;"Spray"===o.tool?x():g["draw"+o.tool]()}}else"Magnifier"!==o.tool&&g["draw"+o.tool]()},i=(e,t,o,a,n,l)=>{switch(a.tool){case"Brush":case"Eraser":r(e,t,a,!1),"drawing"!==n&&l("drawing");break;case"Bucket":r(e,t,a,!1),l("finished");break;case"Spray":for(let o=0;o<10;o++)r(e,t,a,!1);l("spraying");break;case"Text":0!==t.current.x&&0!==t.current.y&&a.setText({...a.text,state:"preview"}),"confirm"===n&&(r(e,t,a,!1),a.setText({...a.text,text:"",state:"none"}),l("finished"));break;case"Pipette":r(e,t,a,!1);break;case"Magnifier":default:break;case"Select":"clipping"===n&&"carry"!==a.clipboard.state?r(e,t,a,!1):"confirm"===n&&(r(e,t,a,!1),l("finished"));break;case"Shape":if("Curve"===a.subTool.shape&&t.down){let e=a.curveControls.state,o=a.curveControls.start,s=a.curveControls.end,r=a.curveControls.controlPoint1,i=a.curveControls.controlPoint2;"none"===a.curveControls.state?(l("settingPoints"),e="start",o={x:t.start.x,y:t.start.y},s={x:t.end.x,y:t.end.y}):"start"===a.curveControls.state?"settingPoints"===n?s={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point1",r={x:t.end.x,y:t.end.y}):"point1"===a.curveControls.state?"settingPoints"===n?r={x:t.end.x,y:t.end.y}:(l("settingPoints"),e="point2",i={x:t.end.x,y:t.end.y}):"point2"===a.curveControls.state&&(i={x:t.end.x,y:t.end.y}),a.setCurveControls({...a.curveControls,state:e,start:o,end:s,controlPoint1:r,controlPoint2:i})}else"Curve"===a.subTool.shape&&"cancel"===n&&a.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}});"confirm"===n&&(r(e,t,a,!1),"Curve"===a.subTool.shape&&a.setCurveControls({state:"none",start:{x:-1,y:-1},end:{x:-1,y:-1},controlPoint1:{x:-1,y:-1},controlPoint2:{x:-1,y:-1}}),l("finished"),o({...t,start:{x:0,y:0},end:{x:0,y:0}}))}},c=(e,t,o,a)=>{if(null===e)t({File:{New:{action:"New",keybind:"Alt+N",disabled:!1},Open:{action:"Open",keybind:"Alt+O",disabled:!1},Download:{action:"Save",keybind:"Ctrl+Alt+S",disabled:!0},"Download As":{action:"Save As",keybind:"Ctrl+Alt+Shift+S",disabled:!0,title:"Not Implemented"},"Change Name":{action:"Change Name",keybind:"F2",disabled:!1},LineBreak1:{},Close:{action:"Close",keybind:"Alt+Shift+F4",disabled:!1}},Edit:{Undo:{action:"Undo",keybind:"Ctrl+Z",disabled:!1},Redo:{action:"Redo",keybind:"Ctrl+Y",disabled:!1}},View:{"Zoom In":{action:"Zoom In",keybind:"Alt++",disabled:!1},"Zoom Out":{action:"Zoom Out",keybind:"Alt+-",disabled:!1},"Zoom Reset":{action:"Zoom Reset",keybind:"Alt+0",disabled:!0},LineBreak1:{},"Tool Bar":{action:"toolBar",checkbox:!0,disabled:!1},"Content Bar":{action:"contentBar",checkbox:!0,disabled:!1},"Bottom Bar":{action:"bottomNavBar",checkbox:!0,disabled:!1},"Top Bar":{action:"topNavBar",checkbox:!0,disabled:!1}}});else{let n={...e};switch(a){case"history":let e=o.history.canUndo||o.history.canRedo;n={...n,File:{...n.File,Download:{...n.File.Download,disabled:!e},"Download As":{...n.File["Download As"],disabled:!e}},Edit:{...n.Edit,Undo:{...n.Edit.Undo,disabled:!o.history.canUndo},Redo:{...n.Edit.Redo,disabled:!o.history.canRedo}}};break;case"view":n={...n,View:{...n.View,"Tool Bar":{...n.View["Tool Bar"],checkbox:o.view.toolBar},"Content Bar":{...n.View["Content Bar"],checkbox:o.view.contentBar},"Bottom Bar":{...n.View["Bottom Bar"],checkbox:o.view.bottomNavBar},"Top Bar":{...n.View["Top Bar"],checkbox:o.view.topNavBar}}};break;case"zoom":n={...n,View:{...n.View,"Zoom In":{...n.View["Zoom In"],disabled:4===o.zoom},"Zoom Out":{...n.View["Zoom Out"],disabled:.25===o.zoom},"Zoom Reset":{...n.View["Zoom Reset"],disabled:1===o.zoom}}}}t(n)}},d=(e,t,o,a,n,l,s,r,i,d)=>{let h={},u={};const x=e.canvas.height,g=e.canvas.width,p=(e,t,a)=>{o(e),d(t),s(a),c(n,l,u={history:{...t[r]}},"history")};switch(a){case"undo":(()=>{const e=i[r].id;h=t,document.getElementById(`drawCanvasLayer${e}`).getContext("2d").putImageData(t[e].data[t[e].lastIndex-1],0,0);const o=t[e].lastIndex-1>0;h[e].lastIndex--;let a=i;a[r]={...a[r],canUndo:o,canRedo:!0},p(h,a,!1)})();break;case"redo":(()=>{let e=i[r].id;h=t,document.getElementById(`drawCanvasLayer${e}`).getContext("2d").putImageData(t[e].data[t[e].lastIndex+1],0,0);const o=t[e].lastIndex+1<t[e].data.length-1;h[e].lastIndex++;let a=i;a[r]={...a[r],canUndo:!0,canRedo:o},p(h,a,!1)})();break;case"delete layer":default:break;case"duplicate layer":(()=>{let e=i[r].id;const o=document.getElementById(`drawCanvasLayer${e}`).getContext("2d"),a=t[e].data[t[e].lastIndex];o.putImageData(a,0,0)})();break;case"save":(()=>{let e=i[r].id,o=!1;h=t;let a=document.getElementById(`drawCanvasLayer${e}`).getContext("2d");h[e]?h[e].lastIndex===h[e].data.length-1?h[e]={data:[...h[e].data,a.getImageData(0,0,g,x)],lastIndex:h[e].data.length}:(h[e].data.splice(h[e].lastIndex+1,0,a.getImageData(0,0,g,x)),h[e].lastIndex++):(o=!0,h[e]={data:[a.getImageData(0,0,g,x)],lastIndex:0});let n=i;n[r]={...n[r],canUndo:!o,canRedo:!1},h[e].data.length>50&&(h[e].data.shift(),h[e].lastIndex--),p(h,n,!1)})();break;case"clear":h={0:{data:[e.getImageData(0,0,g,x)],lastIndex:0}},p(h,[{id:0,name:"Base",visible:!0,canUndo:!1,canRedo:!1}],!0)}},h=(e,t,o,a,n)=>{const l=e.canvas.height,s=e.canvas.width;function r(e){document.body.onfocus=()=>{e.value.length>0||(e.remove(),n(!1)),document.body.onfocus=null}}switch(o){case"new":(()=>{const e=document.getElementById("drawCanvasLayer0").getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,s,l)})();break;case"save":(()=>{let e=document.createElement("canvas");e.width=s,e.height=l,a.forEach((t=>{t.visible&&e.getContext("2d").drawImage(document.getElementById(`drawCanvasLayer${t.id}`),0,0)}));let o=document.createElement("a");o.setAttribute("download",t.name+".png");let n=e.getContext("2d").canvas.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");o.setAttribute("href",n),o.click()})();break;case"open":(()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=o=>{const a=o.target.files[0],l=new FileReader;l.onload=()=>{const o=new Image;o.src=l.result,o.onload=()=>{const l=document.getElementById("drawCanvasLayer0");l.width=o.width,l.height=o.height,t.setDimentions({width:o.width,height:o.height}),t.setName(a.name),l.getContext("2d").drawImage(o,0,0),n("Open Confirm"),e.remove()}},l.readAsDataURL(a)},e.click(),r(e)})();break;case"image":(()=>{const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=o=>{const a=o.target.files[0],l=new FileReader;l.onload=()=>{const o=new Image;o.src=l.result,o.onload=()=>{const a=document.createElement("canvas");a.width=o.width,a.height=o.height;const l=a.getContext("2d");l.drawImage(o,0,0);const s=l.getImageData(0,0,o.width,o.height);t.setClipboard({data:s,state:"carry"}),t.setTool("Select"),n("clipping"),e.remove()}},l.readAsDataURL(a)},e.click(),r(e)})()}},u=e=>{let t={};const{canvas:o,ctx:a,context:l,params:s,action:r,setAction:u,appMenu:x,setAppMenu:g,appDialog:p,setAppDialog:m,contextMenu:y,canClose:b,setCanClose:v,isSelected:C,title:f,setTitle:w,currLayer:j,setCurrLayer:k,layers:M,setLayers:S}=e;switch(r){case"Startup":h(a,l,"new",M),d(a,l.history,l.setHistory,"clear",x,g,v,j,M,S),u(!1);break;case"New":((e,t,o)=>{e.setTempDimentions({width:e.dimentions.width,height:e.dimentions.height});const a=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,n.jsx)("br",{}),(0,n.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("New")}}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{htmlFor:"Width",children:"Width"}),(0,n.jsx)("br",{}),(0,n.jsx)("input",{id:"Width",type:"number",value:e.tempDimentions.width,onChange:o=>{e.setTempDimentions({...e.tempDimentions,width:o.target.value}),t("New")}}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{htmlFor:"Height",children:"Height"}),(0,n.jsx)("br",{}),(0,n.jsx)("input",{id:"Height",type:"number",value:e.tempDimentions.height,onChange:o=>{e.setTempDimentions({...e.tempDimentions,height:o.target.value}),t("New")}}),(0,n.jsx)("br",{})]}),l={Confirm:()=>{e.setDimentions({...e.tempDimentions}),t("New Confirm"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"New File",info:a,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"New Confirm":m(null),h(a,l,"new",M),k(0),d(a,l.history,l.setHistory,"clear",x,g,v,j,M,S),l.setClipboard({data:{},state:"none"}),u(!1);break;case"Open":h(a,l,"open",M,u);break;case"Open Confirm":k(0),d(a,l.history,l.setHistory,"clear",x,g,v,j,M,S),l.setClipboard({data:{},state:"none"}),u(!1);break;case"Save":h(a,l,"save",M),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Save As":((e,t,o)=>{const a=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("label",{htmlFor:"New Name",children:"Name"}),(0,n.jsx)("br",{}),(0,n.jsx)("input",{id:"New name",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,n.jsx)("br",{})]}),l={Confirm:()=>{t("Save"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"Download As",info:a,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Change Name":((e,t,o)=>{const a=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("label",{htmlFor:"New title",children:"Name"}),(0,n.jsx)("br",{}),(0,n.jsx)("input",{id:"New title",type:"text",value:e.name,onChange:o=>{e.setName(o.target.value),t("Change Name")}}),(0,n.jsx)("br",{})]}),l={Confirm:()=>{t("Change Name Confirm"),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}};o({title:"Change Name",info:a,actions:l})})(l,u,m),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Change Name Confirm":w(l.name),m(null),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Image":h(a,l,"image",M,u);break;case"Undo":d(a,l.history,l.setHistory,"undo",x,g,v,j,M,S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Redo":d(a,l.history,l.setHistory,"redo",x,g,v,j,M,S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"New Layer":d(a,l.history,l.setHistory,"save",x,g,v,j,M,S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Delete Layer":d(a,l.history,l.setHistory,"delete layer",x,g,v,j,M,S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Duplicate Layer":d(a,l.history,l.setHistory,"duplicate layer",x,g,v,j,M,S),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom In":l.zoom<4&&(l.zoom<1?(l.setZoom(l.zoom+.25),t={zoom:l.zoom+.25}):(l.setZoom(l.zoom+1),t={zoom:l.zoom+1}),c(x,g,t,"zoom")),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Out":l.zoom>.25&&(l.zoom<=1?(l.setZoom(l.zoom-.25),t={zoom:l.zoom-.25}):(l.setZoom(l.zoom-1),t={zoom:l.zoom-1}),c(x,g,t,"zoom")),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Reset":l.setZoom(1),t={zoom:1},c(x,g,t,"zoom"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Zoom Min":t={zoom:.25},c(x,g,t,"zoom"),u(!1);break;case"Zoom Max":t={zoom:4},c(x,g,t,"zoom"),u(!1);break;case"Zoom Default":t={zoom:1},c(x,g,t,"zoom"),u(!1);break;case"Zoom Change":t={zoom:2},c(x,g,t,"zoom"),u(!1);break;case"Cut":case"Copy":case"Paste":case"Select All":case"Select Clear":u(!1);break;case"finished":d(a,l.history,l.setHistory,"save",x,g,v,j,M,S),u(!1);break;case"drawing":l.cursor.down&&!M[j].locked?i(o,l.cursor,l.setCursor,s,r,u):u("finished");break;case"spraying":l.cursor.down&&!M[j].locked?setTimeout((()=>{u("drawing")}),100):u("finished");break;case"settingPoints":l.cursor.down?i(o,l.cursor,l.setCursor,s,r,u):u(!1);break;case"cancel":case"clipping":case"confirm":i(o,l.cursor,l.setCursor,s,r,u);break;case!1:l.cursor.down&&!M[j].locked&&i(o,l.cursor,l.setCursor,s,r,u);break;case"topNavBar":l.setView({...l.view,topNavBar:!l.view.topNavBar}),t={view:{...l.view,topNavBar:!l.view.topNavBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"contentBar":l.setView({...l.view,contentBar:!l.view.contentBar}),t={view:{...l.view,contentBar:!l.view.contentBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"bottomNavBar":l.setView({...l.view,bottomNavBar:!l.view.bottomNavBar}),t={view:{...l.view,bottomNavBar:!l.view.bottomNavBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"toolBar":l.setView({...l.view,toolBar:!l.view.toolBar}),t={view:{...l.view,toolBar:!l.view.toolBar}},c(x,g,t,"view"),"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;case"Close":b||((e,t,o)=>{o({title:"Warning",info:"Do you want to download the file before closing?",actions:{Save:()=>{t("Save and Close"),o(null)},Close:()=>{e(!0),o(null)},Cancel:()=>{o(null),t("Cancel Dialog")}}})})(v,u,m);break;case"Save and Close":h(a,l,"save"),v(!0),u("Close");break;case"Cancel Dialog":"carry"===l.clipboard.state&&"Select"===l.tool?u("clipping"):u(!1);break;default:u(!1)}};function x(e){let{action:t,setAction:o,appMenu:s,setAppMenu:r,appDialog:i,setAppDialog:c,contextMenu:d,canClose:h,setCanClose:x,title:g,setTitle:p}=e;const m=(0,a.useContext)(l),y=m.layers,b=m.setLayers,v=m.currLayer,C=m.setCurrLayer,f={tool:m.tool,subTool:m.subTool,curveControls:m.curveControls,setCurveControls:m.setCurveControls,size:m.size,selectedColor:m.color.selected,color1:m.color[1],setColor1:e=>m.setColor({...m.color,1:e,selected:e}),color2:m.color[2],setColor2:e=>m.setColor({...m.color,2:e,selected:e}),text:m.text,setText:m.setText,clipboard:m.clipboard,setClipboard:m.setClipboard};return(0,a.useEffect)((()=>{if(void 0===y[v].id)return;let e=document.getElementById(`drawCanvasLayer${y[v].id}`),a=e.getContext("2d",{willReadFrequently:!0});u({canvas:e,ctx:a,params:f,action:t,setAction:o,context:m,appMenu:s,setAppMenu:r,appDialog:i,setAppDialog:c,contextMenu:d,canClose:h,setCanClose:x,title:g,setTitle:p,currLayer:v,setCurrLayer:C,layers:y,setLayers:b})}),[m.cursor,t]),(0,a.useEffect)((()=>{let e=-1*(m.dimentions.width/2-m.zoom*m.dimentions.width/2)/m.zoom,t=-1*(m.dimentions.height/2-m.zoom*m.dimentions.height/2)/m.zoom;document.getElementById("drawDocCheckersBackground").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`,document.getElementById("previewCanvas").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`,document.getElementById("interfaceCanvas").style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`;const o=document.getElementsByClassName("drawCanvasLayer");if(o.length>0)for(let a=0;a<o.length;a++)o[a].style.transform=`scale(${m.zoom}) translate(${e}px,${t}px)`}),[m.zoom,m.cursor]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{id:"drawDocCheckersBackground",className:"drawDocCheckersBackground",height:m.dimentions.height,width:m.dimentions.width}),y.length>0&&y.map(((e,t)=>(0,n.jsx)("canvas",{id:`drawCanvasLayer${e.id}`,className:"drawCanvasLayer",style:{display:e.visible?"block":"none",zIndex:t},height:m.dimentions.height,width:m.dimentions.width},e.id)))]})}function g(){const e=(0,a.useContext)(l),t=(0,a.useRef)(null),o=e.cursor,s=e.tool,i=e.subTool,c=e.curveControls,d=e.setCurveControls,h=e.size,u=e.color.selected,x=e.color[1],g=e.color[2],p=e.text,m=e.setText,y=e.clipboard,b=e.setClipboard,v=e.layers,C=e.currLayer,f={tool:s,subTool:i,curveControls:c,setCurveControls:d,size:h,selectedColor:u,color1:x,setColor1:t=>e.setColor({...e.color,1:t}),color2:g,setColor2:t=>e.setColor({...e.color,2:t}),text:p,setText:m,clipboard:y,setClipboard:b};return(0,a.useEffect)((()=>{v[C].locked||r(t.current,o,f,!0)}),[o,f]),(0,n.jsx)("canvas",{ref:t,style:{display:v[C].locked?"none":"block",color:f.selectedColor,zIndex:C},id:"previewCanvas",height:e.dimentions.height,width:e.dimentions.width})}function p(){const e=(0,a.useContext)(l),t=e.cursor,o=e.setCursor,s=e.zoom,r=e.tool,i=e.subTool,c=e.setSubTool,d=e.layers,h=e.currLayer,u=e.clipboard,[x,g]=(0,a.useState)({left:"0px",top:"0px",height:"0px",width:"0px",canUsePointer:!0}),[p,m]=(0,a.useState)({left:"0px",top:"0px",diameter:"0px"}),[y,b]=(0,a.useState)({left:"0px",top:"0px",width:"0px",height:"0px"}),[v,C]=(0,a.useState)([0,0,!0]),[f,w]=(0,a.useState)([0,0,0,0]),[j,k]=(0,a.useState)([0,0,0]),M=e=>{let t,o,a=!1;if(0===e.button?0!==e.clientX&&0!==e.clientY&&(t=e.clientX,o=e.clientY,a=!0):0!==e.touches[0].clientX&&0!==e.touches[0].clientY&&(t=e.touches[0].clientX,o=e.touches[0].clientY,a=!0),a){let e=document.getElementById("interfaceCanvas"),a=e.getContext("2d",{alpha:!0}),n=e.getBoundingClientRect();const l=a.canvas.width/n.width,s=a.canvas.height/n.height;return t=(t-n.left)*l,o=(o-n.top)*s,[t,o,!0]}return[0,0,!1]},S=(e,a)=>{e.stopPropagation(),o({...t,selecting:!0});const n=M(e);let l=0,s=0;!1!==n[2]&&(-1!==a.indexOf("N")?s=n[1]-Math.min(t.start.y,t.end.y):-1!==a.indexOf("S")&&(s=n[1]-Math.max(t.start.y,t.end.y)),-1!==a.indexOf("W")?l=n[0]-Math.min(t.start.x,t.end.x):-1!==a.indexOf("E")&&(l=n[0]-Math.max(t.start.x,t.end.x)),C([l,s]))};function T(e,o,a){let n=!1,l=!1;t.start.x>t.end.x&&(n=!0),t.start.y>t.end.y&&(l=!0);let s=t.start.x,r=t.start.y,i=t.end.x,c=t.end.y;return-1!==a.indexOf("N")?l?c=o[1]-v[1]:r=o[1]-v[1]:-1!==a.indexOf("S")&&(l?r=o[1]-v[1]:c=o[1]-v[1]),-1!==a.indexOf("E")?n?s=o[0]-v[0]:i=o[0]-v[0]:-1!==a.indexOf("W")&&(n?i=o[0]-v[0]:s=o[0]-v[0]),[s,r,i,c]}const D=(e,a)=>{e.preventDefault(),e.stopPropagation();const n=M(e);if(!1===n[2])return;const l=T(0,n,a);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]}})},I=(e,a)=>{e.preventDefault(),e.stopPropagation();const n=M(e);if(!1===n[2])return;const l=T(0,n,a);o({...t,start:{x:l[0],y:l[1]},end:{x:l[2],y:l[3]},selecting:!1})},B=e=>{e.stopPropagation(),o({...t,selecting:!0});const a=M(e);if(!1===a[2])return;if("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id)return;let n=0,l=0,s=0,r=0;n=a[0]-t.start.x,l=a[1]-t.start.y,s=a[0]-t.end.x,r=a[1]-t.end.y,w([n,l,s,r])},P=e=>{e.preventDefault(),e.stopPropagation();const a=M(e);!1!==a[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:a[0]-f[0],y:a[1]-f[1]},end:{x:a[0]-f[2],y:a[1]-f[3]}}))},L=e=>{e.preventDefault(),e.stopPropagation();const a=M(e);!1!==a[2]&&("drawDocSelectionBox"!==e.target.id&&"drawDocSelectionEllipse"!==e.target.id&&"drawDocSelectionCircle"!==e.target.id&&"drawDocSelectionBoxDragPivot"!==e.target.id||o({...t,start:{x:a[0]-f[0],y:a[1]-f[1]},end:{x:a[0]-f[2],y:a[1]-f[3]},selecting:!1}))},N=e=>{e.preventDefault();const t=M(e);if(!1===t[2])return;let o=Number(p.top.slice(0,-2)),a=Number(p.left.slice(0,-2)),n=Number(p.diameter.slice(0,-2)),l=a+n/2+j[3],s=o+n/2+j[4],r=l>t[0]?l-t[0]:t[0]-l,d=s>t[1]?s-t[1]:t[1]-s,h=Math.sqrt(Math.pow(r,2)+Math.pow(d,2)),u=Math.acos((Math.pow(r,2)+Math.pow(h,2)-Math.pow(d,2))/(2*r*h))/(Math.PI/180),x=0;t[0]>l&&t[1]<s?x=90-u:t[0]>l&&t[1]>s?x=90+u:t[0]<l&&t[1]>s?x=270-u:t[0]<l&&t[1]<s&&(x=270+u),c({...i,angle:x})};return(0,a.useEffect)((()=>{if("Select"!==r||"carry"!==u.state){let e=Math.min(t.start.x,t.end.x),o=Math.max(t.start.x,t.end.x),a=Math.min(t.start.y,t.end.y),n=Math.max(t.start.y,t.end.y)-a,l=o-e;g({...x,left:Math.floor(e*s)+"px",top:Math.floor(a*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(n*s)+"px"});let r=e+Math.floor(l/2),i=a+Math.floor(n/2),c=Math.min(l,n);m({...p,left:Math.floor((r-c/2)*s)+"px",top:Math.floor((i-c/2)*s)+"px",diameter:Math.floor(c*s)+"px"}),b({...y,left:Math.floor(e*s)+"px",top:Math.floor(a*s)+"px",width:Math.floor(l*s)+"px",height:Math.floor(n*s)+"px"})}else g({...x,left:Math.floor(t.end.x*s)+"px",top:Math.floor(t.end.y*s)+"px",width:Math.floor(u.data.width*s)+"px",height:Math.floor(u.data.height*s)+"px"})}),[t,s,r,u.state]),d[h].locked?null:(0,n.jsxs)(n.Fragment,{children:[("Select"===r||"Shape"===r||"Text"===r)&&(0,n.jsxs)("div",{id:"drawDocSelectionBox",style:{top:x.top,left:x.left,width:x.width,height:x.height,pointerEvents:t.down?"none":"auto",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||B(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||L(e)},children:["Text"===r&&(0,n.jsx)("div",{id:"drawDocSelectionBoxDragPivot"}),("Select"!==r||"carry"!==u.state)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{id:"drawDocSelectionBoxNW",draggable:!0,onDragStart:e=>{t.down||S(e,"NW")},onDrag:e=>{t.down||D(e,"NW")},onDragEnd:e=>{t.down||I(e,"NW")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxN",draggable:!0,onDragStart:e=>{t.down||S(e,"N")},onDrag:e=>{t.down||D(e,"N")},onDragEnd:e=>{t.down||I(e,"N")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxNE",draggable:!0,onDragStart:e=>{t.down||S(e,"NE")},onDrag:e=>{t.down||D(e,"NE")},onDragEnd:e=>{t.down||I(e,"NE")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxE",draggable:!0,onDragStart:e=>{t.down||S(e,"E")},onDrag:e=>{t.down||D(e,"E")},onDragEnd:e=>{t.down||I(e,"E")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxSE",draggable:!0,onDragStart:e=>{t.down||S(e,"SE")},onDrag:e=>{t.down||D(e,"SE")},onDragEnd:e=>{t.down||I(e,"SE")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxS",draggable:!0,onDragStart:e=>{t.down||S(e,"S")},onDrag:e=>{t.down||D(e,"S")},onDragEnd:e=>{t.down||I(e,"S")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxSW",draggable:!0,onDragStart:e=>{t.down||S(e,"SW")},onDrag:e=>{t.down||D(e,"SW")},onDragEnd:e=>{t.down||I(e,"SW")}}),(0,n.jsx)("div",{id:"drawDocSelectionBoxW",draggable:!0,onDragStart:e=>{t.down||S(e,"W")},onDrag:e=>{t.down||D(e,"W")},onDragEnd:e=>{t.down||I(e,"W")}})]})]}),"Shape"===r&&"Line"!==i.type&&"Curve"!==i.type&&i.stretch&&(0,n.jsx)("div",{id:"drawDocSelectionEllipse",style:{top:y.top,left:y.left,width:y.width,height:y.height,rotate:i.angle+"deg",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||B(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||L(e)}}),"Shape"===r&&"Line"!==i.type&&"Curve"!==i.type&&(0,n.jsx)("div",{id:"drawDocSelectionCircle",style:{top:p.top,left:p.left,width:p.diameter,height:p.diameter,rotate:i.angle+"deg",zIndex:d.length+2},draggable:!0,onDragStart:e=>{t.down||B(e)},onDrag:e=>{t.down||P(e)},onDragEnd:e=>{t.down||L(e)},children:(0,n.jsx)("div",{id:"drawDocSelectionCirclePoint",draggable:!0,onDragStart:e=>{t.down||(e=>{o({...t,selecting:!0});const a=M(e),n=document.getElementById("previewCanvas").getBoundingClientRect();!1!==a[2]&&k([a[0],a[1],i.angle,n.left,n.top])})(e)},onDrag:e=>{t.down||N(e)},onDragEnd:e=>{t.down||(e=>{N(e),o({...t,selecting:!1})})(e)}})}),"Text"===r&&!t.down&&(0,n.jsx)("textarea",{id:"drawDocSelectionBoxText",style:{top:x.top,left:x.left,width:x.width,height:x.height,caretColor:e.text.color,fontSize:e.size*e.zoom+"px",fontFamily:e.text.fontFamily,lineHeight:e.text.lineHeight,zIndex:d.length+2},spellCheck:!1,value:e.text.text,onChange:t=>e.setText({...e.text,text:t.target.value})})]})}var m=o(6833),y=o(7196),b=o(3156),v=o(9804),C=o(5394),f=o(9342);function w(e){const t=e.action,o=e.setAction,s=(e.contextMenu,e.appMenu),r=e.setAppMenu,i=(0,a.useContext)(l),d=i.history,h=i.setHistory,u=i.currLayer,x=i.setCurrLayer,g=i.layers,p=i.setLayers,m=i.lastLayer,w=i.setLastLayer,[j,k]=(0,a.useState)([]),[M,S]=(0,a.useState)(-1),[T,D]=(0,a.useState)(-1),[I,B]=(0,a.useState)(-1),P=e=>{let t;x(e),c(s,r,t={history:{...g[e]}},"history")};(0,a.useEffect)((()=>{if(-1!==M){const e=document.getElementById(`drawDocLayerNameInput${M}`);return e.focus(),e.select(),e.addEventListener("blur",(()=>S(-1))),e.addEventListener("keydown",(e=>{"Enter"===e.key&&S(-1)})),()=>{e.removeEventListener("blur",(()=>S(-1))),e.removeEventListener("keydown",(e=>{"Enter"===e.key&&S(-1)}))}}}),[M]);const L=(e,t)=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move",B(t)},N=(e,t)=>{e.preventDefault(),e.stopPropagation();let o=[];const a=g[T];if(T<1||T===t)return B(-1),void D(-1);if(0===t)o=[g[0],a,...g.filter(((e,t)=>t!==T&&0!==t))];else if(t===g.length)o=[...g.filter(((e,t)=>t!==T)),a];else if(t===g.length-1){const e=g[t];o=[...g.filter(((e,o)=>o<t&&o!==T)),a,e]}else{const e=g[t];o=[...g.filter(((e,o)=>o<t&&o!==T)),t<T?a:e,t>T?a:e,...g.filter(((e,o)=>o>t&&o!==T))]}p(o),B(-1),D(-1)};return(0,a.useEffect)((()=>{g.length>0&&k(g.map(((e,t)=>((e,t)=>{const o=document.getElementById(e);return(t?o.getContext("2d",{alpha:!0}):o.getContext("2d",{alpha:!1})).canvas.toDataURL("image/png")})(`drawCanvasLayer${e.id}`,!0))))}),[d,g,t]),(0,n.jsxs)("div",{id:"drawDocLayersWindow",onDragOver:e=>{L(e,g.length)},onDrop:e=>{N(e,g.length)},children:[g.map(((e,t)=>(0,n.jsxs)(a.Fragment,{children:[0!==t&&(0,n.jsx)("hr",{style:{display:I===t?"block":"none"}}),(0,n.jsxs)("div",{className:"drawDocLayersWindowLayer",draggable:0!==t,onDragStart:e=>D(t),onDrag:e=>e.preventDefault(),onDragOver:e=>{L(e,t)},onDrop:e=>{N(e,t)},style:{cursor:0===t?"default":"grab"},children:[(0,n.jsx)("img",{src:j[t]?j[t]:"",className:"drawDocCheckersBackground",onClick:()=>P(t),draggable:0!==t}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{type:"radio",value:t,checked:u===t,onChange:()=>P(t)}),(0,n.jsx)("span",{style:{textDecoration:t===u?"underline":"none",display:t===M?"none":"inline-block"},children:e.name}),(0,n.jsx)("input",{style:{display:t===M?"inline-block":"none"},id:`drawDocLayerNameInput${t}`,type:"text",value:e.name,onChange:e=>{((e,t)=>{const o=[...g];o[t].name=e.target.value,p(o)})(e,t)}})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{title:"Undo Layer","aria-label":"Undo Layer",disabled:!e.canUndo||e.locked,onClick:()=>{x(t),o("Undo")},children:(0,n.jsx)(v.qHd,{})}),(0,n.jsx)("button",{title:"Redo Layer","aria-label":"Redo Layer",disabled:!e.canRedo||e.locked,onClick:()=>{x(t),o("Redo")},children:(0,n.jsx)(v.qQW,{})}),(0,n.jsx)("button",{title:"Duplicate Layer","aria-label":"Duplicate Layer",onClick:()=>(e=>{let t=m+1;const a={id:t,name:`Dupe ${g[e].name}`,visible:!0,locked:g[e].locked,canUndo:g[e].canUndo,canRedo:g[e].canRedo};p([...g.slice(0,e+1),a,...g.slice(e+1)]),x(e+1),w(m+1);let n=d;n[t]=d[g[e].id],h(n),o("Duplicate Layer")})(t),children:(0,n.jsx)(C.oCv,{})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{title:"Rename Layer","aria-label":"Rename Layer",disabled:0===t,onClick:()=>S(t),children:(0,n.jsx)(y.Ics,{})}),(0,n.jsx)("button",{title:"Toggle Visibility","aria-label":"Toggle Visibility",onClick:()=>(e=>{const t=[...g];t[e].visible=!t[e].visible,p(t)})(t),children:e.visible?(0,n.jsx)(y.yAb,{}):(0,n.jsx)(y.qRD,{})}),(0,n.jsx)("button",{title:"Delete Layer","aria-label":"Delete Layer",disabled:0===t||e.locked,onClick:()=>(e=>{p(g.filter(((t,o)=>o!==e))),(e===u||u>g.length-2)&&x(0),o("Delete Layer")})(t),children:(0,n.jsx)(b.G02,{})})]}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{title:e.locked?"Unlock Layer":"Lock Layer","aria-label":e.locked?"Unlock Layer":"Lock Layer",onClick:()=>(e=>{const t=[...g];t[e].locked=!t[e].locked,p(t)})(t),className:e.locked?"buttonActive":"",children:e.locked?(0,n.jsx)(f.BWK,{}):(0,n.jsx)(f.lg2,{})})})]})]}),0===t&&(0,n.jsx)("hr",{style:{display:I===t?"block":"none"}})]},e.id))),I===g.length&&(0,n.jsx)("hr",{}),(0,n.jsx)("button",{onClick:()=>{(()=>{const e={id:m+1,name:`Layer ${m+1}`,visible:!0,locked:!1,canUndo:!1,canRedo:!1};p([...g,e]),x(g.length),w(m+1),o("New Layer")})()},children:"New Layer"})]})}function j(e){let{action:t,setAction:o,contextMenu:s,appMenu:r,setAppMenu:i}=e;const c=(0,a.useContext)(l),[d,h]=(0,a.useState)(!1),[u,x]=(0,a.useState)("Layers");if(c.view.contentBar)return(0,n.jsxs)("div",{id:"drawDocContentBar",onContextMenu:e=>(e=>{e.preventDefault();let t={Hide:{action:()=>o("contentBar")}};s.setOpen(),s.setPosition(e.clientX,e.clientY),s.setContent(t)})(e),children:[(0,n.jsxs)("nav",{children:[(0,n.jsx)("button",{onClick:()=>h(!d),children:d?(0,n.jsx)(m.NBD,{}):(0,n.jsx)(m.UkA,{})}),(0,n.jsx)("ul",{children:(0,n.jsx)("li",{onClick:()=>{x("Layers"),h(!0)},style:{textDecoration:"Layers"===u?"underline":"none"},children:"Layers"})})]}),(0,n.jsx)("div",{style:{width:d?"auto":"0"},children:(0,n.jsx)(w,{action:t,setAction:o,contextMenu:s,appMenu:r,setAppMenu:i})})]})}function k(){const e=(0,a.useContext)(l),t=(e.tool,e.clipboard),o=e.cursor,s=(e.zoom,e.currLayer);e.layers;return(0,n.jsx)("canvas",{id:"carryCanvas",height:t.data.height,width:t.data.width,style:{display:"none",position:"absolute",zIndex:s,top:o.end.y+"px",left:o.end.x+"px"}})}function M(e){let{setAction:t,contextMenu:o}=e;const s=(0,a.useContext)(l),r=(0,a.useRef)(null),i=s.cursor,c=s.setCursor,d=s.tool,h=s.subTool,u=s.curveControls,x=s.setCurveControls,g=s.size,p=s.color.selected,m=s.color[1],y=s.color[2],b=s.text,v=s.setText,C=s.clipboard,f=s.setClipboard,w=s.layers,j=s.currLayer,k={tool:d,subTool:h,curveControls:u,setCurveControls:x,size:g,selectedColor:p,color1:m,setColor1:e=>s.setColor({...s.color,1:e}),color2:y,setColor2:e=>s.setColor({...s.color,2:e}),text:b,setText:v,clipboard:C,setClipboard:f},M=(e,t)=>{let o=r.current,a=o.getContext("2d",{alpha:!0}),n=o.getBoundingClientRect();const l=a.canvas.width/n.width,s=a.canvas.height/n.height;return{x:(e-n.left)*l,y:(t-n.top)*s}},S=e=>{const t=M(e.clientX,e.clientY);if(0===e.button)switch(e.type){case"mousedown":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!0,start:{x:t.x,y:t.y}});break;case"mouseup":c({...i,end:{x:t.x,y:t.y},down:!1});break;case"mousemove":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,current:{x:t.x,y:t.y}});break;case"mouseleave":c({...i,current:{x:t.x,y:t.y}});break;case"mouseenter":0!==e.buttons?c({...i,down:!0,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!1,current:{x:t.x,y:t.y}})}},T=e=>{e.preventDefault();const t=M(e.touches[0].clientX,e.touches[0].clientY);if(1===e.touches.length)switch(e.type){case"touchstart":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,down:!0,start:{x:t.x,y:t.y}});break;case"touchend":c({...i,end:{x:t.x,y:t.y},down:!1});break;case"touchmove":i.down?c({...i,current:{x:t.x,y:t.y},end:{x:t.x,y:t.y}}):c({...i,current:{x:t.x,y:t.y}})}else c({...i,current:{x:0,y:0},end:{x:t.x,y:t.y},down:!1})};return(0,n.jsx)("canvas",{ref:r,style:{position:"absolute",top:0,left:0,color:k.selectedColor,zIndex:w.length+2},className:w[j].locked?"cursorLocked":"cursor"+k.tool,id:"interfaceCanvas",height:s.dimentions.height,width:s.dimentions.width,onMouseDown:e=>{i.selecting||S(e)},onMouseUp:e=>{i.selecting||S(e)},onMouseMove:e=>{i.selecting||S(e)},onMouseLeave:e=>{i.selecting||S(e)},onMouseEnter:e=>{i.selecting||S(e)},onTouchStart:e=>{i.selecting||T(e)},onTouchEnd:e=>{i.selecting||T(e)},onTouchMove:e=>{i.selecting||T(e)},onTouchCancel:e=>{i.selecting||T(e)},onContextMenu:e=>{i.selecting||(e=>{e.preventDefault();let a={Undo:{action:()=>t("Undo"),disabled:!s.history.canUndo||w[j].locked},Redo:{action:()=>t("Redo"),disabled:!s.history.canRedo||w[j].locked},LineBreak:{},"Zoom In":{action:()=>t("Zoom In"),disabled:4===s.zoom},"Zoom Out":{action:()=>t("Zoom Out"),disabled:.25===s.zoom},"Zoom Reset":{action:()=>t("Zoom Reset"),disabled:1===s.zoom}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(a)})(e)}})}var S=o(7980),T=o(184),D=o(5051),I=o(3825),B=o(9106);const P=e=>{let{setAction:t,contextMenu:o}=e;const s=(0,a.useContext)(l);if(s.view.topNavBar)return(0,n.jsxs)("nav",{id:"drawDocTopNavBar",onContextMenu:e=>(e=>{e.preventDefault();let a={Hide:{action:()=>t("topNavBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(a)})(e),children:[(0,n.jsx)("button",{title:"Undo",onClick:()=>t("Undo"),disabled:!s.layers[s.currLayer].canUndo||s.layers[s.currLayer].locked,children:(0,n.jsx)(v.qHd,{})}),(0,n.jsx)("button",{title:"Redo",onClick:()=>t("Redo"),disabled:!s.layers[s.currLayer].canRedo||s.layers[s.currLayer].locked,children:(0,n.jsx)(v.qQW,{})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"New File",onClick:()=>t("New"),children:(0,n.jsx)(S.QB2,{})}),(0,n.jsx)("button",{title:"Download File",onClick:()=>t("Save"),disabled:!(s.history.canRedo||s.history.canUndo),children:(0,n.jsx)(S.RZ0,{})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"Upload Image",onClick:()=>t("Image"),disabled:s.layers[s.currLayer].locked,children:(0,n.jsx)(T.dkL,{})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)("button",{title:"Color 1",className:s.color.selected===s.color[1]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[1]}),children:(0,n.jsx)("label",{htmlFor:"drawColor1",style:{textDecoration:s.color.selected===s.color[1]?"underline":""},onClick:e=>e.preventDefault(),children:"1"})}),(0,n.jsx)(B.A,{color:s.color[1],setColor:e=>{s.setColor({...s.color,selected:e,1:e})},useAlpha:!1})]}),(0,n.jsx)("vertical-rect",{}),(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)("button",{title:"Color 2",className:s.color.selected===s.color[2]?"buttonActive":"",onClick:()=>s.setColor({...s.color,selected:s.color[2]}),children:(0,n.jsx)("label",{htmlFor:"drawColor2",style:{textDecoration:s.color.selected===s.color[2]?"underline":""},onClick:e=>e.preventDefault(),children:"2"})}),(0,n.jsx)(B.A,{color:s.color[2],setColor:e=>s.setColor({...s.color,selected:e,2:e}),useAlpha:!1})]}),(0,n.jsx)("vertical-rect",{}),"Magnifier"===s.tool&&(0,n.jsxs)("select",{value:s.zoom,onChange:e=>{(e=>{s.setZoom(Number(e.target.value)),"0.25"===e.target.value?t("Zoom Min"):"4"===e.target.value?t("Zoom Max"):"1"===e.target.value?t("Zoom Default"):t("Zoom Change")})(e)},title:"Zoom",children:[(0,n.jsx)("option",{value:.25,children:"25%"}),(0,n.jsx)("option",{value:.5,children:"50%"}),(0,n.jsx)("option",{value:.75,children:"75%"}),(0,n.jsx)("option",{value:1,children:"100%"}),(0,n.jsx)("option",{value:2,children:"200%"}),(0,n.jsx)("option",{value:3,children:"300%"}),(0,n.jsx)("option",{value:4,children:"400%"})]}),"Select"!==s.tool&&"Pipette"!==s.tool&&"Magnifier"!==s.tool&&"Bucket"!==s.tool&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I._DL,{}),(0,n.jsx)("input",{type:"number",min:"1",max:"100",value:s.size,onChange:e=>s.setSize(Number(e.target.value)),title:"Text"===s.tool?"Font Size":"Shape"===s.tool?"Line Width":"Radius"})]}),"Text"===s.tool&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("vertical-rect",{}),(0,n.jsx)(y.Oui,{}),(0,n.jsxs)("select",{title:"Font Family",value:s.text.fontFamily,onChange:e=>s.setText({...s.text,fontFamily:e.target.value}),children:[(0,n.jsx)("option",{children:"Arial"}),(0,n.jsx)("option",{children:"Times New Roman"}),(0,n.jsx)("option",{children:"Monospace"}),(0,n.jsx)("option",{children:"Verdana"}),(0,n.jsx)("option",{children:"Georgia"}),(0,n.jsx)("option",{children:"Courier New"}),(0,n.jsx)("option",{children:"Tahoma"}),(0,n.jsx)("option",{children:"Garamond"}),(0,n.jsx)("option",{children:"Impact"}),(0,n.jsx)("option",{children:"Comic Sans MS"}),(0,n.jsx)("option",{children:"Lucida Console"}),(0,n.jsx)("option",{children:"Lucida Sans Unicode"}),(0,n.jsx)("option",{children:"Palatino Linotype"}),(0,n.jsx)("option",{children:"Symbol"}),(0,n.jsx)("option",{children:"Wingdings"}),(0,n.jsx)("option",{children:"Helvetica"})]}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)(D.kZ9,{}),(0,n.jsx)("input",{title:"Line Height",type:"number",step:"0.01",min:"0",value:s.text.lineHeight,onChange:e=>{s.setText({...s.text,lineHeight:e.target.value})}}),(0,n.jsx)("vertical-rect",{})]}),"Shape"===s.tool&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("vertical-rect",{}),(0,n.jsx)(y.u8p,{}),(0,n.jsxs)("select",{title:"Shape",value:s.subTool.shape,onChange:e=>s.setSubTool({...s.subTool,shape:e.target.value}),children:[(0,n.jsx)("option",{children:"Line"}),(0,n.jsx)("option",{children:"Curve"}),(0,n.jsx)("option",{children:"Circle"}),(0,n.jsx)("option",{children:"Rectangle"}),(0,n.jsx)("option",{children:"Polygon"}),(0,n.jsx)("option",{children:"Star"}),(0,n.jsx)("option",{children:"Arrow"}),(0,n.jsx)("option",{children:"Heart"})]}),(0,n.jsx)("vertical-rect",{}),("Polygon"===s.subTool.shape||"Star"===s.subTool.shape)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.RIm,{}),(0,n.jsx)("input",{type:"number",title:"Sides",value:s.subTool.sides,onChange:e=>s.setSubTool({...s.subTool,sides:e.target.value}),min:"3",step:"1"}),(0,n.jsx)("vertical-rect",{})]})]})]})},L=e=>{let{subtool:t,isSelected:o}=e,l=(0,a.useRef)(null);const s={drawCircleIcon:(e,o,a)=>{e.beginPath(),e.arc(o/2,a/2,a/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath()},drawEllipseIcon:(e,o,a)=>{e.scale(1,.5),e.beginPath(),e.beginPath(),e.arc(o/2,a,a/2-2,0,2*Math.PI),t.fill&&e.fill(),e.stroke(),e.closePath(),e.scale(1,2)},drawRectangleIcon:(e,o,a)=>{t.fill&&e.fillRect(0,a/4,o,a/2),e.strokeRect(0,a/4,o,a/2)},drawPolygonIcon:(e,o,a)=>{e.beginPath();for(let n=0;n<t.sides;n++)e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*n/t.sides-Math.PI/2),a/2+(a/2-3)*Math.sin(2*Math.PI*n/t.sides-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawLineIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/4,2),e.lineTo(3*t/4,o-2),e.closePath(),e.stroke()},drawCurveIcon:(e,t,o)=>{e.beginPath(),e.moveTo(t/6,2),e.bezierCurveTo(5*t/6,o/5,t/6,4*o/5-2,5*t/6,o-2),e.stroke()},drawStarIcon:(e,o,a)=>{e.beginPath(),e.moveTo(o/2,3);for(let n=0;n<2*t.sides;n++)n%2===0?e.lineTo(o/2+(o/2-3)*Math.cos(2*Math.PI*n/(2*t.sides)-Math.PI/2),a/2+(a/2-3)*Math.sin(2*Math.PI*n/(2*t.sides)-Math.PI/2)):e.lineTo(o/2+(o/4-3)*Math.cos(2*Math.PI*n/(2*t.sides)-Math.PI/2),a/2+(a/4-3)*Math.sin(2*Math.PI*n/(2*t.sides)-Math.PI/2));e.closePath(),e.stroke(),t.fill&&e.fill()},drawArrowIcon:(e,o,a)=>{e.beginPath(),e.moveTo(2,a/3),e.lineTo(o/2,a/3),e.lineTo(o/2,2),e.lineTo(o-2,a/2),e.lineTo(o/2,a-2),e.lineTo(o/2,2*a/3),e.lineTo(2,2*a/3),e.closePath(),e.stroke(),t.fill&&e.fill()},drawHeartIcon:(e,o,a)=>{e.beginPath(),e.moveTo(o/2,a-3),e.arc(o/4+1,a/3,o/4-1,3*Math.PI/4,0,!1),e.arc(3*o/4-1,a/3,o/4-1,Math.PI,Math.PI/4,!1),e.closePath(),e.stroke(),t.fill&&e.fill()}};return(0,a.useEffect)((()=>{const e=l.current.getContext("2d"),o=e.canvas.height,a=e.canvas.width;e.clearRect(0,0,a,o),e.fillStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.strokeStyle=getComputedStyle(document.getElementById("drawDocToolBar")).color,e.lineWidth=2,s["draw"+t.shape+"Icon"](e,a,o)}),[t,o]),(0,n.jsx)("canvas",{ref:l,id:"shapeCanvas",width:"25",height:"25",title:"Custom Shape"})};var N=o(2639),E=o(8973),A=o(2021),z=o(7962),R=o(9698);const $=e=>{let{setAction:t,contextMenu:o,isSelected:s}=e;const r=(0,a.useContext)(l),i=r.tool,c=r.subTool,d=r.setTool,h={Brush:(0,n.jsx)(N.Nw5,{title:"Brush"}),Eraser:(0,n.jsx)(S.qpr,{title:"Eraser"}),Bucket:(0,n.jsx)(S.ATI,{title:"Bucket"}),Spray:(0,n.jsx)(S.bOX,{title:"Spray Can"}),Text:(0,n.jsx)(A.tEi,{title:"Insert Text"}),Pipette:(0,n.jsx)(E._e3,{title:"Color Picker"}),Magnifier:(0,n.jsx)(z.JJh,{title:"Zoom"}),Select:(0,n.jsx)(R.ZdE,{title:"Selection"}),Shape:(0,n.jsx)(L,{subtool:c,isSelected:s})};if(r.view.toolBar)return(0,n.jsx)("nav",{id:"drawDocToolBar",onContextMenu:e=>(e=>{e.preventDefault();let a={Hide:{action:()=>t("toolBar")}};o.setOpen(),o.setPosition(e.clientX,e.clientY),o.setContent(a)})(e),children:Object.keys(h).map((e=>(0,n.jsx)("button",{onClick:()=>d(e),className:i===e?"buttonActive":"",children:h[e]},e+"drawToolDropdown")))})},F=e=>{let{action:t,setAction:o,contextMenu:s}=e;const r=(0,a.useContext)(l);if(r.view.bottomNavBar)return(0,n.jsxs)("nav",{id:"drawDocBottomNavBar",onContextMenu:e=>(e=>{e.preventDefault();let t={Hide:{action:()=>o("bottomNavBar")}};s.setOpen(),s.setPosition(e.clientX,e.clientY),s.setContent(t)})(e),children:["Text"===r.tool&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{title:"Confirm Text",onClick:()=>o("confirm"),disabled:r.layers[r.currLayer].locked,children:(0,n.jsx)("small",{children:"Confirm"})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"Use Fill",className:r.text.fill?"buttonActive":"",onClick:()=>{r.setText({...r.text,fill:!r.text.fill})},children:(0,n.jsx)("small",{children:"Fill"})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"Use Stroke",className:r.text.stroke?"buttonActive":"",onClick:()=>{r.setText({...r.text,stroke:!r.text.stroke})},children:(0,n.jsx)("small",{children:"Stroke"})}),(0,n.jsx)("input",{title:"Stroke Width",type:"number",step:"1",min:"1",max:r.size-1,value:r.text.strokeWidth,onChange:e=>{r.setText({...r.text,strokeWidth:e.target.value})}}),(0,n.jsx)("vertical-rect",{})]}),"Select"===r.tool?(0,n.jsx)(n.Fragment,{children:"clipping"===t&&"carry"===r.clipboard.state?(0,n.jsx)("button",{title:"Paste",onClick:()=>{o("confirm"),r.setClipboard({...r.clipboard,state:"paste"})},disabled:r.layers[r.currLayer].locked,children:(0,n.jsx)("small",{children:"Paste"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{title:"Cut",onClick:()=>{o("clipping"),r.setClipboard({...r.clipboard,state:"cut"})},children:(0,n.jsx)("small",{children:"Cut"})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"Copy",onClick:()=>{o("clipping"),r.setClipboard({...r.clipboard,state:"copy"})},children:(0,n.jsx)("small",{children:"Copy"})})]})}):null,"Shape"===r.tool?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{title:"Confirm Shape",onClick:()=>o("confirm"),disabled:r.layers[r.currLayer].locked,children:(0,n.jsx)("small",{children:"Confirm"})}),(0,n.jsx)("vertical-rect",{}),"Curve"===r.subTool.shape&&(0,n.jsx)("button",{title:"Cancel Shape",onClick:()=>o("cancel"),children:(0,n.jsx)("small",{children:"Cancel"})}),"Line"!==r.subTool.shape&&"Curve"!==r.subTool.shape?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{title:"Fill",className:r.subTool.fill?"buttonActive":"",onClick:()=>r.setSubTool({...r.subTool,fill:!r.subTool.fill}),children:(0,n.jsx)("small",{children:"Fill"})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsx)("button",{title:"Stretch",className:r.subTool.stretch?"buttonActive":"",onClick:()=>r.setSubTool({...r.subTool,stretch:!r.subTool.stretch}),children:(0,n.jsx)("small",{children:"Stretch"})}),(0,n.jsx)("vertical-rect",{}),(0,n.jsxs)("button",{children:[(0,n.jsx)("label",{htmlFor:"rotationAngle",children:"Rotation"}),(0,n.jsx)("input",{type:"number",title:"Rotation Angle",id:"rotationAngle",value:r.subTool.angle,onChange:e=>r.setSubTool({...r.subTool,angle:e.target.value}),step:"1"})]}),(0,n.jsx)("vertical-rect",{}),"Polygon"===r.subTool.shape||"Star"===r.subTool.shape?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{children:[(0,n.jsx)("label",{htmlFor:"startAngle",children:"Start Angle"}),(0,n.jsx)("input",{type:"number",title:"Start Angle",id:"startAngle",value:r.subTool.startAngle,onChange:e=>r.setSubTool({...r.subTool,startAngle:e.target.value}),step:"1"})]}),(0,n.jsx)("vertical-rect",{})]}):null]}):null]}):null]})};function Z(e){const t=e.action,o=e.setAction,r=e.appMenu,i=e.setAppMenu,c=e.appDialog,d=e.setAppDialog,h=e.contextMenu,u=e.canClose,m=e.setCanClose,y=e.isSelected,b=e.title,v=e.setTitle;(0,a.useContext)(l);return(0,n.jsx)(s,{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P,{setAction:o,contextMenu:h}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",height:"100%",margin:"0px"},children:[(0,n.jsx)($,{setAction:o,contextMenu:h,isSelected:y}),(0,n.jsxs)("canvas-container",{children:[(0,n.jsx)(x,{action:t,setAction:o,appMenu:r,setAppMenu:i,appDialog:c,setAppDialog:d,contextMenu:h,canClose:u,setCanClose:m,title:b,setTitle:v}),(0,n.jsx)(k,{}),(0,n.jsx)(g,{}),(0,n.jsx)(M,{action:t,setAction:o,contextMenu:h}),(0,n.jsx)(p,{})]}),(0,n.jsx)(j,{action:t,setAction:o,contextMenu:h,appMenu:r,setAppMenu:i})]}),(0,n.jsx)(F,{action:t,setAction:o,contextMenu:h})]})})}},9106:(e,t,o)=>{o.d(t,{A:()=>i});var a=o(5043),n=o(7950);function l(e){let t=e[0],o=e[1],a=e[2];t/=255,o/=255,a/=255;let n=Math.min(t,o,a),l=Math.max(t,o,a),s=l-n,r=0,i=0,c=(l+n)/2;return 0===s?(i=0,r=0):(i=c<=.5?s/(l+n):s/(2-l-n),l===t?r=(o-a)/s:l===o?r=(a-t)/s+2:l===a&&(r=(t-o)/s+4)),r=Math.round(60*r),r<0&&(r+=360),i=Math.abs(100*i).toFixed(0),c=(100*c).toFixed(0),[r,i+"%",c+"%"]}function s(e){var t=e[0],o=e[1],a=e[2],n=e[3];t=parseInt(e[1],16),o=parseInt(e[2],16),a=parseInt(e[3],16),n=parseInt(e[4],16);t/=255,o/=255,a/=255;let l=Math.min(t,o,a),s=Math.max(t,o,a),r=s-l,i=0,c=0,d=(s+l)/2;return 0===r?(c=0,i=0):(c=d<=.5?r/(s+l):r/(2-s-l),s===t?i=(o-a)/r:s===o?i=(a-t)/r+2:s===a&&(i=(t-o)/r+4)),i=Math.round(60*i),i<0&&(i+=360),c=Math.abs(100*c).toFixed(0),d=(100*d).toFixed(0),[i,c+"%",d+"%",n]}o(7915);var r=o(579);function i(e){let{color:t,setColor:o,useAlpha:i}=e;const c=(0,a.useRef)(null),d=(0,a.useRef)(null),h=(0,a.useRef)(null),u=(0,a.useRef)(null),[x,g]=(0,a.useState)({x:0,y:0}),[p,m]=(0,a.useState)(0),[y,b]=(0,a.useState)(0),[v,C]=(0,a.useState)(!1),[f,w]=(0,a.useState)(0),[j,k]=(0,a.useState)(50),[M,S]=(0,a.useState)(100),[T,D]=(0,a.useState)(100);(0,a.useEffect)((()=>{v&&c.current.focus()}),[v]);(0,a.useEffect)((()=>{if(t)if(i){let a=[];if("#"===t[0])a=s(function(e){var t;return 5===e.length?0==(t=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e))[4]&&(t[4]="ff"):9===e.length?t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e):8===e.length&&((t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))[4]="ff"),t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16)/255]:null}(t));else if("rgba"===t.slice(0,4))a=s(t);else if("hsla"===t.slice(0,4))for(let n=0;n<t.length;n++){"("===t[n]?e=n+1:")"===t[n]?(o=n,a.push(t.slice(e,o))):","===t[n]&&(a.push(t.slice(e,n)),e=n+1)}if(w(Number(a[0])),S(Number(a[1].slice(0,a[1].length-1))),k(Number(a[2].slice(0,a[2].length-1))),D(Number(a[3])),v){const e=d.current.getBoundingClientRect();g({x:a[0]/360*e.width,y:(100-a[2].slice(0,a[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-a[1].slice(0,a[1].length-1))/100*t.height);const o=u.current.getBoundingClientRect();b(a[3]*o.width)}}else{let a=[];if("#"===t[0])a=l(function(e){var t;return(t=4===e.length?/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i.exec(e):/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}(t));else if("rgb"===t.slice(0,3))a=l(t);else if("hsl"===t.slice(0,3))for(let n=0;n<t.length;n++){var e,o;"("===t[n]?e=n+1:")"===t[n]?(o=n,a.push(t.slice(e,o))):","===t[n]&&(a.push(t.slice(e,n)),e=n+1)}else a=function(e){switch(e){case"red":case"maroon":return[0,"100%","50%"];case"green":case"lime":return[120,"100%","50%"];case"blue":case"aqua":case"navy":return[240,"100%","50%"];case"yellow":case"olive":return[60,"100%","50%"];case"cyan":case"teal":return[180,"100%","50%"];case"magenta":return[300,"100%","50%"];case"black":default:return[0,"0%","0%"];case"white":return[0,"0%","100%"];case"gray":case"grey":return[0,"0%","50%"];case"lightgray":case"lightgrey":return[0,"0%","75%"];case"darkgray":case"darkgrey":return[0,"0%","25%"];case"brown":return[30,"50%","50%"];case"orange":return[30,"100%","50%"];case"purple":return[270,"100%","50%"];case"pink":return[330,"100%","50%"]}}(t);if(w(Number(a[0])),S(Number(a[1].slice(0,a[1].length-1))),k(Number(a[2].slice(0,a[2].length-1))),v){const e=d.current.getBoundingClientRect();g({x:a[0]/360*e.width,y:(100-a[2].slice(0,a[2].length-1))/100*e.height});const t=h.current.getBoundingClientRect();m((100-a[1].slice(0,a[1].length-1))/100*t.height)}}}),[v,t,i]);(0,a.useEffect)((()=>{if(d.current){(e=>{e.clearRect(0,0,e.canvas.width,e.canvas.height);let t=e.canvas.width/360,o=e.canvas.height/100;for(let a=0;a<360;a++)for(let n=0;n<100;n++)e.fillStyle=`hsl(${a},${M}%,${100-n}%)`,e.fillRect(a*t,n*o,(a+1)*t,(n+1)*o)})(d.current.getContext("2d",{alpha:!1}))}}),[v,M]);const I=e=>{if(0!==e.buttons){const t=d.current.getBoundingClientRect();let o=e.clientX-t.left,a=e.clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(g({x:o,y:a}),w(Math.floor(360*o/t.width)),k(100-Math.floor(100*a/t.height)))}},B=e=>{if(1===e.touches.length){const t=d.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,a=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(g({x:o,y:a}),w(Math.floor(360*o/t.width)),k(100-Math.floor(100*a/t.height)))}},P=e=>{if(0!==e.buttons){const t=h.current.getBoundingClientRect();let o=e.clientX-t.left,a=e.clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(S(100-Math.floor(100*a/t.height)),m(a))}},L=e=>{if(1===e.touches.length){const t=h.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,a=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(S(100-Math.floor(100*a/t.height)),m(a))}},N=e=>{if(0!==e.buttons){const t=u.current.getBoundingClientRect();let o=e.clientX-t.left,a=e.clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(D(Math.floor(100*o/t.width)/100),b(o))}},E=e=>{if(1===e.touches.length){const t=u.current.getBoundingClientRect();let o=e.touches[0].clientX-t.left,a=e.touches[0].clientY-t.top;o>=0&&o<=t.width&&a>=0&&a<=t.height&&(D(Math.floor(100*o/t.width)/100),b(o))}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("color-picker-button",{onClick:()=>C(!v),children:(0,r.jsx)("div",{children:(0,r.jsx)("button",{style:{background:t}})})}),v&&(0,n.createPortal)((0,r.jsxs)("color-picker-window",{tabIndex:"0",ref:c,onBlur:e=>{var t;(t=e).currentTarget.contains(t.relatedTarget)||C(!1)},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("hue-light-map",{children:[(0,r.jsx)("canvas",{onMouseDown:e=>I(e),onMouseMove:e=>I(e),onTouchMove:e=>B(e),onTouchStart:e=>B(e),onTouchEnd:e=>B(e),ref:d,width:"180",height:"180",style:{opacity:i?T:1}}),(0,r.jsx)("slider-thumb",{style:{top:x.y,left:x.x,background:i?`hsla(${f},${M}%,${j}%, ${T})`:`hsl(${f},${M}%,${j}%)`},onMouseDown:e=>I(e),onMouseMove:e=>I(e),onTouchMove:e=>B(e),onTouchStart:e=>B(e),onTouchEnd:e=>B(e)})]}),(0,r.jsxs)("saturation-slider",{title:"Saturation",children:[(0,r.jsx)("div",{ref:h,style:{background:`linear-gradient(0deg, hsl(${f},0%,${j}%), hsla(${f},100%,${j}%))`},onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>L(e),onTouchStart:e=>L(e),onTouchEnd:e=>L(e)}),(0,r.jsx)("slider-thumb",{style:{top:p,background:`hsla(${f},${M}%,${j}%, ${T})`},onMouseDown:e=>P(e),onMouseMove:e=>P(e),onTouchMove:e=>L(e),onTouchStart:e=>L(e),onTouchEnd:e=>L(e)})]})]}),i&&(0,r.jsxs)("alpha-slider",{title:"Alpha",children:[(0,r.jsx)("div",{ref:u,style:{background:`linear-gradient(90deg, hsla(${f},${M}%,${j}%, 0), hsla(${f},${M}%,${j}%, 1))`},onMouseDown:e=>N(e),onMouseMove:e=>N(e),onTouchMove:e=>E(e),onTouchStart:e=>E(e),onTouchEnd:e=>E(e)}),(0,r.jsx)("slider-thumb",{style:{left:y,background:`hsl(${f},${M}%,${j}%, ${T})`},onMouseDown:e=>N(e),onMouseMove:e=>N(e),onTouchMove:e=>E(e),onTouchStart:e=>E(e),onTouchEnd:e=>E(e)})]}),(0,r.jsxs)("color-inputs",{children:[(0,r.jsxs)("div",{children:["Hue",(0,r.jsx)("input",{type:"number",min:"0",max:"360",value:f,onChange:e=>(e=>{w(e);const t=d.current.getBoundingClientRect();g({...x,x:e/360*t.width})})(e.target.value)})]}),(0,r.jsxs)("div",{children:["Lum.",(0,r.jsx)("input",{type:"number",min:"0",max:"100",value:j,onChange:e=>(e=>{k(e);const t=d.current.getBoundingClientRect();g({...x,y:(100-e)/100*t.height})})(e.target.value)})]}),(0,r.jsxs)("div",{children:["Sat.",(0,r.jsx)("input",{type:"number",min:"0",max:"100",value:M,onChange:e=>(e=>{S(e);const t=h.current.getBoundingClientRect();m((100-e)/100*t.height)})(e.target.value)})]}),i&&(0,r.jsxs)("div",{children:["Alpha",(0,r.jsx)("input",{type:"number",min:"0",max:"1",step:"0.01",value:T,onChange:e=>(e=>{D(e);const t=u.current.getBoundingClientRect();b(e*t.width)})(e.target.value)})]})]}),(0,r.jsx)("color-button",{children:(0,r.jsx)("button",{style:{background:i?`hsla(${f},${M}%,${j}%, ${T})`:`hsl(${f},${M}%,${j}%)`},onClick:()=>{o(i?`hsla(${f},${M}%,${j}%, ${T})`:`hsl(${f},${M}%,${j}%)`)},children:"Apply"})})]}),document.getElementById("root"))]})}}}]);
//# sourceMappingURL=615.132aac02.chunk.js.map