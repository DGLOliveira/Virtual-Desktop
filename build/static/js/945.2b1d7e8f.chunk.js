"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[945],{6303:(t,n,e)=>{e.r(n),e.d(n,{default:()=>l});var a=e(5043),s=e(749),o=e(8711),i=e(7174),r=e(2373);const c=e.p+"static/media/Gyroscope.572cdad23e89a59df442.glb";var h=e(579);function l(){const[t,n]=(0,a.useState)("ready"),[e,l]=(0,a.useState)({heading:0,pitch:0,roll:0,screenOrientationType:screen.orientation.type,screenOrientationAngle:screen.orientation.angle});var u=null;const M=()=>{const t=(0,i.p)(c),n=(0,a.useRef)();let o,r,l;t.scene.children.forEach((t=>{"External_Gimbal"===t.name&&(o=t),"Internal_Gimbal"===t.name&&(r=t),"Axis"===t.name&&(l=t)}));let u=0;return(0,s.F)(((t,n)=>{if("running"===t&&(u+=10*n),void 0!==o&&void 0!==r&&void 0!==l){let t=e.roll+Math.PI,n=e.pitch+Math.PI/2+u,a=u;o.quaternion.w=Math.cos(t/2),o.quaternion.y=Math.sin(t/2),o.quaternion.x=0,o.quaternion.z=0,r.quaternion.w=Math.cos(t/2)*Math.cos(n/2),r.quaternion.y=Math.sin(t/2)*Math.cos(n/2),r.quaternion.x=Math.cos(t/2)*Math.sin(n/2),r.quaternion.z=-Math.sin(t/2)*Math.sin(n/2),l.quaternion.w=Math.cos(t/2)*Math.cos((n+Math.PI/2)/2)*Math.cos(a/2)+Math.sin(t/2)*Math.sin((n+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.y=Math.sin(t/2)*Math.cos((n+Math.PI/2)/2)*Math.cos(a/2)-Math.cos(t/2)*Math.sin((n+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.x=Math.cos(t/2)*Math.sin((n+Math.PI/2)/2)*Math.cos(a/2)+Math.sin(t/2)*Math.cos((n+Math.PI/2)/2)*Math.sin(a/2),l.quaternion.z=Math.cos(t/2)*Math.cos((n+Math.PI/2)/2)*Math.sin(a/2)-Math.sin(t/2)*Math.sin((n+Math.PI/2)/2)*Math.cos(a/2)}})),(0,h.jsx)("primitive",{ref:n,object:t.scene,scale:1.6})};const d=()=>{(u=new RelativeOrientationSensor({frequency:4,referenceFrame:"device"})).start(),console.log("gyroscope started"),u.onreading=()=>{let t=(n=u.quaternion[0],a=u.quaternion[1],s=u.quaternion[2],o=u.quaternion[3],{heading:Math.atan2(2*(n*a+s*o),1-2*(a*a+s*s)),pitch:Math.asin(2*(n*s-o*a)),roll:Math.atan2(2*(n*o+a*s),1-2*(n*n+a*a))});var n,a,s,o;let i=screen.orientation.type,r=screen.orientation.angle;l({...t,newOrientationType:i,newOrientationAngle:r}),console.log(e)}};return(0,a.useEffect)((()=>{"start"===t&&("AbsoluteOrientationSensor"in window?Promise.all([navigator.permissions.query({name:"gyroscope"}),navigator.permissions.query({name:"accelerometer"})]).then((t=>{t.every((t=>"granted"===t.state))?n("running"):n("not allowed")})):n("not supported")),"running"===t&&d()}),[t]),(0,a.useEffect)((()=>()=>{u&&u.stop()}),[]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(o.Hl,{children:[(0,h.jsx)("ambientLight",{intensity:1}),(0,h.jsx)("pointLight",{position:[-10,-10,10],intensity:500}),(0,h.jsx)(M,{}),(0,h.jsx)(r.q,{makeDefault:!0,zoom:50,position:[0,0,10]})]}),"ready"===t&&(0,h.jsx)("button",{className:"gyroscopeStartButton",onClick:()=>n("start"),children:"Start"}),"not supported"===t&&(0,h.jsx)("div",{className:"gyroscopeWarning",children:"This feature is not supported on your device and/or browser"}),"not allowed"===t&&(0,h.jsx)("div",{className:"gyroscopeWarning",children:"This feature does not have permission to access your device sensors"})]})}}}]);
//# sourceMappingURL=945.2b1d7e8f.chunk.js.map