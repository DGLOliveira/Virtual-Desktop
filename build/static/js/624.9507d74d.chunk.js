"use strict";(self.webpackChunkpc=self.webpackChunkpc||[]).push([[624],{4624:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var n=s(5043),a=s(579);function i(e,t){var s=[],n=window.getSelection();const a=t.settings.searchParams.string;var i;function r(e,t,s){var a=document.createRange();a.setStart(e,t),a.setEnd(e,s),n.addRange(a)}if(t.ref.current.focus(),t.ref.current.childNodes.forEach(((e,n)=>{if("#text"===e.nodeName){var i=!1,r=0,o=0;e.nodeValue.includes(a)&&t.settings.searchParams.caseSensitive?(i=!0,r=e.nodeValue.indexOf(a),o=e.nodeValue.indexOf(a)+a.length):e.nodeValue.toLowerCase().includes(a.toLowerCase())&&!t.settings.searchParams.caseSensitive&&(i=!0,r=e.nodeValue.toLowerCase().indexOf(a.toLowerCase()),o=e.nodeValue.toLowerCase().indexOf(a.toLowerCase())+a.length),i&&t.settings.searchParams.wholeWord&&(i=!(0!==r&&" "!==e.nodeValue[r-1]||o!==e.nodeValue.length&&" "!==e.nodeValue[o])),i&&s.push({node:e,startIndex:r,endIndex:o})}})),s.length>0){var o="Find Next"===e||"Replace Next"===e;if(i=1===s.length?0:-1===t.settings.searchParams.index?o?0:s.length-1:t.settings.searchParams.index===s.length-1?o?0:t.settings.searchParams.index-1:0===t.settings.searchParams.index?o?1:s.length-1:o?t.settings.searchParams.index+1:t.settings.searchParams.index-1,n.removeAllRanges(),""!==t.settings.searchParams.replaceString&&t.settings.searchParams.replace){var l=s[i].node.nodeValue;s[i].node.nodeValue=l.slice(0,s[i].startIndex)+t.settings.searchParams.replaceString+l.slice(s[i].endIndex),r(s[i].node,s[i].startIndex,s[i].startIndex+t.settings.searchParams.replaceString.length),s.splice(i,1),i-=1}else r(s[i].node,s[i].startIndex,s[i].endIndex)}t.setSettings({...t.settings,searchParams:{...t.settings.searchParams,results:s,index:i}})}function r(e,t,s,n,r,o,l){switch(e){case"New":!function(e,t,s){const n=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Title"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:s.settings.newTitle,onChange:t=>{s.setSettings({...s.settings,newTitle:t.target.value}),e("New")}}),(0,a.jsx)("br",{})]}),i={Confirm:()=>{e("New Confirm"),t(null)},Cancel:()=>{t(null),e(!1)}};t({title:"New File",info:n,actions:i})}(t,s,l),t(!1);break;case"New Confirm":l.setSettings({...l.settings,title:l.settings.newTitle}),n(l.settings.newTitle),l.ref.current.innerHTML="",s(null),t(!1);break;case"New Cancel":l.setSettings({...l.settings,newTitle:""}),s(null),t(!1);break;case"Open":let c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept",".txt"),c.click(),c.onchange=()=>{let e=new FileReader;e.onload=()=>{l.ref.current.innerText=e.result},e.readAsText(c.files[0]),l.setSettings({...l.settings,title:c.files[0].name.slice(0,c.files[0].name.length-4)}),n(c.files[0].name.slice(0,c.files[0].name.length-4))},t(!1);break;case"Save":let d=document.createElement("a");d.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(l.ref.current.innerText)),d.setAttribute("download",l.settings.title+".txt"),d.click(),t(!1);break;case"Change Title":!function(e,t,s){t({title:"Change Title",info:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"New title",children:"Title"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"New title",type:"text",value:s.settings.newTitle,onChange:t=>{s.setSettings({...s.settings,newTitle:t.target.value}),e("Change Title")}}),(0,a.jsx)("br",{})]}),actions:{Confirm:()=>{e("Change Title Confirm")},Cancel:()=>{e("Change Title Cancel")}}})}(t,s,l),t(!1);break;case"Change Title Confirm":l.setSettings({...l.settings,title:l.settings.newTitle}),n(l.settings.newTitle),s(null),t(!1);break;case"Change Title Cancel":l.setSettings({...l.settings,newTitle:""}),s(null),t(!1);break;case"Undo":l.ref.current.focus(),document.execCommand("undo",!1),t(!1);break;case"Redo":l.ref.current.focus(),document.execCommand("redo",!1),t(!1);break;case"Cut":l.ref.current.focus(),document.execCommand("cut",!1),t(!1);break;case"Copy":l.ref.current.focus(),document.execCommand("copy",!1),t(!1);break;case"Paste":l.ref.current.focus(),navigator.clipboard.readText().then((e=>{document.execCommand("insertText",!1,e)})).catch((e=>{console.log(e),alert(e.message)})),t(!1);break;case"Find":!function(e,t,s){t({title:"Find",info:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"Find",children:"Find"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Find",type:"text",value:s.settings.searchParams.string,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,string:t.target.value,results:[],index:-1,replace:!1}}),e("Find")}}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Case Sensitive",type:"checkbox",checked:s.settings.searchParams.caseSensitive,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,caseSensitive:t.target.checked,results:[],index:-1}}),e("Find")}}),(0,a.jsx)("label",{htmlFor:"Case Sensitive",children:"Case Sensitive"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Whole Word",type:"checkbox",checked:s.settings.searchParams.wholeWord,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,wholeWord:t.target.checked,results:[],index:-1}}),e("Find")}}),(0,a.jsx)("label",{htmlFor:"Whole Word",children:"Whole Word"})]}),actions:{"Find Next":()=>{e("Find Next")},"Find Previous":()=>{e("Find Previous")},Close:()=>{e("Close Find")}}})}(t,s,l),t(!1);break;case"Find Next":case"Find Previous":i(e,l),t(!1);break;case"Close Find":l.setSettings({...l.settings,searchParams:{...l.settings.searchParams,results:[],index:-1}}),s(null),t(!1);break;case"Replace":!function(e,t,s){t({title:"Replace",info:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"Target",children:"Target"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Target",type:"text",value:s.settings.searchParams.string,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,string:t.target.value,results:[],index:-1}}),e("Replace")}}),(0,a.jsx)("br",{}),(0,a.jsx)("label",{htmlFor:"Replace",children:"Replace"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Replace",type:"text",value:s.settings.searchParams.replaceString,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,replace:!0,replaceString:t.target.value,results:[],index:-1}}),e("Replace")}}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Case Sensitive",type:"checkbox",checked:s.settings.searchParams.caseSensitive,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,caseSensitive:t.target.checked,results:[],index:-1}}),e("Replace")}}),(0,a.jsx)("label",{htmlFor:"Case Sensitive",children:"Case Sensitive"}),(0,a.jsx)("br",{}),(0,a.jsx)("input",{id:"Whole Word",type:"checkbox",checked:s.settings.searchParams.wholeWord,onChange:t=>{s.setSettings({...s.settings,searchParams:{...s.settings.searchParams,wholeWord:t.target.checked,results:[],index:-1}}),e("Replace")}}),(0,a.jsx)("label",{htmlFor:"Whole Word",children:"Whole Word"})]}),actions:{"Replace Next":()=>{e("Replace Next")},Close:()=>{e("Close Replace")}}})}(t,s,l),t(!1);break;case"Replace Next":case"Replace Previous":i(e,l),t(!1);break;case"Close Replace":l.setSettings({...l.settings,searchParams:{...l.settings.searchParams,results:[],index:-1}}),s(null),t(!1);break;case"Zoom In":l.settings.zoom<l.MAX_ZOOM&&l.setSettings({...l.settings,zoom:2*l.settings.zoom}),t(!1);break;case"Zoom Out":l.settings.zoom>l.MIN_ZOOM&&l.setSettings({...l.settings,zoom:l.settings.zoom/2}),t(!1);break;case"Zoom Reset":1!==l.settings.zoom&&l.setSettings({...l.settings,zoom:1}),t(!1);break;case"System":l.setSettings({...l.settings,theme:{type:e,backgroundColor:"var(--AppBkgrColor)",color:"var(--AppFontColor)"}}),t(!1);break;case"Light":l.setSettings({...l.settings,theme:{type:e,backgroundColor:"white",color:"black"}}),t(!1);break;case"Dark":l.setSettings({...l.settings,theme:{type:e,backgroundColor:"black",color:"white"}}),t(!1);break;case"Text Wrap":l.setSettings({...l.settings,textWrap:"wrap"===l.settings.textWrap?"nowrap":"wrap"}),t(!1);break;case"Close":r||s({title:"Warning",info:"Do you want to download the file before closing?",actions:{Save:()=>{t("Save"),o(!0),s(null)},Close:()=>{o(!0),s(null)},Cancel:()=>{s(null),t(!1)}}});break;case!1:break;default:t(!1)}}function o(e){const t=(0,n.useRef)(null),[s,i]=(0,n.useState)(""),[o,l]=(0,n.useState)({fontSize:"14px",fontFamily:"Arial",textWrap:"nowrap",theme:{type:"System",backgroundColor:"var(--AppBkgrColor)",color:"var(--AppFontColor)"},zoom:1,title:"Untitled",newTitle:"Untitled",searchParams:{string:"",results:[],index:0,caseSensitive:!1,wholeWord:!1,replace:!1,replaceString:""}}),c=e.action,d=e.setAction,g=e.appMenu,h=e.setAppMenu,m=(e.appDialog,e.setAppDialog),u=(e.contextMenu,e.setContextMenu,e.isSelected,e.title,e.setTitle),b=e.canClose,p=e.setCanClose,x={ref:t,settings:o,setSettings:l,text:s,setText:i,MAX_ZOOM:4,MIN_ZOOM:.25};(0,n.useEffect)((()=>{c&&r(c,d,m,u,b,p,x)}),[c]),(0,n.useEffect)((()=>{!function(e,t,s){const n={File:{New:{action:"New",keybind:"Alt+N",disabled:""===s.ref.current.innerHTML},Open:{action:"Open",keybind:"Alt+O",disabled:!1},Save:{action:"Save",keybind:"Alt+S",disabled:""===s.ref.current.innerHTML},LineBreak0:{},"Change Title":{action:"Change Title",keybind:"F2",disabled:!1},LineBreak1:{},Close:{action:"Close",keybind:"Alt+Shift+F4",disabled:!1}},Edit:{Undo:{action:"Undo",keybind:"Ctrl+Z",disabled:!1,keybindDisabled:!0},Redo:{action:"Redo",keybind:"Ctrl+Shift+Z",disabled:!1,keybindDisabled:!0},LineBreak0:{},Cut:{action:"Cut",keybind:"Ctrl+X",disabled:!1,keybindDisabled:!0},Copy:{action:"Copy",keybind:"Ctrl+C",disabled:!1,keybindDisabled:!0},Paste:{action:"Paste",keybind:"Ctrl+V",disabled:!1,keybindDisabled:!0},LineBreak1:{},Find:{action:"Find",keybind:"Ctrl+Alt+F",disabled:!1},Replace:{action:"Replace",keybind:"Ctrl+Alt+R",disabled:!1}},View:{"Zoom In":{action:"Zoom In",keybind:"Alt++",disabled:s.settings.zoom>=s.MAX_ZOOM},"Zoom Out":{action:"Zoom Out",keybind:"Alt+-",disabled:s.settings.zoom<=s.MIN_ZOOM},"Zoom Reset":{action:"Zoom Reset",keybind:"Alt+0",disabled:1===s.settings.zoom},LineBreak1:{},"Text Wrap":{action:"Text Wrap",checkbox:"nowrap"!==s.settings.textWrap,disabled:!1}},Theme:{Default:{action:"System",radio:"System"===s.settings.theme.type,name:"theme",disabled:!1},Light:{action:"Light",radio:"Light"===s.settings.theme.type,name:"theme",disabled:!1},Dark:{action:"Dark",radio:"Dark"===s.settings.theme.type,name:"theme",disabled:!1}},Help:{Help:{action:"help",keybind:"F1",disabled:!0,title:"Not Implemented"},About:{action:"about",keybind:"F2",disabled:!0,title:"Not Implemented"}}};t(e?{...e,File:{...e.File,New:{...e.File.New,disabled:""===s.ref.current.innerHTML},Save:{...e.File.Save,disabled:""===s.ref.current.innerHTML}},View:{...e.View,"Zoom In":{...e.View["Zoom In"],disabled:s.settings.zoom>=s.MAX_ZOOM},"Zoom Out":{...e.View["Zoom Out"],disabled:s.settings.zoom<=s.MIN_ZOOM},"Zoom Reset":{...e.View["Zoom Reset"],disabled:1===s.settings.zoom},"Text Wrap":{...e.View["Text Wrap"],checkbox:"nowrap"!==s.settings.textWrap}},Theme:{...e.Theme,Default:{...e.Theme.Default,radio:"System"===s.settings.theme.type},Light:{...e.Theme.Light,radio:"Light"===s.settings.theme.type},Dark:{...e.Theme.Dark,radio:"Dark"===s.settings.theme.type}}}:n)}(g,h,x)}),[o,s]);const k=new MutationObserver((()=>{i(t.current.innerHTML),""===t.current.innerHTML?p(!0):p(!1)}));return(0,n.useEffect)((()=>(k.observe(t.current,{attributes:!0,childList:!0,subtree:!0}),()=>k.disconnect())),[]),(0,a.jsx)("div",{ref:t,contentEditable:"plaintext-only",onContextMenu:e=>e.stopPropagation(),id:"noteDoc",style:{fontSize:o.fontSize,fontFamily:o.fontFamily,textWrap:o.textWrap,zoom:o.zoom,backgroundColor:o.theme.backgroundColor,color:o.theme.color},onChange:e=>i(e.target.innerHTML)})}}}]);
//# sourceMappingURL=624.9507d74d.chunk.js.map